/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: mark@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: david@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash -o ./dist/lodash.compat.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: felix@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/*!

 handlebars v1.3.0

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

//     Underscore.js 1.3.3
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

/**
 * @license Handlebars hbs 0.4.0 - Alex Sexton, but Handlebars has it's own licensing junk
 *
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/require-cs for details on the plugin this was based off of
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

!function(){var requirejs,require,define;!function(t){function e(t,e){return v.call(t,e)}function i(t,e){var i,n,o,s,r,a,u,c,h,l,p,f=e&&e.split("/"),d=g.map,m=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(f=f.slice(0,f.length-1),t=t.split("/"),r=t.length-1,g.nodeIdCompat&&_.test(t[r])&&(t[r]=t[r].replace(_,"")),t=f.concat(t),h=0;h<t.length;h+=1)if(p=t[h],"."===p)t.splice(h,1),h-=1;else if(".."===p){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||m)&&d){for(i=t.split("/"),h=i.length;h>0;h-=1){if(n=i.slice(0,h).join("/"),f)for(l=f.length;l>0;l-=1)if(o=d[f.slice(0,l).join("/")],o&&(o=o[n])){s=o,a=h;break}if(s)break;!u&&m&&m[n]&&(u=m[n],c=h)}!s&&u&&(s=u,a=c),s&&(i.splice(0,a,s),t=i.join("/"))}return t}function n(e,i){return function(){return h.apply(t,y.call(arguments,0).concat([e,i]))}}function o(t){return function(e){return i(e,t)}}function s(t){return function(e){f[t]=e}}function r(i){if(e(d,i)){var n=d[i];delete d[i],m[i]=!0,c.apply(t,n)}if(!e(f,i)&&!e(m,i))throw new Error("No "+i);return f[i]}function a(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function u(t){return function(){return g&&g.config&&g.config[t]||{}}}var c,h,l,p,f={},d={},g={},m={},v=Object.prototype.hasOwnProperty,y=[].slice,_=/\.js$/;l=function(t,e){var n,s=a(t),u=s[0];return t=s[1],u&&(u=i(u,e),n=r(u)),u?t=n&&n.normalize?n.normalize(t,o(e)):i(t,e):(t=i(t,e),s=a(t),u=s[0],t=s[1],u&&(n=r(u))),{f:u?u+"!"+t:t,n:t,pr:u,p:n}},p={require:function(t){return n(t)},exports:function(t){var e=f[t];return"undefined"!=typeof e?e:f[t]={}},module:function(t){return{id:t,uri:"",exports:f[t],config:u(t)}}},c=function(i,o,a,u){var c,h,g,v,y,_,b=[],w=typeof a;if(u=u||i,"undefined"===w||"function"===w){for(o=!o.length&&a.length?["require","exports","module"]:o,y=0;y<o.length;y+=1)if(v=l(o[y],u),h=v.f,"require"===h)b[y]=p.require(i);else if("exports"===h)b[y]=p.exports(i),_=!0;else if("module"===h)c=b[y]=p.module(i);else if(e(f,h)||e(d,h)||e(m,h))b[y]=r(h);else{if(!v.p)throw new Error(i+" missing "+h);v.p.load(v.n,n(u,!0),s(h),{}),b[y]=f[h]}g=a?a.apply(f[i],b):void 0,i&&(c&&c.exports!==t&&c.exports!==f[i]?f[i]=c.exports:g===t&&_||(f[i]=g))}else i&&(f[i]=a)},requirejs=require=h=function(e,i,n,o,s){if("string"==typeof e)return p[e]?p[e](i):r(l(e,i).f);if(!e.splice){if(g=e,g.deps&&h(g.deps,g.callback),!i)return;i.splice?(e=i,i=n,n=null):e=t}return i=i||function(){},"function"==typeof n&&(n=o,o=s),o?c(t,e,i,n):setTimeout(function(){c(t,e,i,n)},4),h},h.config=function(t){return h(t)},requirejs._defined=f,define=function(t,i,n){i.splice||(n=i,i=[]),e(f,t)||e(d,t)||(d[t]=[t,i,n])},define.amd={jQuery:!0}}(),define("almond",function(){}),define("famous/core/Entity",["require","exports","module"],function(t,e,i){function n(t){return a[t]}function o(t,e){a[t]=e}function s(t){var e=a.length;return o(e,t),e}function r(t){o(t,null)}var a=[];i.exports={register:s,unregister:r,get:n,set:o}}),define("famous/core/Transform",["require","exports","module"],function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function o(t){return Math.sqrt(n(t))}function s(t){return 0>t?-1:1}var r={};r.precision=1e-6,r.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},r.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},r.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},r.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],o=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return r.thenMove(e,[i,n,o])},r.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},r.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},r.scale=function(t,e,i){return void 0===i&&(i=1),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},r.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},r.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},r.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},r.rotate=function(t,e,i){var n=Math.cos(t),o=Math.sin(t),s=Math.cos(e),r=Math.sin(e),a=Math.cos(i),u=Math.sin(i),c=[s*a,n*u+o*r*a,o*u-n*r*a,0,-s*u,n*a-o*r*u,o*a+n*r*u,0,r,-o*s,n*s,0,0,0,0,1];return c},r.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),o=1-n,s=t[0]*t[0]*o,r=t[0]*t[1]*o,a=t[0]*t[2]*o,u=t[1]*t[1]*o,c=t[1]*t[2]*o,h=t[2]*t[2]*o,l=t[0]*i,p=t[1]*i,f=t[2]*i,d=[s+n,r+f,a-p,0,r-f,u+n,c+l,0,a+p,c-l,h+n,0,0,0,0,1];return d},r.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),o=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return r.thenMove(e,[i,n,o])},r.skew=function(t,e,i){return[1,0,0,0,Math.tan(i),1,0,0,Math.tan(e),Math.tan(t),1,0,0,0,0,1]},r.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},r.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},r.getTranslate=function(t){return[t[12],t[13],t[14]]},r.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],o=t[1]*t[10]-t[2]*t[9],s=t[0]*t[10]-t[2]*t[8],r=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],h=t[0]*e-t[1]*i+t[2]*n,l=1/h,p=[l*e,-l*o,l*a,0,-l*i,l*s,-l*u,0,l*n,-l*r,l*c,0,0,0,0,1];return p[12]=-t[12]*p[0]-t[13]*p[4]-t[14]*p[8],p[13]=-t[12]*p[1]-t[13]*p[5]-t[14]*p[9],p[14]=-t[12]*p[2]-t[13]*p[6]-t[14]*p[10],p},r.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},r.interpret=function(t){var e=[t[0],t[1],t[2]],i=s(e[0]),a=o(e),u=[e[0]+i*a,e[1],e[2]],c=2/n(u);if(c>=1/0)return{translate:r.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];h[0]=1-c*u[0]*u[0],h[5]=1-c*u[1]*u[1],h[10]=1-c*u[2]*u[2],h[1]=-c*u[0]*u[1],h[2]=-c*u[0]*u[2],h[6]=-c*u[1]*u[2],h[4]=h[1],h[8]=h[2],h[9]=h[6];var l=r.multiply(h,t),p=[l[5],l[6]],f=s(p[0]),d=o(p),g=[p[0]+f*d,p[1]],m=2/n(g),v=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];v[5]=1-m*g[0]*g[0],v[10]=1-m*g[1]*g[1],v[6]=-m*g[0]*g[1],v[9]=v[6];var y=r.multiply(v,h),_=r.multiply(y,t),b=r.scale(_[0]<0?-1:1,_[5]<0?-1:1,_[10]<0?-1:1);_=r.multiply(_,b),y=r.multiply(b,y);var w={};return w.translate=r.getTranslate(t),w.rotate=[Math.atan2(-y[6],y[10]),Math.asin(y[2]),Math.atan2(-y[1],y[0])],w.rotate[0]||(w.rotate[0]=0,w.rotate[2]=Math.atan2(y[4],y[5])),w.scale=[_[0],_[5],_[10]],w.skew=[Math.atan2(_[9],w.scale[2]),Math.atan2(_[8],w.scale[2]),Math.atan2(_[4],w.scale[0])],Math.abs(w.rotate[0])+Math.abs(w.rotate[2])>1.5*Math.PI&&(w.rotate[1]=Math.PI-w.rotate[1],w.rotate[1]>Math.PI&&(w.rotate[1]-=2*Math.PI),w.rotate[1]<-Math.PI&&(w.rotate[1]+=2*Math.PI),w.rotate[0]<0?w.rotate[0]+=Math.PI:w.rotate[0]-=Math.PI,w.rotate[2]<0?w.rotate[2]+=Math.PI:w.rotate[2]-=Math.PI),w},r.average=function(t,e,i){i=void 0===i?.5:i;for(var n=r.interpret(t),o=r.interpret(e),s={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)s.translate[a]=(1-i)*n.translate[a]+i*o.translate[a],s.rotate[a]=(1-i)*n.rotate[a]+i*o.rotate[a],s.scale[a]=(1-i)*n.scale[a]+i*o.scale[a],s.skew[a]=(1-i)*n.skew[a]+i*o.skew[a];return r.build(s)},r.build=function(t){var e=r.scale(t.scale[0],t.scale[1],t.scale[2]),i=r.skew(t.skew[0],t.skew[1],t.skew[2]),n=r.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return r.thenMove(r.multiply(r.multiply(n,i),e),t.translate)},r.equals=function(t,e){return!r.notEquals(t,e)},r.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},r.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},r.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],r.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=r}),define("famous/core/SpecParser",["require","exports","module","./Transform"],function(t,e,i){function n(){this.result={}}function o(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var s=t("./Transform");n._instance=new n,n.parse=function(t,e){return n._instance.parse(t,e)},n.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,s.identity),this.result},n.prototype.reset=function(){this.result={}};var r=[0,0];n.prototype._parseSpec=function(t,e,i){var n,a,u,c,h,l,p;if("number"==typeof t){if(n=t,u=e.transform,l=e.align||e.origin,e.size&&l&&(l[0]||l[1])){var f=[l[0]*e.size[0],l[1]*e.size[1],0];u=s.thenMove(u,o(f,i))}this.result[n]={transform:u,opacity:e.opacity,origin:e.origin||r,align:e.align||e.origin||r,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var d=0;d<t.length;d++)this._parseSpec(t[d],e,i);else{a=t.target,u=e.transform,c=e.opacity,h=e.origin,l=e.align,p=e.size;var g=i;if(void 0!==t.opacity&&(c=e.opacity*t.opacity),t.transform&&(u=s.multiply(e.transform,t.transform)),t.origin&&(h=t.origin,g=e.transform),t.align&&(l=t.align),t.size){var m=e.size;p=[void 0!==t.size[0]?t.size[0]:m[0],void 0!==t.size[1]?t.size[1]:m[1]],m&&(l||(l=h),l&&(l[0]||l[1])&&(u=s.thenMove(u,o([l[0]*m[0],l[1]*m[1],0],i))),h&&(h[0]||h[1])&&(u=s.moveThen([-h[0]*p[0],-h[1]*p[1],0],u))),g=e.transform,h=null,l=null}this._parseSpec(a,{transform:u,opacity:c,origin:h,align:l,size:p},g)}}},i.exports=n}),define("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(t,e,i){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function o(t,e,i){for(var n=r.parse(t,e),a=Object.keys(n),u=0;u<a.length;u++){var c=a[u],h=s.get(c),l=n[c];l.allocator=e.allocator;var p=h.commit(l);p?o(p,e,i):i[c]=l}}var s=t("./Entity"),r=t("./SpecParser");n.prototype.add=function(t){var e=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),i=0;i<e.length;i++){var n=e[i];if(void 0===this._resultCache[n]){var r=s.get(n);r.cleanup&&r.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},o(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,i=0;i<e.length;i++)t[i]=e[i].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=n}),define("famous/core/EventEmitter",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var i=this.listeners[t].indexOf(e);return i>=0&&this.listeners[t].splice(i,1),this},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),define("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,i){function n(){o.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var o=t("./EventEmitter");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=t.on,t.removeListener=e.removeListener.bind(e)},n.prototype.emit=function(t,e){o.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger&&this.downstream[i].trigger(t,e);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](t,e);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(o.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(t,e)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return this},n.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.removeListener(i,this.upstreamListeners[i])}return this},i.exports=n}),define("famous/core/ElementAllocator",["require","exports","module"],function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.removeChild(e.firstChild));this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),define("famous/utilities/Utility",["require","exports","module"],function(t,e,i){var n={};n.Direction={X:0,Y:1,Z:2},n.after=function(t,e){var i=t;return function(){i--,0===i&&e.apply(this,arguments)}},n.loadURL=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()},n.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var i=document.createDocumentFragment();e.hasChildNodes();)i.appendChild(e.firstChild);return i},i.exports=n}),define("famous/transitions/MultipleTransition",["require","exports","module","famous/utilities/Utility"],function(t,e,i){function n(t){this.method=t,this._instances=[],this.state=[]}var o=t("famous/utilities/Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,e,i){for(var n=o.after(t.length,i),s=0;s<t.length;s++)this._instances[s]||(this._instances[s]=new this.method),this._instances[s].set(t[s],e,n)},n.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=n}),define("famous/transitions/TweenTransition",["require","exports","module"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function o(t,e,i){return(1-i)*t+i*e}function s(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function r(t,e){var i={curve:e.curve};return e.duration&&(i.duration=e.duration),e.speed&&(i.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(i.duration=t.duration),t.curve&&(i.curve=t.curve),t.speed&&(i.speed=t.speed)),"string"==typeof i.curve&&(i.curve=n.getCurve(i.curve)),i}function a(t,e,i,n,o){var s,r=1e-7,a=(i(o)-i(o-r))/r;if(t instanceof Array){s=[];for(var u=0;u<t.length;u++)s[u]="number"==typeof t[u]?a*(t[u]-e[u])/n:0}else s=a*(t-e)/n;return s}function u(t,e,i){var n;if(t instanceof Array){n=[];for(var s=0;s<t.length;s++)n[s]="number"==typeof t[s]?o(t[s],e[s],i):t[s]}else n=o(t,e,i);return n}n.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:n.Curves.linear,duration:500,speed:0};var c={};n.registerCurve=function(t,e){return c[t]?!1:(c[t]=e,!0)},n.unregisterCurve=function(t){return c[t]?(delete c[t],!0):!1},n.getCurve=function(t){var e=c[t];if(void 0!==e)return e;throw new Error("curve not registered")},n.getCurves=function(){return c},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),void(i&&i());if(this._startValue=s(this.get()),e=r(e,this.options),e.speed){var n=this._startValue;if(n instanceof Object){var o=0;for(var a in n)o+=(t[a]-n[a])*(t[a]-n[a]);e.duration=Math.sqrt(o)/e.speed}else e.duration=Math.abs(t-n)/e.speed}this._startTime=Date.now(),this._endValue=s(t),this._startVelocity=s(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=i},n.prototype.reset=function(t,e){if(this._callback){var i=this._callback;this._callback=void 0,i()}this.state=s(t),this.velocity=s(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},n.prototype.getVelocity=function(){return this.velocity},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var i=e/this._duration;this.state=u(this._startValue,this._endValue,this._curve(i)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,i)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",n.Curves.linear),n.registerCurve("easeIn",n.Curves.easeIn),n.registerCurve("easeOut",n.Curves.easeOut),n.registerCurve("easeInOut",n.Curves.easeInOut),n.registerCurve("easeOutBounce",n.Curves.easeOutBounce),n.registerCurve("spring",n.Curves.spring),n.customCurve=function(t,e){return t=t||0,e=e||0,function(i){return t*i+(-2*t-e+3)*i*i+(t+e-2)*i*i*i}},i.exports=n}),define("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(t,e,i){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function o(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,i=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(e=n.method,"string"==typeof e&&(e=a[e])):e=r,this._currentMethod!==e&&(this._engineInstance=!(i instanceof Object)||e.SUPPORTS_MULTIPLE===!0||i.length<=e.SUPPORTS_MULTIPLE?new e:new s(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(n.velocity=this.velocity),this._engineInstance.set(i,n,o.bind(this))}var s=t("./MultipleTransition"),r=t("./TweenTransition"),a={};n.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),this;var n=[t,e];return this.actionQueue.push(n),this.callbackQueue.push(i),this.currentAction||o.call(this),this},n.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,e){this.set(this.get(),{duration:t,curve:function(){return 0}},e)},n.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){this.set(this.get())},i.exports=n}),define("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","famous/transitions/Transitionable"],function(t,e,i){function n(t){return[t.clientWidth,t.clientHeight]}function o(t){this.container=t,this._allocator=new a(t),this._node=new s,this._eventOutput=new r,this._size=n(this.container),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:u.identity,opacity:1,origin:h,align:null,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n(this.container))}.bind(this))}var s=t("./RenderNode"),r=t("./EventHandler"),a=t("./ElementAllocator"),u=t("./Transform"),c=t("famous/transitions/Transitionable"),h=[0,0];o.prototype.getAllocator=function(){return this._allocator},o.prototype.add=function(t){return this._node.add(t)},o.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},o.prototype.getSize=function(){return this._size},o.prototype.setSize=function(t){t||(t=n(this.container)),this._size[0]=t[0],this._size[1]=t[1]},o.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(this.container.style.perspective=e?e.toFixed()+"px":"",this.container.style.webkitPerspective=e?e.toFixed():"",this._perspective=e),this._node.commit(this._nodeContext)},o.prototype.getPerspective=function(){return this._perspectiveState.get()},o.prototype.setPerspective=function(t,e,i){return this._perspectiveState.set(t,e,i)},o.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},o.prototype.on=function(t,e){return this._eventOutput.on(t,e)},o.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},o.prototype.pipe=function(t){return this._eventOutput.pipe(t)},o.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=o}),define("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function o(){this.eventOutput=new s,this.eventOutput.bindThis(this),s.setOutputHandler(this,this.eventOutput)}var s=t("./EventHandler");n.patch=function(t){for(var e=new n(t),i=1;i<arguments.length;i++)e.patch(arguments[i]);return t},n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)n in t&&i[n]&&i[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,i[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return this._value[t]},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.value=function(){return this._value},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return o.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(t,e,i){function n(){y.runLoop?(h.step(),window.requestAnimationFrame(n)):g=!1}function o(){for(var t=0;t<l.length;t++)l[t].emit("resize");v.emit("resize")}var s,r,a=t("./Context"),u=t("./EventHandler"),c=t("./OptionsManager"),h={},l=[],p=[],f=[],d=Date.now(),g=!0,m={},v=new u,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0},_=new c(y),b=10;h.step=function(){var t=Date.now();if(!(r&&r>t-d)){var e=0;for(s=t-d,d=t,v.emit("prerender"),e=0;e<p.length;e++)p[e].call(this);for(p.splice(0);f.length&&Date.now()-t<b;)f.shift().call(this);for(e=0;e<l.length;e++)l[e].update();v.emit("postrender")}},window.requestAnimationFrame(n),window.addEventListener("resize",o,!1),o(),window.addEventListener("touchmove",function(t){t.preventDefault()},!0),h.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(h):v.pipe(t)},h.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(h):v.unpipe(t)},h.on=function(t,e){return t in m||(m[t]=v.emit.bind(v,t),document.body?document.body.addEventListener(t,m[t]):h.nextTick(function(t,e){document.body.addEventListener(t,e)}.bind(this,t,m[t]))),v.on(t,e)},h.emit=function(t,e){return v.emit(t,e)},h.removeListener=function(t,e){return v.removeListener(t,e)},h.getFPS=function(){return 1e3/s},h.setFPSCap=function(t){r=Math.floor(1e3/t)},h.getOptions=function(){return _.getOptions.apply(_,arguments)},h.setOptions=function(){return _.setOptions.apply(_,arguments)},h.createContext=function(t){var e=!1;t||(t=document.createElement(y.containerType),t.classList.add(y.containerClass),e=!0);var i=new a(t);return h.registerContext(i),e&&h.nextTick(function(t,e){document.body.appendChild(e),t.emit("resize")}.bind(this,i,t)),i},h.registerContext=function(t){return l.push(t),t},h.nextTick=function(t){p.push(t)},h.defer=function(t){f.push(t)},_.on("change",function(t){"fpsCap"===t.id?h.setFPSCap(t.value):"runLoop"===t.id&&!g&&t.value&&(g=!0,window.requestAnimationFrame(n))}),i.exports=h}),!function(){var t,e,i,n;!function(){var o={},s={};t=function(t,e,i){o[t]={deps:e,callback:i}},n=i=e=function(t){function i(e){if("."!==e.charAt(0))return e;for(var i=e.split("/"),n=t.split("/").slice(0,-1),o=0,s=i.length;s>o;o++){var r=i[o];if(".."===r)n.pop();else{if("."===r)continue;n.push(r)}}return n.join("/")}if(n._eak_seen=o,s[t])return s[t];if(s[t]={},!o[t])throw new Error("Could not find module "+t);for(var r,a=o[t],u=a.deps,c=a.callback,h=[],l=0,p=u.length;p>l;l++)h.push("exports"===u[l]?r={}:e(i(u[l])));var f=c.apply(this,h);return s[t]=r||f}}(),t("promise/all",["./utils","exports"],function(t,e){function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to all.");return new e(function(e,i){function n(t){return function(e){s(t,e)}}function s(t,i){a[t]=i,0===--u&&e(a)}var r,a=[],u=t.length;0===u&&e([]);for(var c=0;c<t.length;c++)r=t[c],r&&o(r.then)?r.then(n(c),i):s(c,r)})}var n=t.isArray,o=t.isFunction;e.all=i}),t("promise/asap",["exports"],function(t){function e(){return function(){process.nextTick(o)}}function i(){var t=0,e=new u(o),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function n(){return function(){c.setTimeout(o,1)}}function o(){for(var t=0;t<h.length;t++){var e=h[t],i=e[0],n=e[1];i(n)}h=[]}function s(t,e){var i=h.push([t,e]);1===i&&r()}var r,a="undefined"!=typeof window?window:{},u=a.MutationObserver||a.WebKitMutationObserver,c="undefined"!=typeof global?global:void 0===this?window:this,h=[];r="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():u?i():n(),t.asap=s}),t("promise/config",["exports"],function(t){function e(t,e){return 2!==arguments.length?i[t]:void(i[t]=e)}var i={instrument:!1};t.config=i,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,i){function n(){var t;t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),s(e)}();e||(t.Promise=o)}var o=t.Promise,s=e.isFunction;i.polyfill=n}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,i,n,o,s,r,a){function u(t){if(!w(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof u))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
this._subscribers=[],c(t,this)}function c(t,e){function i(t){d(e,t)}function n(t){m(e,t)}try{t(i,n)}catch(o){n(o)}}function h(t,e,i,n){var o,s,r,a,u=w(i);if(u)try{o=i(n),r=!0}catch(c){a=!0,s=c}else o=n,r=!0;f(e,o)||(u&&r?d(e,o):a?m(e,s):t===k?d(e,o):t===M&&m(e,o))}function l(t,e,i,n){var o=t._subscribers,s=o.length;o[s]=e,o[s+k]=i,o[s+M]=n}function p(t,e){for(var i,n,o=t._subscribers,s=t._detail,r=0;r<o.length;r+=3)i=o[r],n=o[r+e],h(e,i,n,s);t._subscribers=null}function f(t,e){var i,n=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(b(e)&&(n=e.then,w(n)))return n.call(e,function(n){return i?!0:(i=!0,void(e!==n?d(t,n):g(t,n)))},function(e){return i?!0:(i=!0,void m(t,e))}),!0}catch(o){return i?!0:(m(t,o),!0)}return!1}function d(t,e){t===e?g(t,e):f(t,e)||g(t,e)}function g(t,e){t._state===I&&(t._state=C,t._detail=e,_.async(v,t))}function m(t,e){t._state===I&&(t._state=C,t._detail=e,_.async(y,t))}function v(t){p(t,t._state=k)}function y(t){p(t,t._state=M)}var _=t.config,b=(t.configure,e.objectOrFunction),w=e.isFunction,S=(e.now,i.all),x=n.race,O=o.resolve,T=s.reject,E=r.asap;_.async=E;var I=void 0,C=0,k=1,M=2;u.prototype={constructor:u,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var i=this,n=new this.constructor(function(){});if(this._state){var o=arguments;_.async(function(){h(i._state,n,o[i._state-1],i._detail)})}else l(this,n,t,e);return n},"catch":function(t){return this.then(null,t)}},u.all=S,u.race=x,u.resolve=O,u.reject=T,a.Promise=u}),t("promise/race",["./utils","exports"],function(t,e){function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to race.");return new e(function(e,i){for(var n,o=0;o<t.length;o++)n=t[o],n&&"function"==typeof n.then?n.then(e,i):e(n)})}var n=t.isArray;e.race=i}),t("promise/reject",["exports"],function(t){function e(t){var e=this;return new e(function(e,i){i(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){function e(t){return i(t)||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=i,t.isArray=n,t.now=o}),e("promise/polyfill").polyfill()}(),function(){function t(t){if(t)for(var e in t)c[e]=t[e];return new a(function(t,e){var i=h.open(c.name,c.version);i.onerror=function(){e(i.error)},i.onupgradeneeded=function(){i.result.createObjectStore(c.storeName)},i.onsuccess=function(){u=i.result,t()}})}function e(t,e){var i=this;return new a(function(n,o){i.ready().then(function(){var i=u.transaction(c.storeName,"readonly").objectStore(c.storeName),s=i.get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),e&&e(t),n(t)},s.onerror=function(){e&&e(null,s.error),o(s.error)}})})}function i(t,e,i){var n=this;return new a(function(o,s){n.ready().then(function(){var n=u.transaction(c.storeName,"readwrite").objectStore(c.storeName);void 0===e&&(e=null);var r=n.put(e,t);r.onsuccess=function(){i&&i(e),o(e)},r.onerror=function(){i&&i(null,r.error),s(r.error)}})})}function n(t,e){var i=this;return new a(function(n,o){i.ready().then(function(){var i=u.transaction(c.storeName,"readwrite").objectStore(c.storeName),s=i["delete"](t);s.onsuccess=function(){e&&e(),n()},s.onerror=function(){e&&e(s.error),o(s.error)},s.onabort=function(t){var i=t.target.error;"QuotaExceededError"===i&&(e&&e(i),o(i))}})})}function o(t){var e=this;return new a(function(i,n){e.ready().then(function(){var e=u.transaction(c.storeName,"readwrite").objectStore(c.storeName),o=e.clear();o.onsuccess=function(){t&&t(),i()},o.onerror=function(){t&&t(null,o.error),n(o.error)}})})}function s(t){var e=this;return new a(function(i,n){e.ready().then(function(){var e=u.transaction(c.storeName,"readonly").objectStore(c.storeName),o=e.count();o.onsuccess=function(){t&&t(o.result),i(o.result)},o.onerror=function(){t&&t(null,o.error),n(o.error)}})})}function r(t,e){var i=this;return new a(function(n,o){return 0>t?(e&&e(null),void n(null)):void i.ready().then(function(){var i=u.transaction(c.storeName,"readonly").objectStore(c.storeName),s=!1,r=i.openCursor();r.onsuccess=function(){var i=r.result;return i?void(0===t?(e&&e(i.key),n(i.key)):s?(e&&e(i.key),n(i.key)):(s=!0,i.advance(t))):(e&&e(null),void n(null))},r.onerror=function(){e&&e(null,r.error),o(r.error)}})})}var a="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,u=null,c={},h=h||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(h){var l={_driver:"asyncStorage",_initStorage:t,getItem:e,setItem:i,removeItem:n,clear:o,length:s,key:r};"function"==typeof define&&define.amd?define("asyncStorage",function(){return l}):"undefined"!=typeof module&&module.exports?module.exports=l:this.asyncStorage=l}}.call(this),function(){function t(t){if(t)for(var e in t)l[e]=t[e];return h=l.name+"/",p.resolve()}function e(t){var e=this;return new p(function(i){e.ready().then(function(){f.clear(),t&&t(),i()})})}function i(t,e){var i=this;return new p(function(n,o){i.ready().then(function(){try{var i=f.getItem(h+t);i&&(i=r(i)),e&&e(i,null),n(i)}catch(s){e&&e(null,s),o(s)}})})}function n(t,e){var i=this;return new p(function(n){i.ready().then(function(){var i=f.key(t);i&&(i=i.substring(h.length)),e&&e(i),n(i)})})}function o(t){var e=this;return new p(function(i){e.ready().then(function(){var e=f.length;t&&t(e),i(e)})})}function s(t,e){var i=this;return new p(function(n){i.ready().then(function(){f.removeItem(h+t),e&&e(),n()})})}function r(t){if(t.substring(0,m)!==g)return JSON.parse(t);for(var e=t.substring(C),i=t.substring(m,C),n=new ArrayBuffer(2*e.length),o=new Uint16Array(n),s=e.length-1;s>=0;s--)o[s]=e.charCodeAt(s);switch(i){case v:return n;case y:return new Blob([n]);case _:return new Int8Array(n);case b:return new Uint8Array(n);case w:return new Uint8ClampedArray(n);case S:return new Int16Array(n);case O:return new Uint16Array(n);case x:return new Int32Array(n);case T:return new Uint32Array(n);case E:return new Float32Array(n);case I:return new Float64Array(n);default:throw new Error("Unkown type: "+i)}}function a(t){var e="",i=new Uint16Array(t);try{e=String.fromCharCode.apply(null,i)}catch(n){for(var o=0;o<i.length;o++)e+=String.fromCharCode(i[o])}return e}function u(t,e){var i="";if(t&&(i=t.toString()),t&&("[object ArrayBuffer]"===t.toString()||t.buffer&&"[object ArrayBuffer]"===t.buffer.toString())){var n,o=g;t instanceof ArrayBuffer?(n=t,o+=v):(n=t.buffer,"[object Int8Array]"===i?o+=_:"[object Uint8Array]"===i?o+=b:"[object Uint8ClampedArray]"===i?o+=w:"[object Int16Array]"===i?o+=S:"[object Uint16Array]"===i?o+=O:"[object Int32Array]"===i?o+=x:"[object Uint32Array]"===i?o+=T:"[object Float32Array]"===i?o+=E:"[object Float64Array]"===i?o+=I:e(new Error("Failed to get type for BinaryArray"))),e(o+a(n))}else if("[object Blob]"===i){var s=new FileReader;s.onload=function(){var t=a(this.result);e(g+y+t)},s.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(r){this.console&&this.console.error&&this.console.error("Couldn't convert value into a JSON string: ",t),e(null,r)}}function c(t,e,i){var n=this;return new p(function(o,s){n.ready().then(function(){void 0===e&&(e=null);var n=e;u(e,function(e,r){if(r)i&&i(null,r),s(r);else{try{f.setItem(h+t,e)}catch(a){("QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&(i&&i(null,a),s(a))}i&&i(n),o(n)}})})})}var h="",l={},p="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,f=null;try{f=this.localStorage}catch(d){return}var g="__lfsc__:",m=g.length,v="arbf",y="blob",_="si08",b="ui08",w="uic8",S="si16",x="si32",O="ur16",T="ui32",E="fl32",I="fl64",C=m+v.length,k={_driver:"localStorageWrapper",_initStorage:t,getItem:i,setItem:c,removeItem:s,clear:e,length:o,key:n};"function"==typeof define&&define.amd?define("localStorageWrapper",function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:this.localStorageWrapper=k}.call(this),function(){function t(t){var e=this;if(t)for(var i in t)d[i]="string"!=typeof t[i]?t[i].toString():t[i];return new l(function(t){try{f=p(d.name,d.version,d.description,d.size)}catch(i){return e.setDriver("localStorageWrapper").then(t)}f.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+d.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t()},null)})})}function e(t,e){var i=this;return new l(function(n,o){i.ready().then(function(){f.transaction(function(i){i.executeSql("SELECT * FROM "+d.storeName+" WHERE key = ? LIMIT 1",[t],function(t,i){var o=i.rows.length?i.rows.item(0).value:null;o&&(o=u(o)),e&&e(o),n(o)},function(t,i){e&&e(null,i),o(i)})})})})}function i(t,e,i){var n=this;return new l(function(o,s){n.ready().then(function(){void 0===e&&(e=null);var n=e;c(e,function(e,r){r?s(r):f.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+d.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){i&&i(n),o(n)},function(t,e){i&&i(null,e),s(e)})},function(t){t.code===t.QUOTA_ERR&&(i&&i(null,t),s(t))})})})})}function n(t,e){var i=this;return new l(function(n,o){i.ready().then(function(){f.transaction(function(i){i.executeSql("DELETE FROM "+d.storeName+" WHERE key = ?",[t],function(){e&&e(),n()},function(t,i){e&&e(i),o(i)})})})})}function o(t){var e=this;return new l(function(i,n){e.ready().then(function(){f.transaction(function(e){e.executeSql("DELETE FROM "+d.storeName,[],function(){t&&t(),i()},function(e,i){t&&t(i),n(i)})})})})}function s(t){var e=this;return new l(function(i,n){e.ready().then(function(){f.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+d.storeName,[],function(e,n){var o=n.rows.item(0).c;t&&t(o),i(o)},function(e,i){t&&t(null,i),n(i)})})})})}function r(t,e){var i=this;return new l(function(n,o){i.ready().then(function(){f.transaction(function(i){i.executeSql("SELECT key FROM "+d.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,i){var o=i.rows.length?i.rows.item(0).key:null;e&&e(o),n(o)},function(t,i){e&&e(null,i),o(i)})})})})}function a(t){var e,i=new Uint8Array(t),n="";for(e=0;e<i.length;e+=3)n+=h[i[e]>>2],n+=h[(3&i[e])<<4|i[e+1]>>4],n+=h[(15&i[e+1])<<2|i[e+2]>>6],n+=h[63&i[e+2]];return i.length%3===2?n=n.substring(0,n.length-1)+"=":i.length%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function u(t){if(t.substring(0,m)!==g)return JSON.parse(t);var e,i,n,o,s,r=t.substring(C),a=t.substring(m,C),u=.75*r.length,c=r.length,l=0;"="===r[r.length-1]&&(u--,"="===r[r.length-2]&&u--);var p=new ArrayBuffer(u),f=new Uint8Array(p);for(e=0;c>e;e+=4)i=h.indexOf(r[e]),n=h.indexOf(r[e+1]),o=h.indexOf(r[e+2]),s=h.indexOf(r[e+3]),f[l++]=i<<2|n>>4,f[l++]=(15&n)<<4|o>>2,f[l++]=(3&o)<<6|63&s;switch(a){case v:return p;case y:return new Blob([p]);case _:return new Int8Array(p);case b:return new Uint8Array(p);case w:return new Uint8ClampedArray(p);case S:return new Int16Array(p);case O:return new Uint16Array(p);case x:return new Int32Array(p);case T:return new Uint32Array(p);case E:return new Float32Array(p);case I:return new Float64Array(p);default:throw new Error("Unkown type: "+a)}}function c(t,e){var i="";if(t&&(i=t.toString()),t&&("[object ArrayBuffer]"===t.toString()||t.buffer&&"[object ArrayBuffer]"===t.buffer.toString())){var n,o=g;t instanceof ArrayBuffer?(n=t,o+=v):(n=t.buffer,"[object Int8Array]"===i?o+=_:"[object Uint8Array]"===i?o+=b:"[object Uint8ClampedArray]"===i?o+=w:"[object Int16Array]"===i?o+=S:"[object Uint16Array]"===i?o+=O:"[object Int32Array]"===i?o+=x:"[object Uint32Array]"===i?o+=T:"[object Float32Array]"===i?o+=E:"[object Float64Array]"===i?o+=I:e(new Error("Failed to get type for BinaryArray"))),e(o+a(n))}else if("[object Blob]"===i){var s=new FileReader;s.onload=function(){var t=a(this.result);e(g+y+t)},s.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(r){this.console&&this.console.error&&this.console.error("Couldn't convert value into a JSON string: ",t),e(null,r)}}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,p=this.openDatabase,f=null,d={},g="__lfsc__:",m=g.length,v="arbf",y="blob",_="si08",b="ui08",w="uic8",S="si16",x="si32",O="ur16",T="ui32",E="fl32",I="fl64",C=m+v.length;if(p){var k={_driver:"webSQLStorage",_initStorage:t,getItem:e,setItem:i,removeItem:n,clear:o,length:s,key:r};"function"==typeof define&&define.amd?define("webSQLStorage",function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:this.webSQLStorage=k}}.call(this),function(){var t="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,e=1,i=2,n=3,o=n;"function"==typeof define&&define.amd?o=e:"undefined"!=typeof module&&module.exports&&(o=i);var s,r=r||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB,a=r&&null===r.open("_localforage_spec_test",1).onupgradeneeded,u=this.openDatabase,c=this,h={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage",_config:{description:"",name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},config:function(t){if("object"==typeof t){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t)this._config[e]=t[e];return!0}return"string"==typeof t?this._config[t]:this._config},driver:function(){return this._driver||null},_ready:t.reject(new Error("setDriver() wasn't called")),setDriver:function(n,s){var r=new t(function(t,s){if(!a&&n===h.INDEXEDDB||!u&&n===h.WEBSQL)return void s(h);if(h._ready=null,o===e)return void require([n],function(e){h._extend(e),t(h)});if(o===i){var r;switch(n){case h.INDEXEDDB:r=require("./drivers/indexeddb");break;case h.LOCALSTORAGE:r=require("./drivers/localstorage");break;case h.WEBSQL:r=require("./drivers/websql")}h._extend(r)}else h._extend(c[n]);t(h)});return r.then(s,s),r},ready:function(t){return null===this._ready&&(this._ready=this._initStorage(this._config)),this._ready.then(t,t),this._ready},_extend:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}};s=a?h.INDEXEDDB:u?h.WEBSQL:h.LOCALSTORAGE,this.localForageConfig&&(h.config=this.localForageConfig),h.setDriver(s),o===e?define("localforage",[],function(){return h}):o===i?module.exports=h:this.localforage=h}.call(this),define("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode"],function(t,e,i){function n(t){this._node=new r,this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var o=t("./EventHandler"),s=t("./OptionsManager"),r=t("./RenderNode");n.DEFAULT_OPTIONS={},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.add=function(){return this._node.add.apply(this._node,arguments)},n.prototype._add=n.prototype.add,n.prototype.render=function(){return this._node.render()},n.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=n}),define("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","famous/core/Transform","famous/utilities/Utility"],function(t,e,i){function n(t){this._final=r.identity.slice(),this.translate=new s([0,0,0]),this.rotate=new s([0,0,0]),this.skew=new s([0,0,0]),this.scale=new s([1,1,1]),t&&this.set(t)}function o(){return r.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}var s=t("./Transitionable"),r=t("famous/core/Transform"),a=t("famous/utilities/Utility");n.prototype.setTranslate=function(t,e,i){return this.translate.set(t,e,i),this._final=this._final.slice(),this._final[12]=t[0],this._final[13]=t[1],void 0!==t[2]&&(this._final[14]=t[2]),this},n.prototype.setScale=function(t,e,i){return this.scale.set(t,e,i),this._final=this._final.slice(),this._final[0]=t[0],this._final[5]=t[1],void 0!==t[2]&&(this._final[10]=t[2]),this},n.prototype.setRotate=function(t,e,i){return this.rotate.set(t,e,i),this._final=o.call(this),this._final=r.build({translate:this.translate.get(),rotate:t,scale:this.scale.get(),skew:this.skew.get()}),this},n.prototype.setSkew=function(t,e,i){return this.skew.set(t,e,i),this._final=r.build({translate:this.translate.get(),rotate:this.rotate.get(),scale:this.scale.get(),skew:t}),this},n.prototype.set=function(t,e,i){this._final=t;var n=r.interpret(t),o=i?a.after(4,i):null;return this.translate.set(n.translate,e,o),this.rotate.set(n.rotate,e,o),this.skew.set(n.skew,e,o),this.scale.set(n.scale,e,o),this},n.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},n.prototype.get=function(){return this.isActive()?o.call(this):this._final},n.prototype.getFinal=function(){return this._final},n.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},n.prototype.halt=function(){this._final=this.get(),this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt()},i.exports=n}),define("famous/core/Modifier",["require","exports","module","./Transform","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._legacyStates={},this._output={transform:s.identity,opacity:1,origin:null,align:null,size:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size))}function o(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter())}var s=t("./Transform"),r=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.setTransform=function(t,e,i){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,i),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,e,i){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new r(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,i)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,e,i){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new r(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,i),this):this.originFrom(t)},n.prototype.setAlign=function(t,e,i){return e||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new r(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,e,i),this):this.alignFrom(t)},n.prototype.setSize=function(t,e,i){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new r(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,i),this):this.sizeFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getAlign=function(){return this._alignGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.modify=function(t){return o.call(this),this._output.target=t,this._output},i.exports=n}),define("famous/modifiers/StateModifier",["require","exports","module","famous/core/Modifier","famous/core/Transform","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformState=new a(s.identity),this._opacityState=new r(1),this._originState=new r([0,0]),this._alignState=new r([0,0]),this._sizeState=new r([0,0]),this._modifier=new o({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.align&&this.setAlign(t.align),t.size&&this.setSize(t.size))}var o=t("famous/core/Modifier"),s=t("famous/core/Transform"),r=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");n.prototype.setTransform=function(t,e,i){return this._transformState.set(t,e,i),this},n.prototype.setOpacity=function(t,e,i){return this._opacityState.set(t,e,i),this},n.prototype.setOrigin=function(t,e,i){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,e,i),this)},n.prototype.setAlign=function(t,e,i){return null===t?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(t,e,i),this)},n.prototype.setSize=function(t,e,i){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,e,i),this)},n.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt()},n.prototype.getTransform=function(){return this._transformState.get()},n.prototype.getFinalTransform=function(){return this._transformState.getFinal()},n.prototype.getOpacity=function(){return this._opacityState.get()},n.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},n.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},n.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},n.prototype.modify=function(t){return this._modifier.modify(t)},i.exports=n}),define("famous/views/Lightbox",["require","exports","module","famous/core/Transform","famous/core/Modifier","famous/core/RenderNode","famous/utilities/Utility","famous/core/OptionsManager","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var o=t("famous/core/Transform"),s=t("famous/core/Modifier"),r=t("famous/core/RenderNode"),a=t("famous/utilities/Utility"),u=t("famous/core/OptionsManager"),c=t("famous/transitions/Transitionable"),h=t("famous/transitions/TransitionableTransform");n.DEFAULT_OPTIONS={inTransform:o.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],outTransform:o.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,e,i));this.hide()}this._showing=!0;var n={transform:new h(this.options.inTransform),origin:new c(this.options.inOrigin),opacity:new c(this.options.inOpacity)},o=new s({transform:n.transform,opacity:n.opacity,origin:n.origin}),u=new r;u.add(o).add(t),this.nodes.push(u),this.states.push(n),this.transforms.push(o);var l=i?a.after(3,i):void 0;e||(e=this.options.inTransition),n.transform.set(this.options.showTransform,e,l),n.opacity.set(this.options.showOpacity,e,l),n.origin.set(this.options.showOrigin,e,l)},n.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var i=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],o=this.states[this.states.length-1],s=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(i),1),this.states.splice(this.states.indexOf(o),1),this.transforms.splice(this.transforms.indexOf(n),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),o.transform.set(this.options.outTransform,t,s),o.opacity.set(this.options.outOpacity,t,s),o.origin.set(this.options.outOrigin,t,s)}},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=n}),define("famous/utilities/Timer",["require","exports","module","famous/core/Engine"],function(t,e,i){function n(t){return h.on(l,t),t}function o(t,e){var i=p(),o=function(){var n=p();n-i>=e&&(t.apply(this,arguments),h.removeListener(l,o))};return n(o)}function s(t,e){var i=p(),o=function(){var n=p();n-i>=e&&(t.apply(this,arguments),i=p())};return n(o)}function r(t,e){if(void 0===e)return void 0;var i=function(){e--,0>=e&&(t.apply(this,arguments),u(i))};return n(i)}function a(t,e){e=e||1;var i=e,o=function(){e--,0>=e&&(t.apply(this,arguments),e=i)};return n(o)}function u(t){h.removeListener(l,t)}function c(t,e){var i,n,s,r,a;return function(){n=this,a=arguments,s=p();var c=function(){var u=p-s;e>u?i=o(c,e-u):(i=null,r=t.apply(n,a))};return u(i),i=o(c,e),r}}var h=t("famous/core/Engine"),l="prerender",p=window.performance?function(){return window.performance.now()}:function(){return Date.now()};i.exports={setTimeout:o,setInterval:s,debounce:c,after:r,every:a,clear:u}}),define("utils",["require","exports","module"],function(t,e,i){function n(){}n.getViewportWidth=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},n.getViewportHeight=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},n.getRandomIntInRange=function(t,e){var i=Math.floor(Math.random()*(e-t+1))+t;return i},n.getRandomArrayItem=function(t){var e=this.getRandomIntInRange(0,t.length-1);return t[e]},i.exports=n}),function(){function t(t,e,i){for(var n=(i||0)-1,o=t?t.length:0;++n<o;)if(t[n]===e)return n;return-1}function e(e,i){var n=typeof i;if(e=e.cache,"boolean"==n||null==i)return e[i]?0:-1;"number"!=n&&"string"!=n&&(n="object");var o="number"==n?i:_+i;return e=(e=e[n])&&e[o],"object"==n?e&&t(e,i)>-1?0:-1:e?0:-1}function i(t){var e=this.cache,i=typeof t;if("boolean"==i||null==t)e[t]=!0;else{"number"!=i&&"string"!=i&&(i="object");var n="number"==i?t:_+t,o=e[i]||(e[i]={});"object"==i?(o[n]||(o[n]=[])).push(t):o[n]=!0}}function n(t){return t.charCodeAt(0)}function o(t,e){for(var i=t.criteria,n=e.criteria,o=-1,s=i.length;++o<s;){var r=i[o],a=n[o];if(r!==a){if(r>a||"undefined"==typeof r)return 1;if(a>r||"undefined"==typeof a)return-1}}return t.index-e.index}function s(t){var e=-1,n=t.length,o=t[0],s=t[n/2|0],r=t[n-1];if(o&&"object"==typeof o&&s&&"object"==typeof s&&r&&"object"==typeof r)return!1;var a=u();a["false"]=a["null"]=a["true"]=a.undefined=!1;var c=u();for(c.array=t,c.cache=a,c.push=i;++e<n;)c.push(t[e]);return c}function r(t){return"\\"+K[t]}function a(){return g.pop()||[]}function u(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function c(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function h(t){t.length=0,g.length<w&&g.push(t)}function l(t){var e=t.cache;e&&l(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,m.length<w&&m.push(t)}function p(t,e,i){e||(e=0),"undefined"==typeof i&&(i=t?t.length:0);for(var n=-1,o=i-e||0,s=Array(0>o?0:o);++n<o;)s[n]=t[e+n];return s}function f(i){function g(t){return t&&"object"==typeof t&&!lo(t)&&Gn.call(t,"__wrapped__")?t:new m(t)}function m(t,e){this.__chain__=!!e,this.__wrapped__=t}function w(t){function e(){if(n){var t=p(n);Un.apply(t,arguments)}if(this instanceof e){var s=ee(i.prototype),r=i.apply(s,t||arguments);return Fe(r)?r:s}return i.apply(o,t||arguments)}var i=t[0],n=t[2],o=t[4];return ho(e,t),e}function K(t,e,i,n,o){if(i){var s=i(t);if("undefined"!=typeof s)return s}var r=Fe(t);if(!r)return t;var u=Fn.call(t);if(!Y[u]||!uo.nodeClass&&c(t))return t;var l=ro[u];switch(u){case j:case R:return new l(+t);case G:case X:return new l(t);case $:return s=l(t.source,I.exec(t)),s.lastIndex=t.lastIndex,s}var f=lo(t);if(e){var d=!n;n||(n=a()),o||(o=a());for(var g=n.length;g--;)if(n[g]==t)return o[g];s=f?l(t.length):{}}else s=f?p(t):xo({},t);return f&&(Gn.call(t,"index")&&(s.index=t.index),Gn.call(t,"input")&&(s.input=t.input)),e?(n.push(t),o.push(s),(f?So:Eo)(t,function(t,r){s[r]=K(t,e,i,n,o)}),d&&(h(n),h(o)),s):s}function ee(t){return Fe(t)?Jn(t):{}}function ie(t,e,i){if("function"!=typeof t)return sn;if("undefined"==typeof e||!("prototype"in t))return t;var n=t.__bindData__;if("undefined"==typeof n&&(uo.funcNames&&(n=!t.name),n=n||!uo.funcDecomp,!n)){var o=qn.call(t);uo.funcNames||(n=!C.test(o)),n||(n=A.test(o),ho(t,n))}if(n===!1||n!==!0&&1&n[1])return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,s){return t.call(e,i,n,o,s)}}return Ri(t,e)}function ne(t){function e(){var t=u?r:this;if(o){var d=p(o);Un.apply(d,arguments)}if((s||h)&&(d||(d=p(arguments)),s&&Un.apply(d,s),h&&d.length<a))return n|=16,ne([i,l?n:-4&n,d,null,r,a]);if(d||(d=arguments),c&&(i=t[f]),this instanceof e){t=ee(i.prototype);
var g=i.apply(t,d);return Fe(g)?g:t}return i.apply(t,d)}var i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=t[5],u=1&n,c=2&n,h=4&n,l=8&n,f=i;return ho(e,t),e}function oe(i,n){var o=-1,r=ge(),a=i?i.length:0,u=a>=b&&r===t,c=[];if(u){var h=s(n);h?(r=e,n=h):u=!1}for(;++o<a;){var p=i[o];r(n,p)<0&&c.push(p)}return u&&l(n),c}function re(t,e,i,n){for(var o=(n||0)-1,s=t?t.length:0,r=[];++o<s;){var a=t[o];if(a&&"object"==typeof a&&"number"==typeof a.length&&(lo(a)||_e(a))){e||(a=re(a,e,i));var u=-1,c=a.length,h=r.length;for(r.length+=c;++u<c;)r[h++]=a[u]}else i||r.push(a)}return r}function ae(t,e,i,n,o,s){if(i){var r=i(t,e);if("undefined"!=typeof r)return!!r}if(t===e)return 0!==t||1/t==1/e;var u=typeof t,l=typeof e;if(!(t!==t||t&&Z[u]||e&&Z[l]))return!1;if(null==t||null==e)return t===e;var p=Fn.call(t),f=Fn.call(e);if(p==H&&(p=U),f==H&&(f=U),p!=f)return!1;switch(p){case j:case R:return+t==+e;case G:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case $:case X:return t==Mn(e)}var d=p==V;if(!d){var g=Gn.call(t,"__wrapped__"),m=Gn.call(e,"__wrapped__");if(g||m)return ae(g?t.__wrapped__:t,m?e.__wrapped__:e,i,n,o,s);if(p!=U||!uo.nodeClass&&(c(t)||c(e)))return!1;var v=!uo.argsObject&&_e(t)?Cn:t.constructor,y=!uo.argsObject&&_e(e)?Cn:e.constructor;if(v!=y&&!(De(v)&&v instanceof v&&De(y)&&y instanceof y)&&"constructor"in t&&"constructor"in e)return!1}var _=!o;o||(o=a()),s||(s=a());for(var b=o.length;b--;)if(o[b]==t)return s[b]==e;var w=0;if(r=!0,o.push(t),s.push(e),d){if(b=t.length,w=e.length,r=w==b,r||n)for(;w--;){var S=b,x=e[w];if(n)for(;S--&&!(r=ae(t[S],x,i,n,o,s)););else if(!(r=ae(t[w],x,i,n,o,s)))break}}else To(e,function(e,a,u){return Gn.call(u,a)?(w++,r=Gn.call(t,a)&&ae(t[a],e,i,n,o,s)):void 0}),r&&!n&&To(t,function(t,e,i){return Gn.call(i,e)?r=--w>-1:void 0});return o.pop(),s.pop(),_&&(h(o),h(s)),r}function ue(t,e,i,n,o){(lo(e)?ni:Eo)(e,function(e,s){var r,a,u=e,c=t[s];if(e&&((a=lo(e))||Io(e))){for(var h=n.length;h--;)if(r=n[h]==e){c=o[h];break}if(!r){var l;i&&(u=i(c,e),(l="undefined"!=typeof u)&&(c=u)),l||(c=a?lo(c)?c:[]:Io(c)?c:{}),n.push(e),o.push(c),l||ue(c,e,i,n,o)}}else i&&(u=i(c,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(c=u);t[s]=c})}function ce(t,e){return t+Rn(so()*(e-t+1))}function he(i,n,o){var r=-1,u=ge(),c=i?i.length:0,p=[],f=!n&&c>=b&&u===t,d=o||f?a():p;if(f){var g=s(d);u=e,d=g}for(;++r<c;){var m=i[r],v=o?o(m,r,i):m;(n?!r||d[d.length-1]!==v:u(d,v)<0)&&((o||f)&&d.push(v),p.push(m))}return f?(h(d.array),l(d)):o&&h(d),p}function le(t){return function(e,i,n){var o={};if(i=g.createCallback(i,n,3),lo(e))for(var s=-1,r=e.length;++s<r;){var a=e[s];t(o,a,i(a,s,e),e)}else So(e,function(e,n,s){t(o,e,i(e,n,s),s)});return o}}function pe(t,e,i,n,o,s){var r=1&e,a=2&e,u=4&e,c=16&e,h=32&e;if(!a&&!De(t))throw new Pn;c&&!i.length&&(e&=-17,c=i=!1),h&&!n.length&&(e&=-33,h=n=!1);var l=t&&t.__bindData__;if(l&&l!==!0)return l=p(l),l[2]&&(l[2]=p(l[2])),l[3]&&(l[3]=p(l[3])),!r||1&l[1]||(l[4]=o),!r&&1&l[1]&&(e|=8),!u||4&l[1]||(l[5]=s),c&&Un.apply(l[2]||(l[2]=[]),i),h&&Wn.apply(l[3]||(l[3]=[]),n),l[1]|=e,pe.apply(null,l);var f=1==e||17===e?w:ne;return f([t,e,i,n,o,s])}function fe(){J.shadowedProps=D,J.array=J.bottom=J.loop=J.top="",J.init="iterable",J.useHas=!0;for(var t,e=0;t=arguments[e];e++)for(var i in t)J[i]=t[i];var n=J.args;J.firstArg=/^[^,]+/.exec(n)[0];var o=Tn("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+n+") {\n"+co(J)+"\n}");return o(ie,q,An,Gn,y,_e,lo,qe,J.keys,Ln,Z,ao,X,zn,Fn)}function de(t){return yo[t]}function ge(){var e=(e=g.indexOf)===Oi?t:e;return e}function me(t){return"function"==typeof t&&Hn.test(t)}function ve(t){var e,i;return!t||Fn.call(t)!=U||(e=t.constructor,De(e)&&!(e instanceof e))||!uo.argsClass&&_e(t)||!uo.nodeClass&&c(t)?!1:uo.ownLast?(To(t,function(t,e,n){return i=Gn.call(n,e),!1}),i!==!1):(To(t,function(t,e){i=e}),"undefined"==typeof i||Gn.call(t,i))}function ye(t){return _o[t]}function _e(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Fn.call(t)==H||!1}function be(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i=e,e=!1),K(t,e,"function"==typeof i&&ie(i,n,1))}function we(t,e,i){return K(t,!0,"function"==typeof e&&ie(e,i,1))}function Se(t,e){var i=ee(t);return e?xo(i,e):i}function xe(t,e,i){var n;return e=g.createCallback(e,i,3),Eo(t,function(t,i,o){return e(t,i,o)?(n=i,!1):void 0}),n}function Oe(t,e,i){var n;return e=g.createCallback(e,i,3),Ee(t,function(t,i,o){return e(t,i,o)?(n=i,!1):void 0}),n}function Te(t,e,i){var n=[];To(t,function(t,e){n.push(e,t)});var o=n.length;for(e=ie(e,i,3);o--&&e(n[o--],n[o],t)!==!1;);return t}function Ee(t,e,i){var n=fo(t),o=n.length;for(e=ie(e,i,3);o--;){var s=n[o];if(e(t[s],s,t)===!1)break}return t}function Ie(t){var e=[];return To(t,function(t,i){De(t)&&e.push(i)}),e.sort()}function Ce(t,e){return t?Gn.call(t,e):!1}function ke(t){for(var e=-1,i=fo(t),n=i.length,o={};++e<n;){var s=i[e];o[t[s]]=s}return o}function Me(t){return t===!0||t===!1||t&&"object"==typeof t&&Fn.call(t)==j||!1}function Pe(t){return t&&"object"==typeof t&&Fn.call(t)==R||!1}function Ne(t){return t&&1===t.nodeType||!1}function Ae(t){var e=!0;if(!t)return e;var i=Fn.call(t),n=t.length;return i==V||i==X||(uo.argsClass?i==H:_e(t))||i==U&&"number"==typeof n&&De(t.splice)?!n:(Eo(t,function(){return e=!1}),e)}function Le(t,e,i,n){return ae(t,e,"function"==typeof i&&ie(i,n,2))}function ze(t){return Kn(t)&&!to(parseFloat(t))}function De(t){return"function"==typeof t}function Fe(t){return!(!t||!Z[typeof t])}function He(t){return je(t)&&t!=+t}function Ve(t){return null===t}function je(t){return"number"==typeof t||t&&"object"==typeof t&&Fn.call(t)==G||!1}function Re(t){return t&&Z[typeof t]&&Fn.call(t)==$||!1}function qe(t){return"string"==typeof t||t&&"object"==typeof t&&Fn.call(t)==X||!1}function Be(t){return"undefined"==typeof t}function Ge(t,e,i){var n={};return e=g.createCallback(e,i,3),Eo(t,function(t,i,o){n[i]=e(t,i,o)}),n}function Ue(t){var e=arguments,i=2;if(!Fe(t))return t;if("number"!=typeof e[2]&&(i=e.length),i>3&&"function"==typeof e[i-2])var n=ie(e[--i-1],e[i--],2);else i>2&&"function"==typeof e[i-1]&&(n=e[--i]);for(var o=p(arguments,1,i),s=-1,r=a(),u=a();++s<i;)ue(t,o[s],n,r,u);return h(r),h(u),t}function $e(t,e,i){var n={};if("function"!=typeof e){var o=[];To(t,function(t,e){o.push(e)}),o=oe(o,re(arguments,!0,!1,1));for(var s=-1,r=o.length;++s<r;){var a=o[s];n[a]=t[a]}}else e=g.createCallback(e,i,3),To(t,function(t,i,o){e(t,i,o)||(n[i]=t)});return n}function Xe(t){for(var e=-1,i=fo(t),n=i.length,o=wn(n);++e<n;){var s=i[e];o[e]=[s,t[s]]}return o}function Ye(t,e,i){var n={};if("function"!=typeof e)for(var o=-1,s=re(arguments,!0,!1,1),r=Fe(t)?s.length:0;++o<r;){var a=s[o];a in t&&(n[a]=t[a])}else e=g.createCallback(e,i,3),To(t,function(t,i,o){e(t,i,o)&&(n[i]=t)});return n}function We(t,e,i,n){var o=lo(t);if(null==i)if(o)i=[];else{var s=t&&t.constructor,r=s&&s.prototype;i=ee(r)}return e&&(e=g.createCallback(e,n,4),(o?So:Eo)(t,function(t,n,o){return e(i,t,n,o)})),i}function Qe(t){for(var e=-1,i=fo(t),n=i.length,o=wn(n);++e<n;)o[e]=t[i[e]];return o}function Je(t){var e=arguments,i=-1,n=re(e,!0,!1,1),o=e[2]&&e[2][e[1]]===t?1:n.length,s=wn(o);for(uo.unindexedChars&&qe(t)&&(t=t.split(""));++i<o;)s[i]=t[n[i]];return s}function Ze(t,e,i){var n=-1,o=ge(),s=t?t.length:0,r=!1;return i=(0>i?io(0,s+i):i)||0,lo(t)?r=o(t,e,i)>-1:"number"==typeof s?r=(qe(t)?t.indexOf(e,i):o(t,e,i))>-1:So(t,function(t){return++n>=i?!(r=t===e):void 0}),r}function Ke(t,e,i){var n=!0;if(e=g.createCallback(e,i,3),lo(t))for(var o=-1,s=t.length;++o<s&&(n=!!e(t[o],o,t)););else So(t,function(t,i,o){return n=!!e(t,i,o)});return n}function ti(t,e,i){var n=[];if(e=g.createCallback(e,i,3),lo(t))for(var o=-1,s=t.length;++o<s;){var r=t[o];e(r,o,t)&&n.push(r)}else So(t,function(t,i,o){e(t,i,o)&&n.push(t)});return n}function ei(t,e,i){if(e=g.createCallback(e,i,3),!lo(t)){var n;return So(t,function(t,i,o){return e(t,i,o)?(n=t,!1):void 0}),n}for(var o=-1,s=t.length;++o<s;){var r=t[o];if(e(r,o,t))return r}}function ii(t,e,i){var n;return e=g.createCallback(e,i,3),oi(t,function(t,i,o){return e(t,i,o)?(n=t,!1):void 0}),n}function ni(t,e,i){if(e&&"undefined"==typeof i&&lo(t))for(var n=-1,o=t.length;++n<o&&e(t[n],n,t)!==!1;);else So(t,e,i);return t}function oi(t,e,i){var n=t,o=t?t.length:0;if(e=e&&"undefined"==typeof i?e:ie(e,i,3),lo(t))for(;o--&&e(t[o],o,t)!==!1;);else{if("number"!=typeof o){var s=fo(t);o=s.length}else uo.unindexedChars&&qe(t)&&(n=t.split(""));So(t,function(t,i,r){return i=s?s[--o]:--o,e(n[i],i,r)})}return t}function si(t,e){var i=p(arguments,2),n=-1,o="function"==typeof e,s=t?t.length:0,r=wn("number"==typeof s?s:0);return ni(t,function(t){r[++n]=(o?e:t[e]).apply(t,i)}),r}function ri(t,e,i){var n=-1,o=t?t.length:0,s=wn("number"==typeof o?o:0);if(e=g.createCallback(e,i,3),lo(t))for(;++n<o;)s[n]=e(t[n],n,t);else So(t,function(t,i,o){s[++n]=e(t,i,o)});return s}function ai(t,e,i){var o=-1/0,s=o;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&lo(t))for(var r=-1,a=t.length;++r<a;){var u=t[r];u>s&&(s=u)}else e=null==e&&qe(t)?n:g.createCallback(e,i,3),So(t,function(t,i,n){var r=e(t,i,n);r>o&&(o=r,s=t)});return s}function ui(t,e,i){var o=1/0,s=o;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&lo(t))for(var r=-1,a=t.length;++r<a;){var u=t[r];s>u&&(s=u)}else e=null==e&&qe(t)?n:g.createCallback(e,i,3),So(t,function(t,i,n){var r=e(t,i,n);o>r&&(o=r,s=t)});return s}function ci(t,e,i,n){var o=arguments.length<3;if(e=g.createCallback(e,n,4),lo(t)){var s=-1,r=t.length;for(o&&(i=t[++s]);++s<r;)i=e(i,t[s],s,t)}else So(t,function(t,n,s){i=o?(o=!1,t):e(i,t,n,s)});return i}function hi(t,e,i,n){var o=arguments.length<3;return e=g.createCallback(e,n,4),oi(t,function(t,n,s){i=o?(o=!1,t):e(i,t,n,s)}),i}function li(t,e,i){return e=g.createCallback(e,i,3),ti(t,function(t,i,n){return!e(t,i,n)})}function pi(t,e,i){if(t&&"number"!=typeof t.length?t=Qe(t):uo.unindexedChars&&qe(t)&&(t=t.split("")),null==e||i)return t?t[ce(0,t.length-1)]:d;var n=fi(t);return n.length=no(io(0,e),n.length),n}function fi(t){var e=-1,i=t?t.length:0,n=wn("number"==typeof i?i:0);return ni(t,function(t){var i=ce(0,++e);n[e]=n[i],n[i]=t}),n}function di(t){var e=t?t.length:0;return"number"==typeof e?e:fo(t).length}function gi(t,e,i){var n;if(e=g.createCallback(e,i,3),lo(t))for(var o=-1,s=t.length;++o<s&&!(n=e(t[o],o,t)););else So(t,function(t,i,o){return!(n=e(t,i,o))});return!!n}function mi(t,e,i){var n=-1,s=lo(e),r=t?t.length:0,c=wn("number"==typeof r?r:0);for(s||(e=g.createCallback(e,i,3)),ni(t,function(t,i,o){var r=c[++n]=u();s?r.criteria=ri(e,function(e){return t[e]}):(r.criteria=a())[0]=e(t,i,o),r.index=n,r.value=t}),r=c.length,c.sort(o);r--;){var p=c[r];c[r]=p.value,s||h(p.criteria),l(p)}return c}function vi(t){return t&&"number"==typeof t.length?uo.unindexedChars&&qe(t)?t.split(""):p(t):Qe(t)}function yi(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var o=t[e];o&&n.push(o)}return n}function _i(t){return oe(t,re(arguments,!0,!0,1))}function bi(t,e,i){var n=-1,o=t?t.length:0;for(e=g.createCallback(e,i,3);++n<o;)if(e(t[n],n,t))return n;return-1}function wi(t,e,i){var n=t?t.length:0;for(e=g.createCallback(e,i,3);n--;)if(e(t[n],n,t))return n;return-1}function Si(t,e,i){var n=0,o=t?t.length:0;if("number"!=typeof e&&null!=e){var s=-1;for(e=g.createCallback(e,i,3);++s<o&&e(t[s],s,t);)n++}else if(n=e,null==n||i)return t?t[0]:d;return p(t,0,no(io(0,n),o))}function xi(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(t=ri(t,i,n)),re(t,e)}function Oi(e,i,n){if("number"==typeof n){var o=e?e.length:0;n=0>n?io(0,o+n):n||0}else if(n){var s=Ai(e,i);return e[s]===i?s:-1}return t(e,i,n)}function Ti(t,e,i){var n=0,o=t?t.length:0;if("number"!=typeof e&&null!=e){var s=o;for(e=g.createCallback(e,i,3);s--&&e(t[s],s,t);)n++}else n=null==e||i?1:e||n;return p(t,0,no(io(0,o-n),o))}function Ei(){for(var i=[],n=-1,o=arguments.length,r=a(),u=ge(),c=u===t,p=a();++n<o;){var f=arguments[n];(lo(f)||_e(f))&&(i.push(f),r.push(c&&f.length>=b&&s(n?i[n]:p)))}var d=i[0],g=-1,m=d?d.length:0,v=[];t:for(;++g<m;){var y=r[0];if(f=d[g],(y?e(y,f):u(p,f))<0){for(n=o,(y||p).push(f);--n;)if(y=r[n],(y?e(y,f):u(i[n],f))<0)continue t;v.push(f)}}for(;o--;)y=r[o],y&&l(y);return h(r),h(p),v}function Ii(t,e,i){var n=0,o=t?t.length:0;if("number"!=typeof e&&null!=e){var s=o;for(e=g.createCallback(e,i,3);s--&&e(t[s],s,t);)n++}else if(n=e,null==n||i)return t?t[o-1]:d;return p(t,io(0,o-n))}function Ci(t,e,i){var n=t?t.length:0;for("number"==typeof i&&(n=(0>i?io(0,n+i):no(i,n-1))+1);n--;)if(t[n]===e)return n;return-1}function ki(t){for(var e=arguments,i=0,n=e.length,o=t?t.length:0;++i<n;)for(var s=-1,r=e[i];++s<o;)t[s]===r&&(Yn.call(t,s--,1),o--);return t}function Mi(t,e,i){t=+t||0,i="number"==typeof i?i:+i||1,null==e&&(e=t,t=0);for(var n=-1,o=io(0,Vn((e-t)/(i||1))),s=wn(o);++n<o;)s[n]=t,t+=i;return s}function Pi(t,e,i){var n=-1,o=t?t.length:0,s=[];for(e=g.createCallback(e,i,3);++n<o;){var r=t[n];e(r,n,t)&&(s.push(r),Yn.call(t,n--,1),o--)}return s}function Ni(t,e,i){if("number"!=typeof e&&null!=e){var n=0,o=-1,s=t?t.length:0;for(e=g.createCallback(e,i,3);++o<s&&e(t[o],o,t);)n++}else n=null==e||i?1:io(0,e);return p(t,n)}function Ai(t,e,i,n){var o=0,s=t?t.length:o;for(i=i?g.createCallback(i,n,1):sn,e=i(e);s>o;){var r=o+s>>>1;i(t[r])<e?o=r+1:s=r}return o}function Li(){return he(re(arguments,!0,!0))}function zi(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(i=g.createCallback(i,n,3)),he(t,e,i)}function Di(t){return oe(t,p(arguments,1))}function Fi(){for(var t=-1,e=arguments.length;++t<e;){var i=arguments[t];if(lo(i)||_e(i))var n=n?he(oe(n,i).concat(oe(i,n))):i}return n||[]}function Hi(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,i=t?ai(Po(t,"length")):0,n=wn(0>i?0:i);++e<i;)n[e]=Po(t,e);return n}function Vi(t,e){var i=-1,n=t?t.length:0,o={};for(e||!n||lo(t[0])||(e=[]);++i<n;){var s=t[i];e?o[s]=e[i]:s&&(o[s[0]]=s[1])}return o}function ji(t,e){if(!De(e))throw new Pn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Ri(t,e){return arguments.length>2?pe(t,17,p(arguments,2),null,e):pe(t,1,null,null,e)}function qi(t){for(var e=arguments.length>1?re(arguments,!0,!1,1):Ie(t),i=-1,n=e.length;++i<n;){var o=e[i];t[o]=pe(t[o],1,null,null,t)}return t}function Bi(t,e){return arguments.length>2?pe(e,19,p(arguments,2),null,t):pe(e,3,null,null,t)}function Gi(){for(var t=arguments,e=t.length;e--;)if(!De(t[e]))throw new Pn;return function(){for(var e=arguments,i=t.length;i--;)e=[t[i].apply(this,e)];return e[0]}}function Ui(t,e){return e="number"==typeof e?e:+e||t.length,pe(t,4,null,null,null,e)}function $i(t,e,i){var n,o,s,r,a,u,c,h=0,l=!1,p=!0;if(!De(t))throw new Pn;if(e=io(0,e)||0,i===!0){var f=!0;p=!1}else Fe(i)&&(f=i.leading,l="maxWait"in i&&(io(e,i.maxWait)||0),p="trailing"in i?i.trailing:p);var g=function(){var i=e-(Ao()-r);if(0>=i){o&&jn(o);var l=c;o=u=c=d,l&&(h=Ao(),s=t.apply(a,n),u||o||(n=a=null))}else u=Xn(g,i)},m=function(){u&&jn(u),o=u=c=d,(p||l!==e)&&(h=Ao(),s=t.apply(a,n),u||o||(n=a=null))};return function(){if(n=arguments,r=Ao(),a=this,c=p&&(u||!f),l===!1)var i=f&&!u;else{o||f||(h=r);var d=l-(r-h),v=0>=d;v?(o&&(o=jn(o)),h=r,s=t.apply(a,n)):o||(o=Xn(m,d))}return v&&u?u=jn(u):u||e===l||(u=Xn(g,e)),i&&(v=!0,s=t.apply(a,n)),!v||u||o||(n=a=null),s}}function Xi(t){if(!De(t))throw new Pn;var e=p(arguments,1);return Xn(function(){t.apply(d,e)},1)}function Yi(t,e){if(!De(t))throw new Pn;var i=p(arguments,2);return Xn(function(){t.apply(d,i)},e)}function Wi(t,e){if(!De(t))throw new Pn;var i=function(){var n=i.cache,o=e?e.apply(this,arguments):_+arguments[0];return Gn.call(n,o)?n[o]:n[o]=t.apply(this,arguments)};return i.cache={},i}function Qi(t){var e,i;if(!De(t))throw new Pn;return function(){return e?i:(e=!0,i=t.apply(this,arguments),t=null,i)}}function Ji(t){return pe(t,16,p(arguments,1))}function Zi(t){return pe(t,32,null,p(arguments,1))}function Ki(t,e,i){var n=!0,o=!0;if(!De(t))throw new Pn;return i===!1?n=!1:Fe(i)&&(n="leading"in i?i.leading:n,o="trailing"in i?i.trailing:o),W.leading=n,W.maxWait=e,W.trailing=o,$i(t,e,W)}function tn(t,e){return pe(e,16,[t])}function en(t){return function(){return t}}function nn(t,e,i){var n=typeof t;if(null==t||"function"==n)return ie(t,e,i);if("object"!=n)return cn(t);var o=fo(t),s=o[0],r=t[s];return 1!=o.length||r!==r||Fe(r)?function(e){for(var i=o.length,n=!1;i--&&(n=ae(e[o[i]],t[o[i]],null,!0)););return n}:function(t){var e=t[s];return r===e&&(0!==r||1/r==1/e)}}function on(t){return null==t?"":Mn(t).replace(wo,de)}function sn(t){return t}function rn(t,e,i){var n=!0,o=e&&Ie(e);e&&(i||o.length)||(null==i&&(i=e),s=m,e=t,t=g,o=Ie(e)),i===!1?n=!1:Fe(i)&&"chain"in i&&(n=i.chain);var s=t,r=De(s);ni(o,function(i){var o=t[i]=e[i];r&&(s.prototype[i]=function(){var e=this.__chain__,i=this.__wrapped__,r=[i];Un.apply(r,arguments);var a=o.apply(t,r);if(n||e){if(i===a&&Fe(a))return this;a=new s(a),a.__chain__=e}return a})})}function an(){return i._=Dn,this}function un(){}function cn(t){return function(e){return e[t]}}function hn(t,e,i){var n=null==t,o=null==e;if(null==i&&("boolean"==typeof t&&o?(i=t,t=1):o||"boolean"!=typeof e||(i=e,o=!0)),n&&o&&(e=1),t=+t||0,o?(e=t,t=0):e=+e||0,i||t%1||e%1){var s=so();return no(t+s*(e-t+parseFloat("1e-"+((s+"").length-1))),e)}return ce(t,e)}function ln(t,e){if(t){var i=t[e];return De(i)?t[e]():i}}function pn(t,e,i){var n=g.templateSettings;t=Mn(t||""),i=Oo({},i,n);var o,s=Oo({},i.imports,n.imports),a=fo(s),u=Qe(s),c=0,h=i.interpolate||N,l="__p += '",p=kn((i.escape||N).source+"|"+h.source+"|"+(h===M?E:N).source+"|"+(i.evaluate||N).source+"|$","g");t.replace(p,function(e,i,n,s,a,u){return n||(n=s),l+=t.slice(c,u).replace(L,r),i&&(l+="' +\n__e("+i+") +\n'"),a&&(o=!0,l+="';\n"+a+";\n__p += '"),n&&(l+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=u+e.length,e}),l+="';\n";var f=i.variable,m=f;m||(f="obj",l="with ("+f+") {\n"+l+"\n}\n"),l=(o?l.replace(x,""):l).replace(O,"$1").replace(T,"$1;"),l="function("+f+") {\n"+(m?"":f+" || ("+f+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var v="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+F++ +"]")+"\n*/";try{var y=Tn(a,"return "+l+v).apply(d,u)}catch(_){throw _.source=l,_}return e?y(e):(y.source=l,y)}function fn(t,e,i){t=(t=+t)>-1?t:0;var n=-1,o=wn(t);for(e=ie(e,i,1);++n<t;)o[n]=e(n);return o}function dn(t){return null==t?"":Mn(t).replace(bo,ye)}function gn(t){var e=++v;return Mn(null==t?"":t)+e}function mn(t){return t=new m(t),t.__chain__=!0,t}function vn(t,e){return e(t),t}function yn(){return this.__chain__=!0,this}function _n(){return Mn(this.__wrapped__)}function bn(){return this.__wrapped__}i=i?se.defaults(te.Object(),i,se.pick(te,z)):te;var wn=i.Array,Sn=i.Boolean,xn=i.Date,On=i.Error,Tn=i.Function,En=i.Math,In=i.Number,Cn=i.Object,kn=i.RegExp,Mn=i.String,Pn=i.TypeError,Nn=[],An=On.prototype,Ln=Cn.prototype,zn=Mn.prototype,Dn=i._,Fn=Ln.toString,Hn=kn("^"+Mn(Fn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Vn=En.ceil,jn=i.clearTimeout,Rn=En.floor,qn=Tn.prototype.toString,Bn=me(Bn=Cn.getPrototypeOf)&&Bn,Gn=Ln.hasOwnProperty,Un=Nn.push,$n=Ln.propertyIsEnumerable,Xn=i.setTimeout,Yn=Nn.splice,Wn=Nn.unshift,Qn=function(){try{var t={},e=me(e=Cn.defineProperty)&&e,i=e(t,t,t)&&e}catch(n){}return i}(),Jn=me(Jn=Cn.create)&&Jn,Zn=me(Zn=wn.isArray)&&Zn,Kn=i.isFinite,to=i.isNaN,eo=me(eo=Cn.keys)&&eo,io=En.max,no=En.min,oo=i.parseInt,so=En.random,ro={};ro[V]=wn,ro[j]=Sn,ro[R]=xn,ro[B]=Tn,ro[U]=Cn,ro[G]=In,ro[$]=kn,ro[X]=Mn;var ao={};ao[V]=ao[R]=ao[G]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},ao[j]=ao[X]={constructor:!0,toString:!0,valueOf:!0},ao[q]=ao[B]=ao[$]={constructor:!0,toString:!0},ao[U]={constructor:!0},function(){for(var t=D.length;t--;){var e=D[t];for(var i in ao)Gn.call(ao,i)&&!Gn.call(ao[i],e)&&(ao[i][e]=!1)}}(),m.prototype=g.prototype;var uo=g.support={};!function(){var t=function(){this.x=1},e={0:1,length:1},n=[];t.prototype={valueOf:1,y:1};for(var o in new t)n.push(o);for(o in arguments);uo.argsClass=Fn.call(arguments)==H,uo.argsObject=arguments.constructor==Cn&&!(arguments instanceof wn),uo.enumErrorProps=$n.call(An,"message")||$n.call(An,"name"),uo.enumPrototypes=$n.call(t,"prototype"),uo.funcDecomp=!me(i.WinRTError)&&A.test(f),uo.funcNames="string"==typeof Tn.name,uo.nonEnumArgs=0!=o,uo.nonEnumShadows=!/valueOf/.test(n),uo.ownLast="x"!=n[0],uo.spliceObjects=(Nn.splice.call(e,0,1),!e[0]),uo.unindexedChars="x"[0]+Cn("x")[0]!="xx";try{uo.nodeClass=!(Fn.call(document)==U&&!({toString:0}+""))}catch(s){uo.nodeClass=!0}}(1),g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:M,variable:"",imports:{_:g}};var co=function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";";t.array?(e+="\nvar length = iterable.length; index = -1;\nif ("+t.array+") {  ",uo.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+";\n  }\n}\nelse {  "):uo.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+";\n    }\n  } else {  "),uo.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),uo.enumErrorProps&&(e+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var i=[];if(uo.enumPrototypes&&i.push('!(skipProto && index == "prototype")'),uo.enumErrorProps&&i.push('!(skipErrorProps && (index == "message" || index == "name"))'),t.useHas&&t.keys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",i.length&&(e+="    if ("+i.join(" && ")+") {\n  "),e+=t.loop+";    ",i.length&&(e+="\n    }"),e+="\n  }  ";else if(e+="\n  for (index in iterable) {\n",t.useHas&&i.push("hasOwnProperty.call(iterable, index)"),i.length&&(e+="    if ("+i.join(" && ")+") {\n  "),e+=t.loop+";    ",i.length&&(e+="\n    }"),e+="\n  }    ",uo.nonEnumShadows){for(e+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)e+="\n    index = '"+t.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",t.useHas||(e+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),e+=") {\n      "+t.loop+";\n    }      ";e+="\n  }    "}return(t.array||uo.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"};Jn||(ee=function(){function t(){}return function(e){if(Fe(e)){t.prototype=e;var n=new t;t.prototype=null}return n||i.Object()}}());var ho=Qn?function(t,e){Q.value=e,Qn(t,"__bindData__",Q)}:un;uo.argsClass||(_e=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Gn.call(t,"callee")&&!$n.call(t,"callee")||!1});var lo=Zn||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Fn.call(t)==V||!1},po=fe({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),fo=eo?function(t){return Fe(t)?uo.enumPrototypes&&"function"==typeof t||uo.nonEnumArgs&&t.length&&_e(t)?po(t):eo(t):[]}:po,go={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:fo,loop:"if (callback(iterable[index], index, collection) === false) return result"},mo={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:fo,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},vo={top:"if (!objectTypes[typeof iterable]) return result;\n"+go.top,array:!1},yo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_o=ke(yo),bo=kn("("+fo(_o).join("|")+")","g"),wo=kn("["+fo(yo).join("")+"]","g"),So=fe(go),xo=fe(mo,{top:mo.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Oo=fe(mo),To=fe(go,vo,{useHas:!1}),Eo=fe(go,vo);De(/x/)&&(De=function(t){return"function"==typeof t&&Fn.call(t)==B});var Io=Bn?function(t){if(!t||Fn.call(t)!=U||!uo.argsClass&&_e(t))return!1;var e=t.valueOf,i=me(e)&&(i=Bn(e))&&Bn(i);return i?t==i||Bn(t)==i:ve(t)}:ve,Co=le(function(t,e,i){Gn.call(t,i)?t[i]++:t[i]=1}),ko=le(function(t,e,i){(Gn.call(t,i)?t[i]:t[i]=[]).push(e)}),Mo=le(function(t,e,i){t[i]=e}),Po=ri,No=ti,Ao=me(Ao=xn.now)&&Ao||function(){return(new xn).getTime()},Lo=8==oo(S+"08")?oo:function(t,e){return oo(qe(t)?t.replace(P,""):t,e||0)};return g.after=ji,g.assign=xo,g.at=Je,g.bind=Ri,g.bindAll=qi,g.bindKey=Bi,g.chain=mn,g.compact=yi,g.compose=Gi,g.constant=en,g.countBy=Co,g.create=Se,g.createCallback=nn,g.curry=Ui,g.debounce=$i,g.defaults=Oo,g.defer=Xi,g.delay=Yi,g.difference=_i,g.filter=ti,g.flatten=xi,g.forEach=ni,g.forEachRight=oi,g.forIn=To,g.forInRight=Te,g.forOwn=Eo,g.forOwnRight=Ee,g.functions=Ie,g.groupBy=ko,g.indexBy=Mo,g.initial=Ti,g.intersection=Ei,g.invert=ke,g.invoke=si,g.keys=fo,g.map=ri,g.mapValues=Ge,g.max=ai,g.memoize=Wi,g.merge=Ue,g.min=ui,g.omit=$e,g.once=Qi,g.pairs=Xe,g.partial=Ji,g.partialRight=Zi,g.pick=Ye,g.pluck=Po,g.property=cn,g.pull=ki,g.range=Mi,g.reject=li,g.remove=Pi,g.rest=Ni,g.shuffle=fi,g.sortBy=mi,g.tap=vn,g.throttle=Ki,g.times=fn,g.toArray=vi,g.transform=We,g.union=Li,g.uniq=zi,g.values=Qe,g.where=No,g.without=Di,g.wrap=tn,g.xor=Fi,g.zip=Hi,g.zipObject=Vi,g.collect=ri,g.drop=Ni,g.each=ni,g.eachRight=oi,g.extend=xo,g.methods=Ie,g.object=Vi,g.select=ti,g.tail=Ni,g.unique=zi,g.unzip=Hi,rn(g),g.clone=be,g.cloneDeep=we,g.contains=Ze,g.escape=on,g.every=Ke,g.find=ei,g.findIndex=bi,g.findKey=xe,g.findLast=ii,g.findLastIndex=wi,g.findLastKey=Oe,g.has=Ce,g.identity=sn,g.indexOf=Oi,g.isArguments=_e,g.isArray=lo,g.isBoolean=Me,g.isDate=Pe,g.isElement=Ne,g.isEmpty=Ae,g.isEqual=Le,g.isFinite=ze,g.isFunction=De,g.isNaN=He,g.isNull=Ve,g.isNumber=je,g.isObject=Fe,g.isPlainObject=Io,g.isRegExp=Re,g.isString=qe,g.isUndefined=Be,g.lastIndexOf=Ci,g.mixin=rn,g.noConflict=an,g.noop=un,g.now=Ao,g.parseInt=Lo,g.random=hn,g.reduce=ci,g.reduceRight=hi,g.result=ln,g.runInContext=f,g.size=di,g.some=gi,g.sortedIndex=Ai,g.template=pn,g.unescape=dn,g.uniqueId=gn,g.all=Ke,g.any=gi,g.detect=ei,g.findWhere=ei,g.foldl=ci,g.foldr=hi,g.include=Ze,g.inject=ci,rn(function(){var t={};return Eo(g,function(e,i){g.prototype[i]||(t[i]=e)}),t}(),!1),g.first=Si,g.last=Ii,g.sample=pi,g.take=Si,g.head=Si,Eo(g,function(t,e){var i="sample"!==e;g.prototype[e]||(g.prototype[e]=function(e,n){var o=this.__chain__,s=t(this.__wrapped__,e,n);return o||null!=e&&(!n||i&&"function"==typeof e)?new m(s,o):s})}),g.VERSION="2.4.1",g.prototype.chain=yn,g.prototype.toString=_n,g.prototype.value=bn,g.prototype.valueOf=bn,So(["join","pop","shift"],function(t){var e=Nn[t];g.prototype[t]=function(){var t=this.__chain__,i=e.apply(this.__wrapped__,arguments);return t?new m(i,t):i}}),So(["push","reverse","sort","unshift"],function(t){var e=Nn[t];g.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),So(["concat","slice","splice"],function(t){var e=Nn[t];g.prototype[t]=function(){return new m(e.apply(this.__wrapped__,arguments),this.__chain__)}}),uo.spliceObjects||So(["pop","shift","splice"],function(t){var e=Nn[t],i="splice"==t;g.prototype[t]=function(){var t=this.__chain__,n=this.__wrapped__,o=e.apply(n,arguments);return 0===n.length&&delete n[0],t||i?new m(o,t):o}}),g}var d,g=[],m=[],v=0,y={},_=+new Date+"",b=75,w=40,S=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",x=/\b__p \+= '';/g,O=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,E=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,I=/\w*$/,C=/^\s*function[ \n\r\t]+\w/,M=/<%=([\s\S]+?)%>/g,P=RegExp("^["+S+"]*0+(?=.$)"),N=/($^)/,A=/\bthis\b/,L=/['\n\r\t\u2028\u2029\\]/g,z=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],D=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],F=0,H="[object Arguments]",V="[object Array]",j="[object Boolean]",R="[object Date]",q="[object Error]",B="[object Function]",G="[object Number]",U="[object Object]",$="[object RegExp]",X="[object String]",Y={};Y[B]=!1,Y[H]=Y[V]=Y[j]=Y[R]=Y[G]=Y[U]=Y[$]=Y[X]=!0;var W={leading:!1,maxWait:0,trailing:!1},Q={configurable:!1,enumerable:!1,value:null,writable:!1},J={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},Z={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},K={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},te=Z[typeof window]&&window||this,ee=Z[typeof exports]&&exports&&!exports.nodeType&&exports,ie=Z[typeof module]&&module&&!module.nodeType&&module,ne=ie&&ie.exports===ee&&ee,oe=Z[typeof global]&&global;!oe||oe.global!==oe&&oe.window!==oe||(te=oe);var se=f();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(te._=se,define("lodash",[],function(){return se})):ee&&ie?ne?(ie.exports=se)._=se:ee._=se:te._=se}.call(this),define("models/Model",["require","exports","module","famous/core/EventHandler","famous/core/OptionsManager","localforage"],function(t,e,i){function n(t){this._db=r,this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var o=t("famous/core/EventHandler"),s=t("famous/core/OptionsManager"),r=t("localforage");n.DEFAULT_OPTIONS={},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.getOption=function(t){return this.options[t]},i.exports=n}),define("StageConfig",["require","exports","module"],function(t,e,i){function n(t,e,i,n){return t=t||a,i=i||15,e=e&&"string"==typeof e?u[e]:Array.isArray(e)?e:u.standard,n=n||Math.floor(e[0]*e[1]/2),{gametype:t,grid:e,goal:i,startIndex:n,obstacles:[]}}function o(t,e){return t===r?"Survive for "+e+" turns to win":t===a?"Destroy "+e+" blocks to win":"This is just a placeholder. We are working hard to bring this to you."}function s(t){this.index=t-1||0}var r=1,a=2,u={small:[4,6],standard:[5,8],large:[6,10],xlarge:[10,10],wide:[8,4],fat:[8,3],tall:[4,8],skinny:[3,8]},c=[{icon:{url:"./images/mayan-1.png",size:[50,60]},grid:[4,5],levels:[n(null,"large",2),n(null,"standard",4),n(null,"standard",6),n(null,"standard",8),n(r,"standard",8),n(null,"tall",6),n(null,"tall",6),n(r,"skinny",5),n(r,null,5),n(null,null,30),n(null,"wide",10),n(null,"large",15),n(r,null,15),n(r,"skinny",10),n(null,"skinny",10),n(null,"wide",15),n(r,null,10),n(null,null,10),n(r,"tall",15),n(null,"skinny",10)]},{icon:{url:"./images/mayan-2.png",size:[100,65]},grid:[4,5],levels:[n(r,null,15),n(null,"xlarge",10),n(r,"small",10),n(null,"tall",10),n(null,"skinny",10),n(null,"xlarge",6),n(r,"small",15),n(null,"tall",8)]},{icon:{url:"./images/mayan-3.png",size:[150,65]},grid:[4,5]},{icon:{url:"./images/mayan-4.png",size:[200,65]},grid:[4,5]},{icon:{url:"./images/mayan-5.png",size:[150,65]},grid:[4,5]},{icon:{url:"./images/mayan-6.png",size:[150,65]},grid:[4,5]}];
s.GAMETYPE_SURVIVAL=r,s.GAMETYPE_DESTROY=a,s.getStagesCount=function(){return c.length},s.prototype.getLevelCount=function(){return c[this.index].levels.length},s.prototype.getLevelConfig=function(t){return c[this.index].levels[t-1]},s.prototype.getIcon=function(){return c[this.index].icon},s.prototype.getGameDesc=function(t){var e=c[this.index].levels,i=e&&e[t-1]||{},n="",s="";return i&&(n=i.gametype,s=i.goal),o(n,s)},i.exports=s}),define("models/UserModel",["require","exports","module","famous/core/Engine","lodash","localforage","models/Model","StageConfig"],function(t,e,i){function n(){a.ready().then(function(){a.getItem("user").then(function(t){t?(console.info("Loading user",t),this.setOptions(t)):(console.info("Creating new user"),this.options.created||(this.options.created=Date.now()),this.save()),s.emit("user:loaded")}.bind(this))}.bind(this))}function o(){return o._instance?o._instance:(u.apply(this,arguments),r.extend(this.options,this.constructor.DEFAULT_OPTIONS),n.call(this),void(o._instance=this))}var s=t("famous/core/Engine"),r=t("lodash"),a=t("localforage"),u=t("models/Model"),c=t("StageConfig");o.prototype=Object.create(u.prototype),o.prototype.constructor=o,o._instance=null,o.DEFAULT_OPTIONS={created:"",latestStage:1,latestLevel:1,lives:5,lastDeath:"",lastRecharge:""},o.prototype.save=function(){a.ready().then(function(){a.setItem("user",this.options,function(){console.info("Successfully saved user")})}.bind(this))},o.prototype.delete=function(){a.ready().then(function(){a.removeItem("user",function(){console.info("Successfully deleted user")})})},o.prototype.getOptions=function(){return this._optionsManager.value()},o.prototype.setOptions=function(t){this._optionsManager.patch(t)},o.prototype.hasUnlockedLevel=function(t,e){var i=!1;return t<this.options.latestStage?i=!0:t===this.options.latestStage&&e<=this.options.latestLevel&&(i=!0),i},o.prototype.getLatestLevel=function(){return{stage:this.options.latestStage,level:this.options.latestLevel}},o.prototype.getLatestStage=function(){return this.getLatestLevel()},o.prototype.setLatestLevel=function(t,e){if(t&&e){var i={latestStage:t,latestLevel:e};this.setOptions(i),this.save()}},o.prototype.unlockNextLevel=function(){var t=this.options.latestLevel,e=this.options.latestStage,i=new c(this.options.latestStage);this.options.latestLevel===i.getLevelCount()?(t=1,e+=1):t+=1,this.setLatestLevel(e,t)},i.exports=o}),define("models/GameModel",["require","exports","module","famous/core/Engine","models/Model","localforage","StageConfig"],function(t){function e(){r.ready().then(function(){r.getItem("savedGame").then(function(t){console.info("Loading Saved Game"),this.setOptions(t),o.emit("game:loaded",t)}.bind(this))}.bind(this))}function i(){this._eventInput.on("game:turn++",function(){this.options.turns++}.bind(this)),this._eventInput.on("game:pieceDestroyed++",function(){this.options.destroyed++}.bind(this))}function n(){return n._instance?n._instance:(s.apply(this,arguments),i.call(this),e.call(this),void(n._instance=this))}var o=t("famous/core/Engine"),s=t("models/Model"),r=t("localforage"),a=t("StageConfig");return n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n._instance=null,n.DEFAULT_OPTIONS={level:1,stage:1,turns:0,destroyed:0,state:null},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.getSaved=function(){return this.getOptions()},n.prototype.save=function(t){this.setOptions(t),r.ready().then(function(){r.setItem("savedGame",t,function(){console.info("Saved current game data")})}.bind(this))},n.prototype.delete=function(){r.ready().then(function(){r.removeItem("savedGame",function(){console.info("Deleted saved game data")})})},n.prototype.getDescription=function(){var t=new a(this.options.currentStage);return t.getGameDesc(this.options.currentLevel)},n.prototype.reset=function(){this.setOptions({turns:n.DEFAULT_OPTIONS.turns,destroyed:n.DEFAULT_OPTIONS.destroyed}),this.save()},n}),define("controllers/Controller",["require","exports","module","famous/core/EventHandler","famous/core/OptionsManager"],function(t,e,i){function n(t){this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var o=t("famous/core/EventHandler"),s=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.getOption=function(t){return this.options[t]},i.exports=n}),define("controllers/GameController",["require","exports","module","controllers/Controller","StageConfig","models/UserModel","models/GameModel"],function(t,e,i){function n(){this._user=new u,this._model=new c,this.setOptions(this._model.getSaved());var t=new a(this.options.stage);this._stage=t,this._config=t.getLevelConfig(this.options.level)}function o(){return o._instance?o._instance:(r.apply(this,arguments),n.call(this),void(o._instance=this))}function s(){var t=!1,e=this._config.gametype,i=this._config.goal;return e===a.GAMETYPE_SURVIVAL?this.options.turns>=i&&(t=!0):e===a.GAMETYPE_DESTROY&&this.options.destroyed>=i&&(t=!0),t}var r=t("controllers/Controller"),a=t("StageConfig"),u=t("models/UserModel"),c=t("models/GameModel");o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o._instance=null,o.DEFAULT_OPTIONS={stage:1,level:1,turns:0,destroyed:0,done:!1,state:null},o.prototype.newGame=function(t){t.destroyed=0,t.turns=0,t.done=!1,t.state=null,this.setOptions(t),this._model.save(t),n.call(this)},o.prototype.resetGame=function(){var t=this.getCurrentLevel();this.newGame(t),this._eventOutput.emit("game:reset")},o.prototype.gameOver=function(){this.lost()},o.prototype.isSameGame=function(t){return this.options.stage===t.stage&&this.options.level===t.level},o.prototype.getLevelConfig=function(){return this._config},o.prototype.getCurrentLevel=function(){return{stage:this.options.stage,level:this.options.level}},o.prototype.unlockNextLevel=function(){var t=this._user.getLatestLevel();t.stage===this.options.stage&&t.level===this.options.level&&(this._user.unlockNextLevel(),this._eventOutput.emit("game:unlockNextLevel"))},o.prototype.getLatestLevel=function(){return this._user.getLatestLevel()},o.prototype.getDescription=function(){return this._stage.getGameDesc(this.options.level)},o.prototype.getCols=function(){return this._config.grid[0]},o.prototype.getStartIndex=function(){return this._config.startIndex},o.prototype.getRows=function(){return this._config.grid[1]},o.prototype.addTurn=function(){this.options.turns++,s.call(this)&&this.won(),this._eventOutput.emit("game:turn++")},o.prototype.addDestroyed=function(){this.options.destroyed++,this._eventOutput.emit("game:destroyed++")},o.prototype.doWinCheck=function(){s.call(this)&&this.won()},o.prototype.won=function(){this.options.done||(this._eventOutput.emit("game:won"),this.options.done=!0)},o.prototype.lost=function(){this.options.done||(this._eventOutput.emit("game:lost"),this.options.done=!0)},o.prototype.quit=function(){this._eventOutput.emit("game:quit")},o.prototype.resume=function(){this._eventOutput.emit("game:resume")},o.prototype.save=function(){this._eventOutput.emit("game:saved")},i.exports=o}),define("famous/core/Surface",["require","exports","module","./Entity","./EventHandler","./Transform"],function(t,e,i){function n(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new f,this.eventHandler.bindThis(this),this.id=p.register(this),t&&this.setOptions(t),this._currTarget=null}function o(t){for(var e in this.eventHandler.listeners)t.addEventListener(e,this.eventForwarder)}function s(t){for(var e in this.eventHandler.listeners)t.removeEventListener(e,this.eventForwarder)}function r(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function a(t){for(var e in this.properties)t.style[e]=this.properties[e]}function u(t){for(var e in this.properties)t.style[e]=""}function c(t){t[12]=Math.round(t[12]*g)/g,t[13]=Math.round(t[13]*g)/g;for(var e="matrix3d(",i=0;15>i;i++)e+=t[i]<1e-6&&t[i]>-1e-6?"0,":t[i]+",";return e+=t[15]+")"}function h(t){return 100*t[0]+"% "+100*t[1]+"%"}function l(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var p=t("./Entity"),f=t("./EventHandler"),d=t("./Transform"),g=window.devicePixelRatio||1,m=void 0!==document.createElement("div").style.webkitTransform;n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.on=function(t,e){this._currTarget&&this._currTarget.addEventListener(t,this.eventForwarder),this.eventHandler.on(t,e)},n.prototype.removeListener=function(t,e){this.eventHandler.removeListener(t,e)},n.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this.eventHandler.emit(t,e);return i&&e&&e.stopPropagation&&e.stopPropagation(),i},n.prototype.pipe=function(t){return this.eventHandler.pipe(t)},n.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},n.prototype.render=function(){return this.id},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];this._stylesDirty=!0},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0)},n.prototype.setClasses=function(t){var e=0,i=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&i.push(this.classList[e]);for(e=0;e<i.length;e++)this.removeClass(i[e]);for(e=0;e<t.length;e++)this.addClass(t[e])},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){this.content!==t&&(this.content=t,this._contentDirty=!0)},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)};var v;v=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,e){t.style.zIndex=1e6*e[14]|0,t.style.transform=c(e)}:m?function(t,e){t.style.webkitTransform=c(e)}:function(t,e){t.style.transform=c(e)};var y=m?function(t,e){t.style.webkitTransformOrigin=h(e)}:function(t,e){t.style.transformOrigin=h(e)},_=m?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0};n.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);e.style.display="",o.call(this,e),this._currTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=null,this._opacity=void 0,this._origin=null,this._size=null},n.prototype.commit=function(t){this._currTarget||this.setup(t.allocator);var e=this._currTarget,i=t.transform,n=t.opacity,o=t.origin,s=t.size;if(this._classesDirty){r.call(this,e);for(var u=this.getClassList(),c=0;c<u.length;c++)e.classList.add(u[c]);this._classesDirty=!1}if(this._stylesDirty&&(a.call(this,e),this._stylesDirty=!1),this._contentDirty&&(this.deploy(e),this.eventHandler.emit("deploy"),this._contentDirty=!1),this.size){var h=s;s=[this.size[0],this.size[1]],void 0===s[0]&&h[0]&&(s[0]=h[0]),void 0===s[1]&&h[1]&&(s[1]=h[1])}if(s[0]===!0&&(s[0]=e.clientWidth),s[1]===!0&&(s[1]=e.clientHeight),l(this._size,s)&&(this._size||(this._size=[0,0]),this._size[0]=s[0],this._size[1]=s[1],this._sizeDirty=!0),!i&&this._matrix)return this._matrix=null,this._opacity=0,void _(e);if(this._opacity!==n&&(this._opacity=n,e.style.opacity=n>=1?"0.999999":n),l(this._origin,o)||d.notEquals(this._matrix,i)||this._sizeDirty){i||(i=d.identity),this._matrix=i;var p=i;o&&(this._origin||(this._origin=[0,0]),this._origin[0]=o[0],this._origin[1]=o[1],p=d.thenMove(i,[-this._size[0]*o[0],-this._size[1]*o[1],0]),y(e,o)),v(e,p)}this._sizeDirty&&(this._size&&(e.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",e.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._sizeDirty=!1)},n.prototype.cleanup=function(t){var e=0,i=this._currTarget;this.eventHandler.emit("recall"),this.recall(i),i.style.display="none",i.style.width="",i.style.height="",this._size=null,u.call(this,i);var n=this.getClassList();for(r.call(this,i),e=0;e<n.length;e++)i.classList.remove(n[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)i.classList.remove(this.elementClass[e]);else i.classList.remove(this.elementClass);s.call(this,i),this._currTarget=null,t.deallocate(i),_(i)},n.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},n.prototype.getSize=function(t){return t?this._size:this.size||this._size},n.prototype.setSize=function(t){this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0},i.exports=n}),define("famous/views/HeaderFooterLayout",["require","exports","module","famous/core/Entity","famous/core/RenderNode","famous/core/Transform","famous/core/OptionsManager"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._entityId=a.register(this),this.header=new u,this.footer=new u,this.content=new u}function o(t,e){var i=t.getSize();return i?i[this.options.direction]:e}function s(t){return this.options.direction===n.DIRECTION_X?c.translate(t,0,0):c.translate(0,t,0)}function r(t,e){return this.options.direction===n.DIRECTION_X?[t,e[1]]:[e[0],t]}var a=t("famous/core/Entity"),u=t("famous/core/RenderNode"),c=t("famous/core/Transform"),h=t("famous/core/OptionsManager");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},n.prototype.render=function(){return this._entityId},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.commit=function(t){var e=t.transform,i=t.origin,n=t.size,a=t.opacity,u=void 0!==this.options.headerSize?this.options.headerSize:o.call(this,this.header,this.options.defaultHeaderSize),h=void 0!==this.options.footerSize?this.options.footerSize:o.call(this,this.footer,this.options.defaultFooterSize),l=n[this.options.direction]-u-h;n&&(e=c.moveThen([-n[0]*i[0],-n[1]*i[1],0],e));var p=[{size:r.call(this,u,n),target:this.header.render()},{transform:s.call(this,u),size:r.call(this,l,n),target:this.content.render()},{transform:s.call(this,u+l),size:r.call(this,h,n),target:this.footer.render()}];return{transform:e,opacity:a,size:n,target:p}},i.exports=n}),define("famous/inputs/MouseSync",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._eventInput=new u,this._eventOutput=new u,u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",o.bind(this)),this._eventInput.on("mousemove",s.bind(this)),this._eventInput.on("mouseup",r.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",a.bind(this)):this._eventInput.on("mouseleave",r.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._position=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._moved=!1}function o(t){var e,i;t.preventDefault();var n=t.clientX,o=t.clientY;this._prevCoord=[n,o],this._prevTime=h(),this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,e=0,i=0):(this._position=[0,0],e=[0,0],i=[0,0]);var s=this._payload;s.delta=e,s.position=this._position,s.velocity=i,s.clientX=n,s.clientY=o,s.offsetX=t.offsetX,s.offsetY=t.offsetY,this._eventOutput.emit("start",s)}function s(t){if(this._prevCoord){var e=this._prevCoord,i=this._prevTime,o=t.clientX,s=t.clientY,r=h(),a=o-e[0],u=s-e[1];this.options.rails&&(Math.abs(a)>Math.abs(u)?u=0:a=0);var l,p,f=Math.max(r-i,c),d=a/f,g=u/f,m=this.options.scale;this.options.direction===n.DIRECTION_X?(p=m*a,l=m*d,this._position+=p):this.options.direction===n.DIRECTION_Y?(p=m*u,l=m*g,this._position+=p):(p=[m*a,m*u],l=[m*d,m*g],this._position[0]+=p[0],this._position[1]+=p[1]);var v=this._payload;v.delta=p,v.position=this._position,v.velocity=l,v.clientX=o,v.clientY=s,v.offsetX=t.offsetX,v.offsetY=t.offsetY,this._eventOutput.emit("update",v),this._prevCoord=[o,s],this._prevTime=r,this._move=!0}}function r(){this._down&&(this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1)}function a(t){if(this._down&&this._move){var e=s.bind(this),i=function(t){r.call(this,t),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i)}.bind(this,t);document.addEventListener("mousemove",e),document.addEventListener("mouseup",i)}}var u=t("famous/core/EventHandler");n.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1,propogate:!0},n.DIRECTION_X=0,n.DIRECTION_Y=1;var c=8,h=Date.now;n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.propogate&&(this.options.propogate=t.propogate)},i.exports=n}),define("famous/inputs/TouchTracker",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t,e,i){return{x:t.clientX,y:t.clientY,identifier:t.identifier,origin:e.origin,timestamp:h(),count:e.touches.length,history:i}}function o(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],o=n(i,t,null);this.eventOutput.emit("trackstart",o),this.selective||this.touchHistory[i.identifier]||this.track(o)}}function s(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],o=this.touchHistory[i.identifier];if(o){var s=n(i,t,o);this.touchHistory[i.identifier].push(s),this.eventOutput.emit("trackmove",s)}}}function r(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],o=this.touchHistory[i.identifier];if(o){var s=n(i,t,o);this.eventOutput.emit("trackend",s),delete this.touchHistory[i.identifier]}}}function a(){for(var t in this.touchHistory){var e=this.touchHistory[t];this.eventOutput.emit("trackend",{touch:e[e.length-1].touch,timestamp:Date.now(),count:0,history:e}),delete this.touchHistory[t]}}function u(t){this.selective=t,this.touchHistory={},this.eventInput=new c,this.eventOutput=new c,c.setInputHandler(this,this.eventInput),c.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",o.bind(this)),this.eventInput.on("touchmove",s.bind(this)),this.eventInput.on("touchend",r.bind(this)),this.eventInput.on("touchcancel",r.bind(this)),this.eventInput.on("unpipe",a.bind(this))}var c=t("famous/core/EventHandler"),h=Date.now;u.prototype.track=function(t){this.touchHistory[t.identifier]=[t]},i.exports=u}),define("famous/inputs/TouchSync",["require","exports","module","./TouchTracker","famous/core/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._eventOutput=new u,this._touchTracker=new a,u.setOutputHandler(this,this._eventOutput),u.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",o.bind(this)),this._touchTracker.on("trackmove",s.bind(this)),this._touchTracker.on("trackend",r.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function o(t){var e,i;void 0!==this.options.direction?(this._position=0,e=0,i=0):(this._position=[0,0],e=[0,0],i=[0,0]);var n=this._payload;n.delta=i,n.position=this._position,n.velocity=e,n.clientX=t.x,n.clientY=t.y,n.count=t.count,n.touch=t.identifier,this._eventOutput.emit("start",n)}function s(t){var e=t.history,i=e[e.length-1],o=e[e.length-2],s=o.timestamp,r=i.timestamp,a=i.x-o.x,u=i.y-o.y;this.options.rails&&(Math.abs(a)>Math.abs(u)?u=0:a=0);var h,l,p=Math.max(r-s,c),f=a/p,d=u/p,g=this.options.scale;this.options.direction===n.DIRECTION_X?(l=g*a,h=g*f,this._position+=l):this.options.direction===n.DIRECTION_Y?(l=g*u,h=g*d,this._position+=l):(l=[g*a,g*u],h=[g*f,g*d],this._position[0]+=l[0],this._position[1]+=l[1]);var m=this._payload;m.delta=l,m.velocity=h,m.position=this._position,m.clientX=t.x,m.clientY=t.y,m.count=t.count,m.touch=t.identifier,this._eventOutput.emit("update",m)}function r(t){this._payload.count=t.count,this._eventOutput.emit("end",this._payload)}var a=t("./TouchTracker"),u=t("famous/core/EventHandler");n.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1},n.DIRECTION_X=0,n.DIRECTION_Y=1;var c=8;n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.getOptions=function(){return this.options},i.exports=n}),define("famous/inputs/GenericSync",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t,e){this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this._syncs={},t&&this.addSync(t),e&&this.setOptions(e)}function o(t,e){r[t]&&(this._syncs[t]=new r[t](e),this.pipeSync(t))}var s=t("famous/core/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DIRECTION_Z=2;var r={};n.register=function(t){for(var e in t){if(r[e]){if(r[e]===t[e])return;throw new Error("this key is registered to a different sync class")}r[e]=t[e]}},n.prototype.setOptions=function(t){for(var e in this._syncs)this._syncs[e].setOptions(t)},n.prototype.pipeSync=function(t){var e=this._syncs[t];this._eventInput.pipe(e),e.pipe(this._eventOutput)},n.prototype.unpipeSync=function(t){var e=this._syncs[t];this._eventInput.unpipe(e),e.unpipe(this._eventOutput)},n.prototype.addSync=function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)o.call(this,t[e]);else if(t instanceof Object)for(var i in t)o.call(this,i,t[i])},i.exports=n}),define("controllers/GridController",["require","exports","module","controllers/Controller"],function(t,e,i){function n(){r.apply(this,arguments)}function o(t){for(var e=this.options.columns,i=this.options.rows,n=0;i>n;n++){if(e>t)return n;if(t>=e*n&&e*(n+1)>t)return n}}function s(t){var e=this.options.columns;return t%e}var r=t("controllers/Controller");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={rows:7,columns:5,viewWidth:window.innerWidth,viewHeight:window.innerHeight},n.prototype.getPieceSize=function(t){return this.options.viewWidth=t[0],this.options.viewHeight=t[1],this.getCellSize()},n.prototype.getCellSize=function(){var t,e=this.options.columns,i=this.options.viewWidth,n=Math.floor(i/e),o=this.options.rows,s=this.options.viewHeight,r=Math.floor(s/o);return t=r>n?[n,n]:[r,r],this._cellSize=t,t},n.prototype.getBoardSize=function(){var t=this.getCellSize(),e=t[0]*this.options.columns,i=t[0]*this.options.rows;return[e,i]},n.prototype.getXYCoordsFromGridCoords=function(t){var e=this._cellSize,i=t[0]*e[0],n=t[1]*e[1];return[i,n]},n.prototype.getXYCoordsFromIndex=function(t){return this.getXYCoords(t)},n.prototype.getXYCoords=function(t,e){var i,n=[];i=e?[e,e]:this._cellSize;var r=s.call(this,t)*i[0],a=o.call(this,t)*i[1];return n.push(r,a),n},n.prototype.isEmpty=function(){return null===this._state},i.exports=n}),define("views/Reflector",["require","exports","module","famous/core/Transform","famous/transitions/Transitionable","famous/core/OptionsManager"],function(t,e,i){function n(t){this.angle=new s(0),this.frontNode=void 0,this.backNode=void 0,this.reflected=!1,this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t),(this.options.direction===n.DIRECTION_UP||this.options.direction===n.DIRECTION_DOWN)&&(this.axis=n.AXIS_X),(this.options.direction===n.DIRECTION_LEFT||this.options.direction===n.DIRECTION_RIGHT)&&(this.axis=n.AXIS_Y)}var o=t("famous/core/Transform"),s=t("famous/transitions/Transitionable"),r=t("famous/core/OptionsManager");n.AXIS_X=0,n.AXIS_Y=1,n.DIRECTION_UP=0,n.DIRECTION_DOWN=1,n.DIRECTION_LEFT=2,n.DIRECTION_RIGHT=3,n.DEFAULT_OPTIONS={transition:!0,direction:n.DIRECTION_RIGHT},n.prototype.updateOptions=function(t){this.setOptions(t),(this.options.direction===n.DIRECTION_UP||this.options.direction===n.DIRECTION_DOWN)&&(this.axis=n.AXIS_X),(this.options.direction===n.DIRECTION_LEFT||this.options.direction===n.DIRECTION_RIGHT)&&(this.axis=n.AXIS_Y)},n.prototype.reflect=function(t,e){var i=this.reflected?0:Math.PI;this.setAngle(i,t,e),this.reflected=!this.reflected},n.prototype.reset=function(){this.angle=new s(0),this.reflected=!1,this.setAngle(0)},n.prototype.setAngle=function(t,e,i){void 0===e&&(e=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,e,i)},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.setFront=function(t){this.frontNode=t},n.prototype.setBack=function(t){this.backNode=t},n.prototype.render=function(){var t,e,i=this.angle.get(),s=[];return this.axis===n.AXIS_Y?(this.options.direction===n.DIRECTION_LEFT&&(i=-i),e=o.rotateY(i),t=o.rotateY(i)):(this.options.direction===n.DIRECTION_DOWN&&(i=-i),e=o.rotateX(i),t=o.rotateX(i)),this.frontNode&&s.push({transform:e,target:this.frontNode.render()}),this.backNode&&s.push({transform:o.moveThen([0,0,-.1],t),target:this.backNode.render()}),s},i.exports=n}),define("views/PieceView",["require","exports","module","famous/core/View","famous/core/Surface","famous/modifiers/StateModifier","views/Reflector"],function(t,e,i){function n(){c.apply(this,arguments),this.back=a.call(this),this.front=u.call(this),this.reflector=new p({direction:g[this.options.direction]}),this.reflector.setFront(this.front),this.reflector.setBack(this.back),r.call(this),this.add(this.reflectionMod).add(this.reflector)}function o(){return f.concat(this.options.backBgColor,"stage-"+this.options.stage,"level-"+this.options.level)}function s(){return d.concat(this.options.frontBgColor,"stage-"+this.options.stage,"level-"+this.options.level)}function r(){var t,e;"up"===this.options.direction?(e=[.5,0],t=[.5,0]):"down"===this.options.direction?(e=[.5,1],t=[.5,1]):"left"===this.options.direction?(e=[0,.5],t=[0,.5]):"right"===this.options.direction&&(e=[1,.5],t=[1,.5]),this.reflectionMod?(this.reflectionMod.setOrigin(e),this.reflectionMod.setAlign(t)):this.reflectionMod=new l({origin:e,align:t})}function a(){var t=new h({content:"",classes:o.call(this),origin:[.5,.5],align:[.5,.5],properties:{webkitBackfaceVisibility:"visible",pointerEvents:"none"}});return t}function u(){var t=new h({content:"",classes:s.call(this),origin:[.5,.5],align:[.5,.5],properties:{webkitBackfaceVisibility:"visible",pointerEvents:"none"}});return t}var c=t("famous/core/View"),h=t("famous/core/Surface"),l=t("famous/modifiers/StateModifier"),p=t("views/Reflector"),f=["piece","piece-back"],d=["piece","piece-front"],g={right:p.DIRECTION_RIGHT,left:p.DIRECTION_LEFT,up:p.DIRECTION_UP,down:p.DIRECTION_DOWN};n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={width:100,height:100,frontBgColor:"color-1",backBgColor:"color-2",direction:"left",obstacle:!1,level:1,stage:1},n.prototype.getOption=function(t){return this.options[t]},n.prototype.updateOptions=function(t){this.reset(),this.setOptions(t),this.back.setClasses(o.call(this)),this.front.setClasses(s.call(this)),r.call(this),this.reflector.updateOptions({direction:g[this.options.direction]}),this.reflector.setFront(this.front),this.reflector.setBack(this.back)},n.prototype.reset=function(){this.reflector.reset()},n.prototype.reflect=function(){this.reflector.reflect({curve:"linear",duration:500},function(){this._eventOutput.emit("reflected")}.bind(this))},i.exports=n}),define("controllers/PieceController",["require","exports","module","famous/modifiers/StateModifier","famous/core/RenderNode","controllers/Controller","controllers/GameController","views/PieceView"],function(t,e,i){function n(){if(n._instance)return n._instance;c.apply(this,arguments),this.colorQueue=[],this._deletedPieces=[],this._lastColor="",this._gameController=new h;for(var t=0;3>t;t++)this.addColorToQueue();n._instance=this}function o(t){var e=this._deletedPieces.pop(),i=e._piece,n=e._mod,o=this._gameController.getCurrentLevel(),s=this.getNextColorFromQueue();return this._lastColor||(this._lastColor=s),i.updateOptions({direction:t,frontBgColor:this._lastColor,backBgColor:s,level:o.level,stage:o.stage}),n.setOpacity(.999),n.setSize(this.options.pieceSize),this._lastColor=s,this.addColorToQueue(),e}function s(t){var e=this._gameController.getCurrentLevel();t||(t="left");var i=new u,n=new a({origin:[0,0],align:[0,0],size:this.options.pieceSize,opacity:.999});i._mod=n;var o=this.getNextColorFromQueue();this.addColorToQueue(),this._lastColor||(this._lastColor=o);var s={width:this.options.pieceSize[0],height:this.options.pieceSize[1],frontBgColor:this._lastColor,backBgColor:o,direction:t,level:e.level,stage:e.stage},r=new l(s);return i._piece=r,i.add(i._mod).add(i._piece),this._lastColor=o,i}function r(t,e){var i=Math.floor(Math.random()*(e-t+1))+t;return i}var a=t("famous/modifiers/StateModifier"),u=t("famous/core/RenderNode"),c=t("controllers/Controller"),h=t("controllers/GameController"),l=t("views/PieceView");n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n._instance=null,n.DEFAULT_OPTIONS={rows:7,columns:5,colors:3,pieceSize:[64,64]},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.resetLastColor=function(){this._lastColor=""},n.prototype.getPiece=function(t){var e=null;return e=0===this._deletedPieces.length?s.call(this,t):o.call(this,t)},n.prototype.addDeletedPiece=function(t){this._deletedPieces.push(t)},n.prototype.getNextColorFromQueue=function(t){var e;return t=void 0!==t?t:!0,t?(e=this.colorQueue.shift(),this._eventOutput.emit("piece:colorRemoved")):e=this.colorQueue[0],e},n.prototype.addColorToQueue=function(){var t=r(1,this.options.colors);this.colorQueue.push("color-"+t),this._eventOutput.emit("piece:colorsUpdated"),this._eventOutput.emit("piece:colorAdded")},i.exports=n}),define("views/BoardView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/inputs/MouseSync","famous/inputs/TouchSync","famous/inputs/GenericSync","famous/utilities/Timer","controllers/GridController","controllers/GameController","controllers/PieceController"],function(t,e,i){function n(){var t=this.options.rows*this.options.columns;this._state=[];for(var e=0;t>e;e++)this._state.push(null)}function o(t){return this._state[t]._piece}function s(t){return this._state[t]._mod}function r(){function t(t){this.deleteMatches(t,function(){g.call(this,t);var e=this._pieceGenerator.getNextColorFromQueue(!1);f.call(this,this._currentIndex,e)}.bind(this))}var e,i,n,o,s=new T(["touch","mouse"]);this._controller.on("game:won",function(){p.call(this,!1,!1,function(){this._eventOutput.emit("game:won",{piece:M})
}.bind(this))}.bind(this)),this._controller.on("game:lost",function(){this._eventOutput.emit("game:lost",{piece:M})}.bind(this)),this._controller.on("game:reset",function(){p.call(this,!0,!0)}.bind(this)),this._pieceGenerator._eventOutput.pipe(this._eventOutput),this.backing.pipe(s),s.on("start",function(t){e=t.clientX,i=t.clientY}),s.on("end",function(s){n=s.clientX,o=s.clientY;var r=y.call(this,e,i,n,o);if(r){this._turns++,this._controller.addTurn();var a=v.call(this,this._currentIndex,r);if(this.isInBounds(r)&&!this._state[a]){var u=this._pieceGenerator.getPiece(r);this.placePiece(u,a),this._state[a]=u,u._piece.reflect(),E.setTimeout(t.bind(this,a),500)}}}.bind(this))}function a(){this._turns=0,this._currentIndex=this.options.startIndex,this._gridController.setOptions({columns:this.options.columns,rows:this.options.rows,viewWidth:this.options.viewWidth,viewHeight:this.options.viewHeight}),this._pieceSize=this._gridController.getCellSize(),this.boardSurface.setProperties({backgroundSize:2*this._pieceSize[0]+"px "+2*this._pieceSize[1]+"px"}),l.call(this,this._pieceSize),this._pieceGenerator=new k,this._pieceGenerator.setOptions({rows:this.options.rows,columns:this.options.columns,pieceSize:this._pieceSize}),this._pieceGenerator.resetLastColor(),this.rootMod.setSize(this._gridController.getBoardSize()),n.call(this);var t=this._pieceGenerator.getPiece();this.placePiece(t,this._currentIndex);var e=this._pieceGenerator.getNextColorFromQueue(!1);f.call(this,this._currentIndex,e),this._state[this._currentIndex]=t}function u(){_.apply(this,arguments),this._controller=new C,this._gridController=new I,this.rootMod=new S({origin:[.5,.5],align:[.5,.5],transform:w.translate(0,0,1)}),this.node=this.add(this.rootMod),h.call(this),c.call(this),a.call(this),r.call(this)}function c(){this.overlay=new b({properties:{backgroundColor:"#e5e5e5"}}),this.dimmer=new S({opacity:.001,transform:w.translate(0,0,-10)}),this.add(this.dimmer).add(this.overlay)}function h(){this.backing=new b({classes:["gameboard-backing"]}),this.boardSurface=new b({classes:["gameboard","gameboard-board"],properties:{pointerEvents:"none",zIndex:5}});var t=new S({transform:w.translate(0,0,170)}),e=new S({transform:w.translate(0,0,175)});this.add(t).add(this.backing),this.node.add(e).add(this.boardSurface)}function l(t){var e,i;if(i=this._highlights&&this._highlights.length?this._highlights:[],!i.length)for(var n=4;n>=1;n--){e=new b({properties:{pointerEvents:"none"}});var o=new S({origin:[0,0],align:[0,0],opacity:.3,transform:w.translate(0,0,180)}),s=new S({origin:[.5,.5],align:[.5,.5]});e._mod=o,e._scaleMod=s,i.push(e),this.node.add(e._mod).add(e._scaleMod).add(e)}for(var r=i.length-1;r>=0;r--)e=i[r],e._mod.setSize(t),e._scaleMod.setSize(t);this._highlights=i}function p(t,e,i){t=t||!1,e=e||!1;for(var n=[],o=0;o<this._state.length;o++){var s=this._state[o];(!s||s!==M||t)&&s&&n.push(o)}this.deletePieces(n,!0,function(){d.call(this),e&&a.call(this),i&&i()}.bind(this))}function f(t,e){function i(){for(var i=m.call(this,t),n=i.length-1;n>=0;n--){var o=i[n],s=this._highlights[n],r=this._gridController.getXYCoordsFromIndex(o),a=this._controller.getCurrentLevel();s.setClasses(["gameboard-possible-move","piece","stage-"+a.stage,"level-"+a.level,e]),s._mod.setTransform(w.translate(r[0],r[1],180)),s._scaleMod.setTransform(w.scale(1,1,1),{duration:300})}}d.call(this,i.bind(this))}function d(t){for(var e=300,i=this._highlights.length-1;i>=0;i--){var n=this._highlights[i];n._scaleMod.setTransform(w.scale(.001,.001,180),{curve:"linear",duration:e})}t&&E.setTimeout(t,e)}function g(t){var e=m.call(this,t);0===e.length&&this._controller.gameOver()}function m(t){var e=[],i={left:this.isInBounds("left"),right:this.isInBounds("right"),up:this.isInBounds("up"),down:this.isInBounds("down")};for(var n in i)if(i[n]){var o=v.call(this,t,n);null===this._state[o]&&e.push(o)}return e}function v(t,e){return"left"===e?t-1:"right"===e?t+1:"up"===e?t-this.options.columns:"down"===e?t+this.options.columns:void 0}function y(t,e,i,n){var o="";return i>t&&i-t>n-e&&i-t>e-n?o="right":t>i&&t-i>n-e&&t-i>e-n?o="left":n>e&&n-e>i-t&&n-e>t-i?o="down":e>n&&e-n>i-t&&e-n>t-i&&(o="up"),o}var _=t("famous/core/View"),b=t("famous/core/Surface"),w=t("famous/core/Transform"),S=t("famous/modifiers/StateModifier"),x=t("famous/inputs/MouseSync"),O=t("famous/inputs/TouchSync"),T=t("famous/inputs/GenericSync"),E=t("famous/utilities/Timer");T.register({mouse:x,touch:O});var I=t("controllers/GridController"),C=t("controllers/GameController"),k=t("controllers/PieceController"),M=null;u.DEFAULT_OPTIONS={startIndex:12,rows:8,columns:5,viewWidth:window.innerWidth,viewHeight:window.innerHeight},u.prototype=Object.create(_.prototype),u.prototype.constructor=u,u.prototype.update=function(){this.setOptions({rows:this._controller.getRows(),columns:this._controller.getCols(),startIndex:this._controller.getStartIndex()}),this.clear(),a.call(this)},u.prototype.clear=function(){for(var t=this._state.length-1;t>=0;t--){var e=this._state[t];e&&this.deletePiece(t,!0)}},u.prototype.placePiece=function(t,e){var i=this._gridController.getXYCoordsFromIndex(this._currentIndex);t._mod.setTransform(w.translate(i[0],i[1],180)),this._currentIndex=e,this._lastPiecePosition=this._gridController.getXYCoordsFromIndex(e),this.node.add(t),M=t},u.prototype.deleteMatches=function(t,e){function i(t){for(var e=this.checkIfAnyNeighborHasMatch(t),s=0;s<e.length;s++)if(e[s]){var r=e[s][0];e[s][1]!==!0||n[r]||(n[r]=!0,o++,i.call(this,r))}}var n=[],o=0,s=t;if(n[t]=!0,i.call(this,t),o>1){for(var r=[],a=0;a<n.length;a++)n[a]&&a!==s&&r.push(a);this.deletePieces(r,!1,function(){this._controller.doWinCheck(),e&&e()})}else e&&e()},u.prototype.checkIfAnyNeighborHasMatch=function(t){var e=[],i={left:this.checkIfDirectionHasMatch(t,"left"),right:this.checkIfDirectionHasMatch(t,"right"),up:this.checkIfDirectionHasMatch(t,"up"),down:this.checkIfDirectionHasMatch(t,"down")};for(var n in i)this.isInBounds(n)&&i[n]&&e.push(i[n]);return e},u.prototype.checkIfDirectionHasMatch=function(t,e){var i,n=[],o=this.getColorFromIndex(t),s=v.call(this,t,e),r=this.isInBounds(e,t),a=this._state[s];if(a&&r){var u=this.getColorFromIndex(s);return i=u===o,n.push(s,i),n}return i=!1,n.push(s,i),n},u.prototype.getColorFromIndex=function(t){if(this._state[t]){var e=o.call(this,t).getOption("backBgColor");return e}},u.prototype.isInBounds=function(t,e){var i;i=e?this._gridController.getXYCoordsFromIndex(e):this._lastPiecePosition;var n=!0,o=this._pieceSize,s=this.options.columns*o[0],r=this.options.rows*o[1],a=i[0]+o[0],u=i[1]+o[1];return"left"===t&&0===i[0]&&(n=!1),"right"===t&&a===s&&(n=!1),"up"===t&&0===i[1]&&(n=!1),"down"===t&&u===r&&(n=!1),n},u.prototype.deletePieces=function(t,e,i){for(var n=t.length-1;n>=0;n--){var o=t[n];E.setTimeout(this.deletePiece.bind(this,o,e),100*n)}i&&E.setTimeout(function(){i.call(this)}.bind(this),100*t.length)},u.prototype.deletePiece=function(t,e){function i(){n.setTransform(w.translate(2e3,2e3,0)),n.setOpacity(.999)}e||this._controller.addDestroyed(),this._pieceGenerator.addDeletedPiece(this._state[t]);var n=s.call(this,t);n.setOpacity(.001,{curve:"easeOut",duration:500},i),this._state[t]=null},u.prototype.show=function(){this.dimmer.setOpacity(.001,{curve:"linear",duration:300},function(){this.dimmer.setTransform(w.translate(0,0,-10))}.bind(this))},u.prototype.dim=function(){this.dimmer.setTransform(w.translate(0,0,200)),this.dimmer.setOpacity(.7,{curve:"linear",duration:300})},i.exports=u}),define("hbs/handlebars",[],function(){var t=function(){var t=function(){function t(t){this.string=t}var e;return t.prototype.toString=function(){return""+this.string},e=t}(),e=function(t){function e(t){return a[t]||"&amp;"}function i(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function n(t){return t instanceof r?t.toString():t||0===t?(t=""+t,c.test(t)?t.replace(u,e):t):""}function o(t){return t||0===t?p(t)&&0===t.length?!0:!1:!0}var s={},r=t,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,c=/[&<>"'`]/;s.extend=i;var h=Object.prototype.toString;s.toString=h;var l=function(t){return"function"==typeof t};l(/x/)&&(l=function(t){return"function"==typeof t&&"[object Function]"===h.call(t)});var l;s.isFunction=l;var p=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===h.call(t):!1};return s.isArray=p,s.escapeExpression=n,s.isEmpty=o,s}(t),i=function(){function t(t,e){var n;e&&e.firstLine&&(n=e.firstLine,t+=" - "+n+":"+e.firstColumn);for(var o=Error.prototype.constructor.call(this,t),s=0;s<i.length;s++)this[i[s]]=o[i[s]];n&&(this.lineNumber=n,this.column=e.firstColumn)}var e,i=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,e=t}(),n=function(t,e){function i(t,e){this.helpers=t||{},this.partials=e||{},n(this)}function n(t){t.registerHelper("helperMissing",function(t){if(2===arguments.length)return void 0;throw new a("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,i){var n=i.inverse||function(){},o=i.fn;return p(e)&&(e=e.call(this)),e===!0?o(this):e===!1||null==e?n(this):l(e)?e.length>0?t.helpers.each(e,i):n(this):o(e)}),t.registerHelper("each",function(t,e){var i,n=e.fn,o=e.inverse,s=0,r="";if(p(t)&&(t=t.call(this)),e.data&&(i=m(e.data)),t&&"object"==typeof t)if(l(t))for(var a=t.length;a>s;s++)i&&(i.index=s,i.first=0===s,i.last=s===t.length-1),r+=n(t[s],{data:i});else for(var u in t)t.hasOwnProperty(u)&&(i&&(i.key=u,i.index=s,i.first=0===s),r+=n(t[u],{data:i}),s++);return 0===s&&(r=o(this)),r}),t.registerHelper("if",function(t,e){return p(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||r.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),t.registerHelper("with",function(t,e){return p(t)&&(t=t.call(this)),r.isEmpty(t)?void 0:e.fn(t)}),t.registerHelper("log",function(e,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;t.log(n,e)})}function o(t,e){g.log(t,e)}var s={},r=t,a=e,u="1.3.0";s.VERSION=u;var c=4;s.COMPILER_REVISION=c;var h={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};s.REVISION_CHANGES=h;var l=r.isArray,p=r.isFunction,f=r.toString,d="[object Object]";s.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:g,log:o,registerHelper:function(t,e,i){if(f.call(t)===d){if(i||e)throw new a("Arg not supported with multiple helpers");r.extend(this.helpers,t)}else i&&(e.not=i),this.helpers[t]=e},registerPartial:function(t,e){f.call(t)===d?r.extend(this.partials,t):this.partials[t]=e}};var g={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(g.level<=t){var i=g.methodMap[t];"undefined"!=typeof console&&console[i]&&console[i].call(console,e)}}};s.logger=g,s.log=o;var m=function(t){var e={};return r.extend(e,t),e};return s.createFrame=m,s}(e,i),o=function(t,e,i){function n(t){var e=t&&t[0]||1,i=p;if(e!==i){if(i>e){var n=f[i],o=f[e];throw new l("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new l("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function o(t,e){if(!e)throw new l("No environment passed to template");var i=function(t,i,n,o,s,r){var a=e.VM.invokePartial.apply(this,arguments);if(null!=a)return a;if(e.compile){var u={helpers:o,partials:s,data:r};return s[i]=e.compile(t,{data:void 0!==r},e),s[i](n,u)}throw new l("The partial "+i+" could not be compiled when running in runtime-only mode")},n={escapeExpression:h.escapeExpression,invokePartial:i,programs:[],program:function(t,e,i){var n=this.programs[t];return i?n=r(t,e,i):n||(n=this.programs[t]=r(t,e)),n},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i={},h.extend(i,e),h.extend(i,t)),i},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(i,o){o=o||{};var s,r,a=o.partial?o:e;o.partial||(s=o.helpers,r=o.partials);var u=t.call(n,a,i,s,r,o.data);return o.partial||e.VM.checkRevision(n.compilerInfo),u}}function s(t,e,i){var n=Array.prototype.slice.call(arguments,3),o=function(t,o){return o=o||{},e.apply(this,[t,o.data||i].concat(n))};return o.program=t,o.depth=n.length,o}function r(t,e,i){var n=function(t,n){return n=n||{},e(t,n.data||i)};return n.program=t,n.depth=0,n}function a(t,e,i,n,o,s){var r={partial:!0,helpers:n,partials:o,data:s};if(void 0===t)throw new l("The partial "+e+" could not be found");return t instanceof Function?t(i,r):void 0}function u(){return""}var c={},h=t,l=e,p=i.COMPILER_REVISION,f=i.REVISION_CHANGES;return c.checkRevision=n,c.template=o,c.programWithDepth=s,c.program=r,c.invokePartial=a,c.noop=u,c}(e,i,n),s=function(t,e,i,n,o){var s,r=t,a=e,u=i,c=n,h=o,l=function(){var t=new r.HandlebarsEnvironment;return c.extend(t,r),t.SafeString=a,t.Exception=u,t.Utils=c,t.VM=h,t.template=function(e){return h.template(e,t)},t},p=l();return p.create=l,s=p}(n,t,i,e,o),r=function(t){function e(t){t=t||{},this.firstLine=t.first_line,this.firstColumn=t.first_column,this.lastColumn=t.last_column,this.lastLine=t.last_line}var i,n=t,o={ProgramNode:function(t,i,n,s){var r,a;3===arguments.length?(s=n,n=null):2===arguments.length&&(s=i,i=null),e.call(this,s),this.type="program",this.statements=t,this.strip={},n?(a=n[0],a?(r={first_line:a.firstLine,last_line:a.lastLine,last_column:a.lastColumn,first_column:a.firstColumn},this.inverse=new o.ProgramNode(n,i,r)):this.inverse=new o.ProgramNode(n,i),this.strip.right=i.left):i&&(this.strip.left=i.right)},MustacheNode:function(t,i,n,s,r){if(e.call(this,r),this.type="mustache",this.strip=s,null!=n&&n.charAt){var a=n.charAt(3)||n.charAt(2);this.escaped="{"!==a&&"&"!==a}else this.escaped=!!n;this.sexpr=t instanceof o.SexprNode?t:new o.SexprNode(t,i),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(t,i,n){e.call(this,n),this.type="sexpr",this.hash=i;var o=this.id=t[0],s=this.params=t.slice(1),r=this.eligibleHelper=o.isSimple;this.isHelper=r&&(s.length||i)},PartialNode:function(t,i,n,o){e.call(this,o),this.type="partial",this.partialName=t,this.context=i,this.strip=n},BlockNode:function(t,i,o,s,r){if(e.call(this,r),t.sexpr.id.original!==s.path.original)throw new n(t.sexpr.id.original+" doesn't match "+s.path.original,this);this.type="block",this.mustache=t,this.program=i,this.inverse=o,this.strip={left:t.strip.left,right:s.strip.right},(i||o).strip.left=t.strip.right,(o||i).strip.right=s.strip.left,o&&!i&&(this.isInverse=!0)},ContentNode:function(t,i){e.call(this,i),this.type="content",this.string=t},HashNode:function(t,i){e.call(this,i),this.type="hash",this.pairs=t},IdNode:function(t,i){e.call(this,i),this.type="ID";for(var o="",s=[],r=0,a=0,u=t.length;u>a;a++){var c=t[a].part;if(o+=(t[a].separator||"")+c,".."===c||"."===c||"this"===c){if(s.length>0)throw new n("Invalid path: "+o,this);".."===c?r++:this.isScoped=!0}else s.push(c)}this.original=o,this.parts=s,this.string=s.join("."),this.depth=r,this.isSimple=1===t.length&&!this.isScoped&&0===r,this.stringModeValue=this.string},PartialNameNode:function(t,i){e.call(this,i),this.type="PARTIAL_NAME",this.name=t.original},DataNode:function(t,i){e.call(this,i),this.type="DATA",this.id=t},StringNode:function(t,i){e.call(this,i),this.type="STRING",this.original=this.string=this.stringModeValue=t},IntegerNode:function(t,i){e.call(this,i),this.type="INTEGER",this.original=this.integer=t,this.stringModeValue=Number(t)},BooleanNode:function(t,i){e.call(this,i),this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},CommentNode:function(t,i){e.call(this,i),this.type="comment",this.comment=t}};return i=o}(i),a=function(){var t,e=function(){function t(t,e){return{left:"~"===t.charAt(2),right:"~"===e.charAt(0)||"~"===e.charAt(1)}}function e(){this.yy={}}var i={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(e,i,n,o,s,r){var a=r.length-1;switch(s){case 1:return new o.ProgramNode(r[a-1],this._$);case 2:return new o.ProgramNode([],this._$);case 3:this.$=new o.ProgramNode([],r[a-1],r[a],this._$);break;case 4:this.$=new o.ProgramNode(r[a-2],r[a-1],r[a],this._$);break;case 5:this.$=new o.ProgramNode(r[a-1],r[a],[],this._$);break;case 6:this.$=new o.ProgramNode(r[a],this._$);break;case 7:this.$=new o.ProgramNode([],this._$);break;case 8:this.$=new o.ProgramNode([],this._$);break;case 9:this.$=[r[a]];break;case 10:r[a-1].push(r[a]),this.$=r[a-1];break;case 11:this.$=new o.BlockNode(r[a-2],r[a-1].inverse,r[a-1],r[a],this._$);break;case 12:this.$=new o.BlockNode(r[a-2],r[a-1],r[a-1].inverse,r[a],this._$);break;case 13:this.$=r[a];break;case 14:this.$=r[a];break;case 15:this.$=new o.ContentNode(r[a],this._$);break;case 16:this.$=new o.CommentNode(r[a],this._$);break;case 17:this.$=new o.MustacheNode(r[a-1],null,r[a-2],t(r[a-2],r[a]),this._$);break;case 18:this.$=new o.MustacheNode(r[a-1],null,r[a-2],t(r[a-2],r[a]),this._$);break;case 19:this.$={path:r[a-1],strip:t(r[a-2],r[a])};break;case 20:this.$=new o.MustacheNode(r[a-1],null,r[a-2],t(r[a-2],r[a]),this._$);break;case 21:this.$=new o.MustacheNode(r[a-1],null,r[a-2],t(r[a-2],r[a]),this._$);break;case 22:this.$=new o.PartialNode(r[a-2],r[a-1],t(r[a-3],r[a]),this._$);break;case 23:this.$=t(r[a-1],r[a]);break;case 24:this.$=new o.SexprNode([r[a-2]].concat(r[a-1]),r[a],this._$);break;case 25:this.$=new o.SexprNode([r[a]],null,this._$);break;case 26:this.$=r[a];break;case 27:this.$=new o.StringNode(r[a],this._$);break;case 28:this.$=new o.IntegerNode(r[a],this._$);break;case 29:this.$=new o.BooleanNode(r[a],this._$);break;case 30:this.$=r[a];break;case 31:r[a-1].isHelper=!0,this.$=r[a-1];break;case 32:this.$=new o.HashNode(r[a],this._$);break;case 33:this.$=[r[a-2],r[a]];break;case 34:this.$=new o.PartialNameNode(r[a],this._$);break;case 35:this.$=new o.PartialNameNode(new o.StringNode(r[a],this._$),this._$);break;case 36:this.$=new o.PartialNameNode(new o.IntegerNode(r[a],this._$));break;case 37:this.$=new o.DataNode(r[a],this._$);break;case 38:this.$=new o.IdNode(r[a],this._$);break;case 39:r[a-2].push({part:r[a],separator:r[a-1]}),this.$=r[a-2];break;case 40:this.$=[{part:r[a]}];break;case 43:this.$=[];break;case 44:r[a-1].push(r[a]);break;case 47:this.$=[r[a]];break;case 48:r[a-1].push(r[a])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(t){throw new Error(t)},parse:function(t){function e(){var t;return t=i.lexer.lex()||1,"number"!=typeof t&&(t=i.symbols_[t]||t),t}var i=this,n=[0],o=[null],s=[],r=this.table,a="",u=0,c=0,h=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;s.push(l);var p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,d,g,m,v,y,_,b,w,S={};;){if(g=n[n.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===f||"undefined"==typeof f)&&(f=e()),m=r[g]&&r[g][f]),"undefined"==typeof m||!m.length||!m[0]){var x="";if(!h){w=[];for(y in r[g])this.terminals_[y]&&y>2&&w.push("'"+this.terminals_[y]+"'");x=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:l,expected:w})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+f);switch(m[0]){case 1:n.push(f),o.push(this.lexer.yytext),s.push(this.lexer.yylloc),n.push(m[1]),f=null,d?(f=d,d=null):(c=this.lexer.yyleng,a=this.lexer.yytext,u=this.lexer.yylineno,l=this.lexer.yylloc,h>0&&h--);break;case 2:if(_=this.productions_[m[1]][1],S.$=o[o.length-_],S._$={first_line:s[s.length-(_||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(_||1)].first_column,last_column:s[s.length-1].last_column},p&&(S._$.range=[s[s.length-(_||1)].range[0],s[s.length-1].range[1]]),v=this.performAction.call(S,a,c,u,this.yy,m[1],o,s),"undefined"!=typeof v)return v;_&&(n=n.slice(0,-1*_*2),o=o.slice(0,-1*_),s=s.slice(0,-1*_)),n.push(this.productions_[m[1]][0]),o.push(S.$),s.push(S._$),b=r[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,o;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),r=0;r<s.length&&(i=this._input.match(this.rules[s[r]]),!i||e&&!(i[0].length>e[0].length)||(e=i,n=r,this.options.flex));r++);return e?(o=e[0].match(/(?:\r\n?|\n).*/g),o&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,s[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i,n){function o(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}switch(i){case 0:if("\\\\"===e.yytext.slice(-2)?(o(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(o(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return o(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return o(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return e.yytext=o(1,2).replace(/\\"/g,'"'),32;case 24:return e.yytext=o(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return e.yytext=o(1,2),40;case 31:return"INVALID";case 32:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},t
}();return i.lexer=n,e.prototype=i,i.Parser=e,new e}();return t=e}(),u=function(t,e){function i(t){return t.constructor===s.ProgramNode?t:(o.yy=s,o.parse(t))}var n={},o=t,s=e;return n.parser=o,n.parse=i,n}(a,r),c=function(t){function e(){}function i(t,e,i){if(null==t||"string"!=typeof t&&t.constructor!==i.AST.ProgramNode)throw new s("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0);var n=i.parse(t),o=(new i.Compiler).compile(n,e);return(new i.JavaScriptCompiler).compile(o,e)}function n(t,e,i){function n(){var n=i.parse(t),o=(new i.Compiler).compile(n,e),s=(new i.JavaScriptCompiler).compile(o,e,void 0,!0);return i.template(s)}if(null==t||"string"!=typeof t&&t.constructor!==i.AST.ProgramNode)throw new s("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);e=e||{},"data"in e||(e.data=!0);var o;return function(t,e){return o||(o=n()),o.call(this,t,e)}}var o={},s=t;return o.Compiler=e,e.prototype={compiler:e,disassemble:function(){for(var t,e,i,n=this.opcodes,o=[],s=0,r=n.length;r>s;s++)if(t=n[s],"DECLARE"===t.opcode)o.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var a=0;a<t.args.length;a++)i=t.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),e.push(i);o.push(t.opcode+" "+e.join(" "))}return o.join("\n")},equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;e>i;i++){var n=this.opcodes[i],o=t.opcodes[i];if(n.opcode!==o.opcode||n.args.length!==o.args.length)return!1;for(var s=0;s<n.args.length;s++)if(n.args[s]!==o.args[s])return!1}if(e=this.children.length,t.children.length!==e)return!1;for(i=0;e>i;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=e;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.accept(t)},accept:function(t){var e,i=t.strip||{};return i.left&&this.opcode("strip"),e=this[t.type](t),i.right&&this.opcode("strip"),e},program:function(t){for(var e=t.statements,i=0,n=e.length;n>i;i++)this.accept(e[i]);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,i=(new this.compiler).compile(t,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var o=0,s=i.depths.list.length;s>o;o++)e=i.depths.list[o],2>e||this.addDepth(e-1);return n},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var o=e.sexpr,s=this.classifySexpr(o);"helper"===s?this.helperSexpr(o,i,n):"simple"===s?(this.simpleSexpr(o),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(o,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,i,n=t.pairs;this.opcode("pushHash");for(var o=0,s=n.length;s>o;o++)e=n[o],i=e[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type),"sexpr"===i.type&&this.sexpr(i)):this.accept(i),this.opcode("assignToHash",e[0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.name),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){this.sexpr(t.sexpr),this.opcode(t.escaped&&!this.options.noEscape?"appendEscaped":"append")},ambiguousSexpr:function(t,e,i){var n=t.id,o=n.parts[0],s=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",o,s)},simpleSexpr:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),o=t.id.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new s("You specified knownHelpersOnly, but used the unknown helper "+o,t);this.opcode("invokeHelper",n.length,o,t.isRoot)}},sexpr:function(t){var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var i=1,n=t.parts.length;n>i;i++)this.opcode("lookup",t.parts[i])},DATA:function(t){if(this.options.data=!0,t.id.isScoped||t.id.depth)throw new s("Scoped data references are not supported: "+t.original,t);this.opcode("lookupData");for(var e=t.id.parts,i=0,n=e.length;n>i;i++)this.opcode("lookup",e[i])},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifySexpr:function(t){var e=t.isHelper,i=t.eligibleHelper,n=this.options;if(i&&!e){var o=t.id.parts[0];n.knownHelpers[o]?e=!0:n.knownHelpersOnly&&(i=!1)}return e?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e,i=t.length;i--;)e=t[i],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type),"sexpr"===e.type&&this.sexpr(e)):this[e.type](e)},setupFullMustacheParams:function(t,e,i){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.hash(t.hash):this.opcode("emptyHash"),n}},o.precompile=i,o.compile=n,o}(i),h=function(t,e){function i(t){this.value=t}function n(){}var o,s=t.COMPILER_REVISION,r=t.REVISION_CHANGES,a=t.log,u=e;n.prototype={nameLookup:function(t,e){var i,o;return 0===t.indexOf("depth")&&(i=!0),o=/^[0-9]+$/.test(e)?t+"["+e+"]":n.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']",i?"("+t+" && "+o+")":o},compilerInfo:function(){var t=s,e=r[t];return"this.compilerInfo = ["+t+",'"+e+"'];\n"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,i,n){this.environment=t,this.options=e||{},a("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e);var o,s=t.opcodes;this.i=0;for(var r=s.length;this.i<r;this.i++)o=s[this.i],"DECLARE"===o.opcode?this[o.name]=o.value:this[o.opcode].apply(this,o.args),o.opcode!==this.stripNext&&(this.stripNext=!1);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new u("Compile completed with content left on stack");return this.createFunctionContext(n)},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,i="helpers = this.merge(helpers, "+e+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+e+".partials);"),this.options.data&&(i+=" data = data || {};"),t.push(i)}t.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(t){var e=this.stackVars.concat(this.registers.list);if(e.length>0&&(this.source[1]=this.source[1]+", "+e.join(", ")),!this.isChild)for(var i in this.context.aliases)this.context.aliases.hasOwnProperty(i)&&(this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],o=0,s=this.environment.depths.list.length;s>o;o++)n.push("depth"+this.environment.depths.list[o]);var r=this.mergeSource();if(this.isChild||(r=this.compilerInfo()+r),t)return n.push(r),Function.apply(this,n);var u="function "+(this.name||"")+"("+n.join(",")+") {\n  "+r+"}";return a("debug",u+"\n\n"),u},mergeSource:function(){for(var t,e="",i=0,n=this.source.length;n>i;i++){var o=this.source[i];o.appendToBuffer?t=t?t+"\n    + "+o.content:o.content:(t&&(e+="buffer += "+t+";\n  ",t=void 0),e+=o+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),"blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.pendingContent&&(t=this.pendingContent+t),this.stripNext&&(t=t.replace(/^\s+/,"")),this.pendingContent=t},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(t,e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e),"sexpr"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+t.contexts.join(",")+"}"),this.push("{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){this.pushStackLiteral(null!=t?this.programExpression(t):null)},invokeHelper:function(t,e,i){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var n=this.lastHelper=this.setupHelper(t,e,!0),o=this.nameLookup("depth"+this.lastContext,e,"context"),s="helper = "+n.name+" || "+o;n.paramsInit&&(s+=","+n.paramsInit),this.push("("+s+",helper ? helper.call("+n.callParams+") : helperMissing.call("+n.helperMissingParams+"))"),i||this.flushInline()},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t,e){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var i=this.setupHelper(0,t,e),n=this.lastHelper=this.nameLookup("helpers",t,"helper"),o=this.nameLookup("depth"+this.lastContext,t,"context"),s=this.nextStack();i.paramsInit&&this.pushSource(i.paramsInit),this.pushSource("if (helper = "+n+") { "+s+" = helper.call("+i.callParams+"); }"),this.pushSource("else { helper = "+o+"; "+s+" = typeof helper === functionType ? helper.call("+i.callParams+") : helper; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+e.join(", ")+")")},assignToHash:function(t){var e,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),e=this.popStack());var o=this.hash;e&&o.contexts.push("'"+t+"': "+e),i&&o.types.push("'"+t+"': "+i),o.values.push("'"+t+"': ("+n+")")},compiler:n,compileChildren:function(t,e){for(var i,n,o=t.children,s=0,r=o.length;r>s;s++){i=o[s],n=new this.compiler;var a=this.matchExistingProgram(i);null==a?(this.context.programs.push(""),a=this.context.programs.length,i.index=a,i.name="program"+a,this.context.programs[a]=n.compile(i,e,this.context),this.context.environments[a]=i):(i.index=a,i.name="program"+a)}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;i>e;e++){var n=this.context.environments[e];if(n&&n.equals(t))return e}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,i=this.environment.children[t],n=i.depths.list,o=[i.index,i.name,"data"],s=0,r=n.length;r>s;s++)e=n[s],o.push(1===e?"depth0":"depth"+(e-1));return(0===n.length?"self.program(":"self.programWithDepth(")+o.join(", ")+")"},register:function(t,e){this.useRegister(t),this.pushSource(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new i(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),t&&this.source.push(t)},pushStack:function(t){this.flushInline();var e=this.incrStack();return t&&this.pushSource(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){var e,n,o,s="",r=this.isInline();if(r){var a=this.popStack(!0);if(a instanceof i)e=a.value,o=!0;else{n=!this.stackSlot;var u=n?this.incrStack():this.topStackName();s="("+this.push(u)+" = "+a+"),",e=this.topStack()}}else e=this.topStack();var c=t.call(this,e);return r?(o||this.popStack(),n&&this.stackSlot--,this.push("("+s+c+")")):(/^stack/.test(e)||(e=this.nextStack()),this.pushSource(e+" = ("+s+c+");")),e},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,n=t.length;n>e;e++){var o=t[e];o instanceof i?this.compileStack.push(o):this.pushStack(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),n=(e?this.inlineStack:this.compileStack).pop();if(!t&&n instanceof i)return n.value;if(!e){if(!this.stackSlot)throw new u("Invalid stack pop");this.stackSlot--}return n},topStack:function(t){var e=this.isInline()?this.inlineStack:this.compileStack,n=e[e.length-1];return!t&&n instanceof i?n.value:n},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(t,e,i){var n=[],o=this.setupParams(t,n,i),s=this.nameLookup("helpers",e,"helper");return{params:n,paramsInit:o,name:s,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(e)].concat(n).join(", ")}},setupOptions:function(t,e){var i,n,o,s=[],r=[],a=[];s.push("hash:"+this.popStack()),this.options.stringParams&&(s.push("hashTypes:"+this.popStack()),s.push("hashContexts:"+this.popStack())),n=this.popStack(),o=this.popStack(),(o||n)&&(o||(this.context.aliases.self="this",o="self.noop"),n||(this.context.aliases.self="this",n="self.noop"),s.push("inverse:"+n),s.push("fn:"+o));for(var u=0;t>u;u++)i=this.popStack(),e.push(i),this.options.stringParams&&(a.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(s.push("contexts:["+r.join(",")+"]"),s.push("types:["+a.join(",")+"]")),this.options.data&&s.push("data:data"),s},setupParams:function(t,e,i){var n="{"+this.setupOptions(t,e).join(",")+"}";return i?(this.useRegister("options"),e.push("options"),"options="+n):(e.push(n),"")}};for(var c="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),h=n.RESERVED_WORDS={},l=0,p=c.length;p>l;l++)h[c[l]]=!0;return n.isValidJavaScriptVariableName=function(t){return!n.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)?!0:!1},o=n}(n,i),l=function(t,e,i,n,o){var s,r=t,a=e,u=i.parser,c=i.parse,h=n.Compiler,l=n.compile,p=n.precompile,f=o,d=r.create,g=function(){var t=d();return t.compile=function(e,i){return l(e,i,t)},t.precompile=function(e,i){return p(e,i,t)},t.AST=a,t.Compiler=h,t.JavaScriptCompiler=f,t.Parser=u,t.parse=c,t};return r=g(),r.create=g,s=r}(s,r,u,c,h);return l}();return t}),define("hbs/underscore",[],function(){function t(e,i,n){if(e===i)return 0!==e||1/e==1/i;if(null==e||null==i)return e===i;if(e._chain&&(e=e._wrapped),i._chain&&(i=i._wrapped),e.isEqual&&w.isFunction(e.isEqual))return e.isEqual(i);if(i.isEqual&&w.isFunction(i.isEqual))return i.isEqual(e);var o=a.call(e);if(o!=a.call(i))return!1;switch(o){case"[object String]":return e==String(i);case"[object Number]":return e!=+e?i!=+i:0==e?1/e==1/i:e==+i;case"[object Date]":case"[object Boolean]":return+e==+i;case"[object RegExp]":return e.source==i.source&&e.global==i.global&&e.multiline==i.multiline&&e.ignoreCase==i.ignoreCase}if("object"!=typeof e||"object"!=typeof i)return!1;for(var s=n.length;s--;)if(n[s]==e)return!0;n.push(e);var r=0,u=!0;if("[object Array]"==o){if(r=e.length,u=r==i.length)for(;r--&&(u=r in e==r in i&&t(e[r],i[r],n)););}else{if("constructor"in e!="constructor"in i||e.constructor!=i.constructor)return!1;for(var c in e)if(w.has(e,c)&&(r++,!(u=w.has(i,c)&&t(e[c],i[c],n))))break;if(u){for(c in i)if(w.has(i,c)&&!r--)break;u=!r}}return n.pop(),u}var e={},i=Array.prototype,n=Object.prototype,o=Function.prototype,s=i.slice,r=i.unshift,a=n.toString,u=n.hasOwnProperty,c=i.forEach,h=i.map,l=i.reduce,p=i.reduceRight,f=i.filter,d=i.every,g=i.some,m=i.indexOf,v=i.lastIndexOf,y=Array.isArray,_=Object.keys,b=o.bind,w=function(t){return new N(t)};w.VERSION="1.3.3";var S=w.each=w.forEach=function(t,i,n){if(null!=t)if(c&&t.forEach===c)t.forEach(i,n);else if(t.length===+t.length){for(var o=0,s=t.length;s>o;o++)if(o in t&&i.call(n,t[o],o,t)===e)return}else for(var r in t)if(w.has(t,r)&&i.call(n,t[r],r,t)===e)return};w.map=w.collect=function(t,e,i){var n=[];return null==t?n:h&&t.map===h?t.map(e,i):(S(t,function(t,o,s){n[n.length]=e.call(i,t,o,s)}),t.length===+t.length&&(n.length=t.length),n)},w.reduce=w.foldl=w.inject=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),l&&t.reduce===l)return n&&(e=w.bind(e,n)),o?t.reduce(e,i):t.reduce(e);if(S(t,function(t,s,r){o?i=e.call(n,i,t,s,r):(i=t,o=!0)}),!o)throw new TypeError("Reduce of empty array with no initial value");return i},w.reduceRight=w.foldr=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return n&&(e=w.bind(e,n)),o?t.reduceRight(e,i):t.reduceRight(e);var s=w.toArray(t).reverse();return n&&!o&&(e=w.bind(e,n)),o?w.reduce(s,e,i,n):w.reduce(s,e)},w.find=w.detect=function(t,e,i){var n;return x(t,function(t,o,s){return e.call(i,t,o,s)?(n=t,!0):void 0}),n},w.filter=w.select=function(t,e,i){var n=[];return null==t?n:f&&t.filter===f?t.filter(e,i):(S(t,function(t,o,s){e.call(i,t,o,s)&&(n[n.length]=t)}),n)},w.reject=function(t,e,i){var n=[];return null==t?n:(S(t,function(t,o,s){e.call(i,t,o,s)||(n[n.length]=t)}),n)},w.every=w.all=function(t,i,n){var o=!0;return null==t?o:d&&t.every===d?t.every(i,n):(S(t,function(t,s,r){return(o=o&&i.call(n,t,s,r))?void 0:e}),!!o)};var x=w.some=w.any=function(t,i,n){i||(i=w.identity);var o=!1;return null==t?o:g&&t.some===g?t.some(i,n):(S(t,function(t,s,r){return o||(o=i.call(n,t,s,r))?e:void 0}),!!o)};w.include=w.contains=function(t,e){var i=!1;return null==t?i:m&&t.indexOf===m?-1!=t.indexOf(e):i=x(t,function(t){return t===e})},w.invoke=function(t,e){var i=s.call(arguments,2);return w.map(t,function(t){return(w.isFunction(e)?e||t:t[e]).apply(t,i)})},w.pluck=function(t,e){return w.map(t,function(t){return t[e]})},w.max=function(t,e,i){if(!e&&w.isArray(t)&&t[0]===+t[0])return Math.max.apply(Math,t);if(!e&&w.isEmpty(t))return-1/0;var n={computed:-1/0};return S(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r>=n.computed&&(n={value:t,computed:r})}),n.value},w.min=function(t,e,i){if(!e&&w.isArray(t)&&t[0]===+t[0])return Math.min.apply(Math,t);if(!e&&w.isEmpty(t))return 1/0;var n={computed:1/0};return S(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r<n.computed&&(n={value:t,computed:r})}),n.value},w.shuffle=function(t){var e,i=[];return S(t,function(t,n){e=Math.floor(Math.random()*(n+1)),i[n]=i[e],i[e]=t}),i},w.sortBy=function(t,e,i){var n=w.isFunction(e)?e:function(t){return t[e]};return w.pluck(w.map(t,function(t,e,o){return{value:t,criteria:n.call(i,t,e,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;return void 0===i?1:void 0===n?-1:n>i?-1:i>n?1:0}),"value")},w.groupBy=function(t,e){var i={},n=w.isFunction(e)?e:function(t){return t[e]};return S(t,function(t,e){var o=n(t,e);(i[o]||(i[o]=[])).push(t)}),i},w.sortedIndex=function(t,e,i){i||(i=w.identity);for(var n=0,o=t.length;o>n;){var s=n+o>>1;i(t[s])<i(e)?n=s+1:o=s}return n},w.toArray=function(t){return t?w.isArray(t)?s.call(t):w.isArguments(t)?s.call(t):t.toArray&&w.isFunction(t.toArray)?t.toArray():w.values(t):[]},w.size=function(t){return w.isArray(t)?t.length:w.keys(t).length},w.first=w.head=w.take=function(t,e,i){return null==e||i?t[0]:s.call(t,0,e)},w.initial=function(t,e,i){return s.call(t,0,t.length-(null==e||i?1:e))},w.last=function(t,e,i){return null==e||i?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},w.rest=w.tail=function(t,e,i){return s.call(t,null==e||i?1:e)},w.compact=function(t){return w.filter(t,function(t){return!!t})},w.flatten=function(t,e){return w.reduce(t,function(t,i){return w.isArray(i)?t.concat(e?i:w.flatten(i)):(t[t.length]=i,t)},[])},w.without=function(t){return w.difference(t,s.call(arguments,1))},w.uniq=w.unique=function(t,e,i){var n=i?w.map(t,i):t,o=[];return t.length<3&&(e=!0),w.reduce(n,function(i,n,s){return(e?w.last(i)===n&&i.length:w.include(i,n))||(i.push(n),o.push(t[s])),i},[]),o},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(t){var e=s.call(arguments,1);return w.filter(w.uniq(t),function(t){return w.every(e,function(e){return w.indexOf(e,t)>=0})})},w.difference=function(t){var e=w.flatten(s.call(arguments,1),!0);return w.filter(t,function(t){return!w.include(e,t)})},w.zip=function(){for(var t=s.call(arguments),e=w.max(w.pluck(t,"length")),i=new Array(e),n=0;e>n;n++)i[n]=w.pluck(t,""+n);return i},w.indexOf=function(t,e,i){if(null==t)return-1;var n,o;if(i)return n=w.sortedIndex(t,e),t[n]===e?n:-1;if(m&&t.indexOf===m)return t.indexOf(e);for(n=0,o=t.length;o>n;n++)if(n in t&&t[n]===e)return n;return-1},w.lastIndexOf=function(t,e){if(null==t)return-1;if(v&&t.lastIndexOf===v)return t.lastIndexOf(e);for(var i=t.length;i--;)if(i in t&&t[i]===e)return i;return-1},w.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,s=new Array(n);n>o;)s[o++]=t,t+=i;return s};var O=function(){};w.bind=function(t,e){var i,n;if(t.bind===b&&b)return b.apply(t,s.call(arguments,1));if(!w.isFunction(t))throw new TypeError;return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(s.call(arguments)));O.prototype=t.prototype;var o=new O,r=t.apply(o,n.concat(s.call(arguments)));return Object(r)===r?r:o}},w.bindAll=function(t){var e=s.call(arguments,1);return 0==e.length&&(e=w.functions(t)),S(e,function(e){t[e]=w.bind(t[e],t)}),t},w.memoize=function(t,e){var i={};return e||(e=w.identity),function(){var n=e.apply(this,arguments);return w.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},w.delay=function(t,e){var i=s.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},w.defer=function(t){return w.delay.apply(w,[t,1].concat(s.call(arguments,1)))},w.throttle=function(t,e){var i,n,o,s,r,a,u=w.debounce(function(){r=s=!1},e);return function(){i=this,n=arguments;var c=function(){o=null,r&&t.apply(i,n),u()};return o||(o=setTimeout(c,e)),s?r=!0:a=t.apply(i,n),u(),s=!0,a}},w.debounce=function(t,e,i){var n;return function(){var o=this,s=arguments,r=function(){n=null,i||t.apply(o,s)};i&&!n&&t.apply(o,s),clearTimeout(n),n=setTimeout(r,e)}},w.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments))}},w.wrap=function(t,e){return function(){var i=[t].concat(s.call(arguments,0));return e.apply(this,i)}},w.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},w.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},w.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)w.has(t,i)&&(e[e.length]=i);return e},w.values=function(t){return w.map(t,w.identity)},w.functions=w.methods=function(t){var e=[];for(var i in t)w.isFunction(t[i])&&e.push(i);return e.sort()},w.extend=function(t){return S(s.call(arguments,1),function(e){for(var i in e)t[i]=e[i]}),t},w.pick=function(t){var e={};return S(w.flatten(s.call(arguments,1)),function(i){i in t&&(e[i]=t[i])}),e},w.defaults=function(t){return S(s.call(arguments,1),function(e){for(var i in e)null==t[i]&&(t[i]=e[i])}),t},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isEqual=function(e,i){return t(e,i,[])},w.isEmpty=function(t){if(null==t)return!0;if(w.isArray(t)||w.isString(t))return 0===t.length;for(var e in t)if(w.has(t,e))return!1;return!0},w.isElement=function(t){return!(!t||1!=t.nodeType)},w.isArray=y||function(t){return"[object Array]"==a.call(t)},w.isObject=function(t){return t===Object(t)},w.isArguments=function(t){return"[object Arguments]"==a.call(t)},w.isArguments(arguments)||(w.isArguments=function(t){return!(!t||!w.has(t,"callee"))}),w.isFunction=function(t){return"[object Function]"==a.call(t)},w.isString=function(t){return"[object String]"==a.call(t)},w.isNumber=function(t){return"[object Number]"==a.call(t)},w.isFinite=function(t){return w.isNumber(t)&&isFinite(t)},w.isNaN=function(t){return t!==t},w.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==a.call(t)},w.isDate=function(t){return"[object Date]"==a.call(t)},w.isRegExp=function(t){return"[object RegExp]"==a.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return u.call(t,e)},w.noConflict=function(){return root._=previousUnderscore,this},w.identity=function(t){return t},w.times=function(t,e,i){for(var n=0;t>n;n++)e.call(i,n)},w.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(t,e){if(null==t)return null;var i=t[e];return w.isFunction(i)?i.call(t):i},w.mixin=function(t){S(w.functions(t),function(e){L(e,w[e]=t[e])})};var T=0;w.uniqueId=function(t){var e=T++;return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,I={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var C in I)I[I[C]]=C;var k=/\\|'|\r|\n|\t|\u2028|\u2029/g,M=/\\(\\|'|r|n|t|u2028|u2029)/g,P=function(t){return t.replace(M,function(t,e){return I[e]})};w.template=function(t,e,i){i=w.defaults(i||{},w.templateSettings);var n="__p+='"+t.replace(k,function(t){return"\\"+I[t]}).replace(i.escape||E,function(t,e){return"'+\n_.escape("+P(e)+")+\n'"}).replace(i.interpolate||E,function(t,e){return"'+\n("+P(e)+")+\n'"}).replace(i.evaluate||E,function(t,e){return"';\n"+P(e)+"\n;__p+='"})+"';\n";i.variable||(n="with(obj||{}){\n"+n+"}\n"),n="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+n+"return __p;\n";var o=new Function(i.variable||"obj","_",n);if(e)return o(e,w);var s=function(t){return o.call(this,t,w)};return s.source="function("+(i.variable||"obj")+"){\n"+n+"}",s},w.chain=function(t){return w(t).chain()};var N=function(t){this._wrapped=t};w.prototype=N.prototype;var A=function(t,e){return e?w(t).chain():t},L=function(t,e){N.prototype[t]=function(){var t=s.call(arguments);return r.call(t,this._wrapped),A(e.apply(w,t),this._chain)}};return w.mixin(w),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];N.prototype[t]=function(){var i=this._wrapped;e.apply(i,arguments);var n=i.length;return"shift"!=t&&"splice"!=t||0!==n||delete i[0],A(i,this._chain)}}),S(["concat","join","slice"],function(t){var e=i[t];N.prototype[t]=function(){return A(e.apply(this._wrapped,arguments),this._chain)}}),N.prototype.chain=function(){return this._chain=!0,this},N.prototype.value=function(){return this._wrapped},w}),define("hbs/i18nprecompile",["hbs/handlebars","hbs/underscore"],function(t,e){function i(n,o,s){return s=s||{},o=o||{},n&&"program"===n.type&&n.statements&&(e(n.statements).forEach(function(e,r){var a="<!-- i18n error -->";if("mustache"===e.type&&e.id&&"$"===e.id.original){if(e.params.length&&e.params[0].string){var u=e.params[0].string;a=o[u]||(s.originalKeyFallback?u:a)}n.statements[r]=new t.AST.ContentNode(a)}else e.program&&(e.program=i(e.program,o,s))}),n.inverse&&i(n.inverse,o,s)),n}return function(e,n,o){o=o||{};var s,r;return s=t.parse(e),n!==!1&&(s=i(s,n,o)),r=(new t.Compiler).compile(s,o),(new t.JavaScriptCompiler).compile(r,o)}}),function(window){var JSON=window.JSON||{};!function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,o,s,r,a=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(u)){for(s=u.length,i=0;s>i;i+=1)r[i]=str(i,u)||"null";return o=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+a+"]":"["+r.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;s>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],o=str(n,u),o&&r.push(quote(n)+(gap?": ":":")+o));
else for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(o=str(n,u),o&&r.push(quote(n)+(gap?": ":":")+o));return o=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+a+"}":"{"+r.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,n,o=t[e];if(o&&"object"==typeof o)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n=walk(o,i),void 0!==n?o[i]=n:delete o[i]);return reviver.call(t,e,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",["hbs/handlebars","hbs/underscore","hbs/i18nprecompile","hbs/json2"],function(t,e,i,n){var o,s,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=function(){throw new Error("Environment unsupported.")},u=[],c="w+",h="hbs",l="@hbs",p="/styles/",f="/demo-build/styles/",d="templates/helpers/",g="templates/i18n/",m="screen.build.css",v="onHbsRead";t.registerHelper("$",function(){}),"undefined"!=typeof window&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(s=function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return arguments[0]===!0?new XDomainRequest:new XMLHttpRequest;for(e=0;3>e;e++){i=r[e];try{t=new ActiveXObject(i)}catch(n){}if(t){r=[i];break}}if(!t)throw new Error("getXhr(): XMLHttpRequest not available");return t},getIEVersion=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(e)&&(t=parseFloat(RegExp.$1))}return t},a=function(t,e){var i=!1;if(0!=t.indexOf("http"))i=!1;else{var n="https"===t.substr(0,5)?8:7,o="https"===window.location.href.substr(0,5)?8:7,r=t.substr(n).split("/").shift(),a=getIEVersion();i=r!=window.location.href.substr(o).split("/").shift()&&a>=7}if(i){var u=s(!0);u.open("GET",t),u.onload=function(){e(u.responseText,t)},u.onprogress=function(){},u.ontimeout=function(){},u.onerror=function(){},setTimeout(function(){u.send()},0)}else{var c=s();c.open("GET",t,!0),c.onreadystatechange=function(){4===c.readyState&&e(c.responseText,t)},c.send(null)}}):"undefined"!=typeof process&&process.versions&&process.versions.node?(o=require.nodeRequire("fs"),a=function(t,e){var i=o.readFileSync(t,"utf8")||"";i=i.replace(/^\uFEFF/,""),e(i,t)}):"undefined"!=typeof java&&"undefined"!=typeof java.io&&(a=function(t,e){for(var i,n=new java.io.FileInputStream(t),o=new java.io.InputStreamReader(n,"UTF-8"),s=new java.io.BufferedReader(o),r="";null!==(i=s.readLine());)r+=new String(i)+"\n";s.close(),e(r,t)});var y={},_=function(t,e){y[t]?e(y[t]):a(t,function(t,i){y[i]=t,e.call(this,t)})},b=[],w={};return{get:function(){return t},write:function(t,e,i){if(e+l in u){var n=u[e+l];i.asModule(t+"!"+e,n)}},version:"0.5.0",load:function(s,r,y,S){function x(t,i){return e(t).forEach(function(t){t&&t.type&&"partial"===t.type&&i.push(t.partialName.name),t&&t.program&&t.program.statements&&x(t.program.statements,i),t&&t.program&&t.program.inverse&&t.program.inverse.statements&&x(t.program.inverse.statements,i)}),i}function O(t){var i=[];return t&&t.statements&&(i=x(t.statements,[])),e(i).unique()}function T(t){var e,i,o;if(t&&t.statements&&(e=t.statements[0],e&&"comment"===e.type))try{return i=e.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),o=n.parse(i),i}catch(s){return n.stringify({description:i})}return"{}"}function E(t){if(!t)return[];var e,i=[t[0]],n=t[0];for(e=1;e<t.length;++e)t.hasOwnProperty(e)&&(n+="."+t[e],i.push(n));return i}function I(i,n,o,s){o=o?o+".":"";var r="";return e(i).forEach(function(i){var a,u,c;if(i&&i.type&&"mustache"===i.type){if(!i.params||!i.params.length){a=E(i.id.parts);for(u in a)a[u]&&(r=a[u]||r,n.push(o+a[u]));n.push(o+i.id.string)}var h=["this",".","..","./..","../..","../../.."];i.params&&"undefined"==typeof t.helpers[i.id.string]&&e(i.params).forEach(function(u){(e(h).contains(u.original)||u instanceof t.AST.StringNode||u instanceof t.AST.IntegerNode||u instanceof t.AST.BooleanNode)&&s.push(i.id.string),a=E(u.parts);for(var c in a)a[c]&&(r=a[c]||r,s.push(i.id.string),n.push(o+a[c]))})}i&&i.mustache&&I([i.mustache],n,o+r,s),i&&i.program&&i.program.statements&&(c=I([i.mustache],[],"",s)[0]||"",i.program.inverse&&i.program.inverse.statements&&I(i.program.inverse.statements,n,o+r+(c?o+r?"."+c:c:""),s),I(i.program.statements,n,o+r+(c?o+r?"."+c:c:""),s))}),n}function C(t){var i=[],n=[];t&&t.statements&&(i=I(t.statements,[],void 0,n));var o=["helperMissing","blockHelperMissing","each","if","unless","with"];return{vars:e(i).chain().unique().map(function(t){return""===t?".":t.length&&"."===t[t.length-1]?t.substr(0,t.length-1)+"[]":t}).value(),helpers:e(n).chain().unique().map(function(t){return e(o).contains(t)?void 0:t}).compact().value()}}function k(t){for(var e=t.split("/"),i=0;i<e.length;i++)".."==e[i]&&(delete e[i-1],delete e[i]);return e.join("/").replace(/\/\/+/g,"/")}function M(h){a(z,function(a,l){var g,_,x,E,I,M=S.isBuild&&S[v]?S[v]:function(t,e,i){return i},z=t.parse(M(s,l,a)),D=O(z),F=T(z),H=C(z),V=H.vars,j=H.helpers||[],R="",q="",B="",G=[],U=s.substr(0,s.lastIndexOf("/")+1);if(require.config.hbs=require.config.hbs||{},require.config.hbs._partials=require.config.hbs._partials||{},"{}"!==F)try{x=n.parse(F)}catch($){console.log("couldn't parse meta for %s",l)}for(var X in D)if(D.hasOwnProperty(X)&&"string"==typeof D[X]){var l,Y=D[X];l=k(Y.match(/^(\.|\/)+/)?U+Y:L+Y),require.config.hbs._partials[l]=require.config.hbs._partials[l]||[],require.config.hbs._partials[l].references=require.config.hbs._partials[l].references||[],require.config.hbs._partials[l].references.push(Y),require.config.hbs._loadedDeps=require.config.hbs._loadedDeps||{},G[X]="hbs!"+l}if(g=G.join("', '"),j=j.concat(x&&x.helpers?x.helpers:[]),_=A?"":function(){var t,e=[],i=S.hbs&&S.hbs.helperPathCallback?S.hbs.helperPathCallback:function(t){return(S.hbs&&S.hbs.helperDirectory?S.hbs.helperDirectory:d)+t};for(t=0;t<j.length;t++)e[t]="'"+i(j[t],l)+"'";return e}().join(","),_&&(_=","+_),x)try{x.styles&&(b=e.union(b,x.styles),require.isBrowser&&!S.isBuild?(E=document.head||document.getElementsByTagName("head")[0],e(x.styles).forEach(function(t){w[t]||(I=document.createElement("link"),I.href=S.baseUrl+p+t+".css",I.media="all",I.rel="stylesheet",I.type="text/css",E.appendChild(I),w[t]=I)})):S.isBuild&&!function(){var t=require.nodeRequire("fs"),i=e(x.styles).map(function(t){return w[t]?"":(w[t]=!0,"@import url("+t+".css);\n")}).join("\n");t.open(__dirname+f+m,c,"0666",function(e,n){t.writeSync(n,i,null,encoding="utf8"),t.close(n)}),c="a"}())}catch($){console.log("error injecting styles")}S.isBuild||S.serverRender||(R="<!-- START - "+s+" -->",q="<!-- END - "+s+" -->",B="t.meta = "+F+";\nt.helpers = "+n.stringify(j)+";\nt.deps = "+n.stringify(G)+";\nt.vars = "+n.stringify(V)+";\n");var W=N?!1:e.extend(h,S.localeMapping),Q=S.hbs||{},J=e.extend(Q.compileOptions||{},{originalKeyFallback:Q.originalKeyFallback}),Z=i(a,W,J),K=S.isBuild?"":"'"+s+"',";g&&(g=", '"+g+"'");var te=[];require.config.hbs._partials[s]&&(te=require.config.hbs._partials[s].references),a="/* START_TEMPLATE */\ndefine("+K+"['hbs','hbs/handlebars'"+g+_+"], function( hbs, Handlebars ){ \nvar t = Handlebars.template("+Z+");\nHandlebars.registerPartial('"+s+"', t);\n";for(var X=0;X<te.length;X++)a+="Handlebars.registerPartial('"+te[X]+"', t);\n";a+=B+"return t;\n});\n/* END_TEMPLATE */\n",S.isBuild&&(u[P]=a),S.isBuild||(a+="\r\n//@ sourceURL="+l),S.isBuild?(y.fromText(s,a),r([s],function(t){y(t)})):require(G,function(){y.fromText(a),r([s],function(t){y(t)})}),S.removeCombined&&l&&o.unlinkSync(l)})}var P=s+l;S.hbs=S.hbs||{};var N=!(1==S.hbs.i18n),A=0==S.hbs.helpers,L="";S.hbs.partialsUrl&&(L=S.hbs.partialsUrl,L.match(/\/$/)||(L+="/"));var z,D=S.hbs&&S.hbs.templateExtension===!1;if(z=r.toUrl(D?s:s+"."+(S.hbs&&S.hbs.templateExtension?S.hbs.templateExtension:h)),N)M(!1);else{var F=(S.hbs&&S.hbs.i18nDirectory?S.hbs.i18nDirectory:g)+(S.locale||"en_us")+".json";try{_(r.toUrl(F),function(t){M(n.parse(t))})}catch(H){if(S.hbs)throw H;console.warn("hbs: Error reading "+F+", disabling i18n. Ignore this if you're using jam, otherwise check your i18n configuration.\n"),S.hbs={i18n:!1,helpers:!0},M(!1)}}}}}),define("hbs!templates/btn",["hbs","hbs/handlebars"],function(t,e){var i=e.template(function(t,e,i){this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers);var n,o,s="",r="function",a=this.escapeExpression;return s+='<button class="btn ',(o=i.classes)?n=o.call(e,{hash:{}}):(o=e&&e.classes,n=typeof o===r?o.call(e,{hash:{}}):o),s+=a(n)+'">',(o=i.label)?n=o.call(e,{hash:{}}):(o=e&&e.label,n=typeof o===r?o.call(e,{hash:{}}):o),s+=a(n)+"</button>"});return e.registerPartial("templates/btn",i),i}),define("views/BoardMenuView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","controllers/GameController","hbs!templates/btn"],function(t,e,i){function n(){this.resumeBtn.on("click",function(){this._eventOutput.emit("game:closeMenu")}.bind(this)),this.quitBtn.on("click",function(){this._eventOutput.emit("game:quit")}.bind(this))}function o(){c.apply(this,arguments),this._controller=new f,this.rootMod=new p({align:[.5,0],origin:[.5,0],size:[void 0,this.options.height],transform:l.translate(0,-this.options.height,0)}),this._buttons=[],this.node=this.add(this.rootMod),s.call(this),r.call(this),a.call(this),n.call(this),this.update()}function s(){this.backing=new h({classes:["gamemenu","gamemenu-backing"],properties:{backgroundColor:"white"}}),this.node.add(this.backing)}function r(){this.desc=new h({classes:["gamemenu","gamemenu-description"]});var t=new p({align:[.5,0],origin:[.5,0],size:[void 0,30],transform:l.translate(0,20,1)});this.desc._mod=t,this.node.add(t).add(this.desc)}function a(){var t=[{label:"Resume",classes:["btn-resume"]},{label:"Quit",classes:["btn-quit"]}],e=new p({size:[void 0,60*t.length],origin:[.5,1],align:[.5,1],transform:l.translate(0,-20,1)});this.buttonsNode=this.node.add(e);for(var i=0;i<t.length;i++)u.call(this,i,t[i])}function u(t,e){var i,n=e.label||"",o=50;i=Array.isArray(e.classes)?e.classes.join(" "):e.classes;var s=d({label:n,classes:i}),r=new h({content:s,classes:["gamemenu","gamemenu-buttons"]}),a=n.toLowerCase()+"Btn";this[a]=r;var u=new p({align:[.5,0],origin:[.5,0],size:[200,o],transform:l.translate(0,t*(o+10),1)});this[a]._mod=u,this._buttons.push(r),this.buttonsNode.add(u).add(r)}var c=t("famous/core/View"),h=t("famous/core/Surface"),l=t("famous/core/Transform"),p=t("famous/modifiers/StateModifier"),f=t("controllers/GameController"),d=t("hbs!templates/btn");o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={height:100,description:""},o.prototype.update=function(){this._controller.getOptions();this.setOptions({description:this._controller.getDescription()}),this.desc.setContent(this.options.description)},i.exports=o}),define("famous/transitions/Easing",["require","exports","module"],function(t,e,i){var n={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},outElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},inOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2===(t/=.5)?1:(i||(i=.3*1.5),e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-n.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*n.inBounce(2*t):.5*n.outBounce(2*t-1)+.5}};i.exports=n}),define("views/GameHeaderView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/transitions/Easing","famous/modifiers/StateModifier","controllers/PieceController","controllers/GameController"],function(t,e,i){function n(){this._pieceController._eventOutput.on("piece:colorsUpdated",function(){this.updateColors()}.bind(this)),this.menuButton.on("click",function(){this._eventOutput.emit("game:toggleMenu",m),m=!m}.bind(this)),this._eventInput.on("game:closeMenu",function(){m=!0})}function o(){c.apply(this,arguments),this.rootMod=new f({origin:[.5,0],align:[.5,0],transform:l.translate(0,0,200)}),this._pieceController=new d,this._gameController=new g,this.upcomingColors=[],this.node=this.add(this.rootMod),s.call(this),r.call(this),a.call(this),n.call(this)}function s(){this.backing=new h({classes:["header","navbar","game-navbar"]});var t=new f({transform:l.behind});this.node.add(t).add(this.backing)}function r(){this.menuButton=new h({size:[!0,!0],classes:["header","navbar","game-navbar","game-navbar-button"],content:'<i class="fa fa-2x fa-angle-double-up"></i>'});var t=new f({origin:[1,.5],align:[1,.5],transform:l.translate(-10,0,1)});this.node.add(t).add(this.menuButton)}function a(){for(var t=this._gameController.getCurrentLevel(),e=new f({size:[70,20],origin:[0,.5],align:[0,.5],transform:l.translate(10,0,1)}),i=this.node.add(e),n=0;4>n;n++){var o,s={},r=this.options.pieceSize[0],a=new f({origin:[0,.5],align:[0,.5],transform:l.translate(n*(r+5),0,1)});3>n&&(o=u.call(this,n,t.stage,t.level));var c=new h({size:this.options.pieceSize,properties:s,classes:o});c._modifier=a,this.upcomingColors.push(c),i.add(a).add(c)}}function u(t,e,i){return["piece","piece-mini","stage-"+e,"level-"+i,this._pieceController.colorQueue[t]]}var c=t("famous/core/View"),h=t("famous/core/Surface"),l=t("famous/core/Transform"),p=t("famous/transitions/Easing"),f=t("famous/modifiers/StateModifier"),d=t("controllers/PieceController"),g=t("controllers/GameController"),m=!0;o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.prototype.updateColors=function(){function t(){this._modifier.setTransform(l.translate(90,0,0))}var e=this._gameController.getCurrentLevel(),i=this.options.pieceSize[0],n={curve:p.inExpo,duration:300},o=this.upcomingColors[0],s=this.upcomingColors[3];s.setClasses(u.call(this,2,e.stage,e.level)),o._modifier.setOpacity(.001,n),s._modifier.setOpacity(.999,{curve:"easeOut",duration:1e3});for(var r=0;r<this.upcomingColors.length;r++){var a=this.upcomingColors[r],c=l.translate((r-1)*(i+5),0,0);0===r?a._modifier.setTransform(c,n,t.bind(a)):a._modifier.setTransform(c,n)}o=this.upcomingColors.shift(),this.upcomingColors.push(o)},o.DEFAULT_OPTIONS={pieceSize:[20,20]},i.exports=o}),define("views/GameView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/views/HeaderFooterLayout","famous/utilities/Timer","famous/core/RenderNode","utils","views/BoardView","views/BoardMenuView","views/GameHeaderView","controllers/GameController","hbs!templates/btn"],function(t,e,i){function n(){function t(){var t=w.translate(0,0,1),i=w.translate(0,-A,1);this.layoutMod.setTransform(t,e),this.boardMenuView.rootMod.setTransform(i,e),this.boardView.show()}var e={curve:"linear",duration:300};this.boardView.pipe(this.gameHeaderView),this.boardView.pipe(this._eventInput),this.gameHeaderView.on("game:toggleMenu",function(i){if(i){var n=w.translate(0,A,1),o=w.translate(0,0,1);this.layoutMod.setTransform(n,e),this.boardMenuView.rootMod.setTransform(o,e),this.boardView.dim()}else t.call(this)}.bind(this)),this.boardMenuView.on("game:closeMenu",function(){t.call(this),this.gameHeaderView._eventInput.emit("game:closeMenu")}.bind(this)),this.boardMenuView.on("game:quit",function(){this._eventOutput.emit("stages"===this._fromPage?"nav:loadStages":"nav:loadHome"),this.gameHeaderView._eventInput.emit("game:closeMenu"),O.setTimeout(function(){t.call(this)}.bind(this),600)}.bind(this)),this._eventInput.on("game:load",function(t){this._fromPage=t.fromPage,this._controller.isSameGame(t)||(this._controller.newGame({level:t.level,stage:t.stage}),o.call(this))}.bind(this)),this.boardView._eventOutput.on("game:won",function(t){f.call(this,"won",t),this._controller.unlockNextLevel()}.bind(this)),this.boardView._eventOutput.on("game:lost",function(t){f.call(this,"lost",t)}.bind(this)),this._eventInput.on("game:doneBtnClicked",function(t){var e=t.action;"next"===e||"quit"===e?(p.call(this,300,function(){this._eventOutput.emit("nav:loadStages")}.bind(this)),O.setTimeout(function(){this._controller.resetGame()}.bind(this),1500)):("replay"===e||"restart"===e)&&(this._controller.resetGame(),p.call(this))}.bind(this))}function o(){this.boardMenuView.update(),this.boardView.update()}function s(){_.apply(this,arguments),this._fromPage="home",this._controller=new M,this.gameHeaderView=new k,a.call(this),u.call(this),c.call(this),r.call(this),n.call(this)}function r(){this.layout=new x({headerSize:this.options.headerSize}),this.layoutMod=new S({transform:w.translate(0,0,0)}),this.layout.header.add(this.gameHeaderView),this.layout.content.add(this.boardView),this.add(this.layoutMod).add(this.layout)}function a(){this.boardView=new I({rows:this._controller.getRows(),columns:this._controller.getCols(),startIndex:this._controller.getStartIndex(),viewHeight:E.getViewportHeight()-this.options.headerSize-2*this.options.borderWidth[1],viewWidth:E.getViewportWidth()-2*this.options.borderWidth[0]})}function u(){this.boardMenuView=new C({height:A}),this.add(this.boardMenuView)}function c(){var t=new T,e=h.call(this),i=new b({properties:{borderRadius:"999em"}}),n=new S({size:[!0,!0],origin:[0,0],align:[0,0]}),o=new S({size:[5,5],origin:[.5,.5],align:[.5,.5],transform:w.translate(0,0,-1),opacity:.001});t=t.add(n),t.add(o).add(i),this._doneNode=t,this._doneNode.msg=e,this._doneNode._backing=i,this._doneNode._posMod=n,this._doneNode._backingMod=o,this.add(this._doneNode),this.add(e)}function h(){var t=new T,e=l.call(this,2),i=new b,n=new b,o=new S({size:[250,150],origin:[.5,.5],align:[.5,.5]}),s=new S,r=new S({size:[190,30],origin:[.5,0],align:[.5,0]});t=t.add(o),t._mod=o,t._surface=n,t._backing=i,t.buttons=e,i._mod=s,n._mod=r,t.add(s).add(i),t.add(r).add(n);for(var a=0;a<e.length;a++)t.add(e[a]);return t}function l(t){function e(t){this._eventInput.emit("game:doneBtnClicked",t)}t=t||0===t?t:2;for(var i=50,n=10,o=[],s=["game","level-done","btn"],r=0;t>r;r++){var a=new T,u=new b({classes:s}),c=new S({size:[190,i],origin:[.5,1],align:[.5,1],transform:w.translate(0,-r*(i+n),1)});a._mod=c,a._surface=u,a.add(c).add(u),o.push(a),a._surface.on("click",e.bind(this,a))}return o}function p(t,e){var i=t||1e3;m.call(this,i),this._doneNode._backingMod.setSize([5,5],{duration:i}),this._doneNode._backingMod.setOpacity(.001,{duration:i},function(){this._doneNode._backingMod.setTransform(w.translate(0,0,-1)),e&&e()}.bind(this))}function f(t,e){var i=e.piece,n=i._piece.getOption("backBgColor"),o=this._controller.getCurrentLevel(),s=d.call(this,i),r=w.thenMove(w.translate(0,0,500),s);this._doneNode._posMod.setTransform(r),this._doneNode._backing.setClasses(["stage-"+o.stage,n,"piece","level-done","backing"]);var a=600,u=this._doneNode._backingMod;u.setOpacity(.8,{duration:a/2}),u.setSize([1.5*N,1.5*N],{duration:a},function(){g.call(this,t,300)}.bind(this))}function d(t){var e=t._piece.getOption("width"),i=t._piece.getOption("height"),n=t._piece.reflectionMod.getOrigin(),o=t._piece.reflector.backNode._matrix;return.5===n[0]?o=0===n[1]?w.thenMove(o,[-e/2,-i,1]):w.thenMove(o,[-e/2,0,1]):.5===n[1]&&(o=0===n[0]?w.thenMove(o,[-e,-i/2,1]):w.thenMove(o,[0,-i/2,1])),o=w.thenMove(o,[e/2,i/2,1]),w.getTranslate(o)}function g(t,e){e=e||0===e?e:300;var i=E.getRandomArrayItem(L[t]);v.call(this,i,[t]),y.call(this,t);var n=this._doneNode.msg;n._mod.setOpacity(.999,{duration:e}),n._mod.setTransform(w.translate(0,0,750));for(var o=0;o<n.buttons.length;o++){var s=n.buttons[o];s._mod.setOpacity(.999,{duration:e})}}function m(t){var e=this._doneNode.msg;e._mod.setOpacity(.001,{duration:t},function(){e._mod.setTransform(w.translate(0,0,-1))}.bind(this));for(var i=0;i<e.buttons.length;i++){var n=e.buttons[i];n._mod.setOpacity(.001,{duration:t})}}function v(t,e){var i,n,o=this._doneNode.msg,s=["game","level-done","message","backing"],r=["game","level-done","message","content"];e?(i=r.concat(e),n=s.concat(e)):(i=r,n=s),o._surface.setContent(t),o._surface.setClasses(i),o._backing.setClasses(n)}function y(t){var e,i=this._doneNode.msg.buttons;e="won"===t?[{label:"replay",classes:["btn-replay"]},{label:"next",classes:["btn-next"]}]:[{label:"restart",classes:["btn-restart"]},{label:"quit",classes:["btn-quit"]}];for(var n=0;n<i.length;n++){var o=i[n],s=o._surface,r=e[n],a=P({label:r.label,classes:r.classes});s.setContent(a),o.action=r.label}}var _=t("famous/core/View"),b=t("famous/core/Surface"),w=t("famous/core/Transform"),S=t("famous/modifiers/StateModifier"),x=t("famous/views/HeaderFooterLayout"),O=t("famous/utilities/Timer"),T=t("famous/core/RenderNode"),E=t("utils"),I=t("views/BoardView"),C=t("views/BoardMenuView"),k=t("views/GameHeaderView"),M=t("controllers/GameController"),P=t("hbs!templates/btn"),N=E.getViewportHeight(),A=220,L={won:["Level Completed"],lost:["Better luck next time"]};s.prototype=Object.create(_.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={headerSize:44,borderWidth:[5,5]},i.exports=s}),define("views/BackgroundView",["require","exports","module","famous/core/View","famous/core/Surface","famous/modifiers/StateModifier","famous/utilities/Timer"],function(t,e,i){function n(){a.apply(this,arguments),this._modifiers=[];var t=new c({origin:[0,0],align:[0,0]});this.node=this.add(t),o.call(this),s.call(this),r.call(this)}function o(){var t=new u({classes:["splash","splash-backing"],properties:{zIndex:1}}),e=new c({opacity:.001});this._modifiers.push(e),this.node.add(e).add(t)}function s(){var t=new u({classes:["splash","splash-pattern","splash-pattern-1"],properties:{zIndex:2}}),e=new c({opacity:.001});this._modifiers.push(e),this.node.add(e).add(t)}function r(){var t=new u({classes:["splash","splash-pattern","splash-pattern-2"],properties:{zIndex:3}}),e=new c({opacity:.001});this._modifiers.push(e),this.node.add(e).add(t)}var a=t("famous/core/View"),u=t("famous/core/Surface"),c=t("famous/modifiers/StateModifier"),h=t("famous/utilities/Timer");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},n.prototype.show=function(t,e,i){function n(e){e.setOpacity(.999,t)}var o={curve:"easeIn",duration:300};t=t||o,e=e||0===e?e:300;for(var s=0;s<this._modifiers.length;s++){var r=this._modifiers[s];h.setTimeout(n.bind(this,r),s*e)}h.setTimeout(function(){i&&i()}.bind(this),e*(this._modifiers.length-1))},n.prototype.hide=function(t,e,i){function n(e){e.setOpacity(.001,t)}var o={curve:"easeIn",duration:0};t=t||o,e=e||0===e?e:0;for(var s=0;s<this._modifiers.length;s++){var r=this._modifiers[s];h.setTimeout(n.bind(this,r),s*e)}h.setTimeout(function(){i&&i()}.bind(this),e*(this._modifiers.length-1))},i.exports=n}),define("famous/physics/PhysicsEngine",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._particles=[],this._bodies=[],this._agents={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=x(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1}function o(t){return t.applyForce?this._forces:t.applyConstraint?this._constraints:void 0}function s(t,e,i){return void 0===e&&(e=this.getParticlesAndBodies()),e instanceof Array||(e=[e]),this._agents[this._currAgentId]={agent:t,targets:e,source:i},o.call(this,t).push(this._currAgentId),this._currAgentId++}function r(t){return this._agents[t]}function a(t){var e=r.call(this,this._forces[t]);e.agent.applyForce(e.targets,e.source)}function u(){for(var t=this._forces.length-1;t>-1;t--)a.call(this,t)}function c(t,e){var i=this._agents[this._constraints[t]];return i.agent.applyConstraint(i.targets,i.source,e)}function h(t){for(var e=0;e<this.options.constraintSteps;){for(var i=this._constraints.length-1;i>-1;i--)c.call(this,i,t);e++}}function l(t,e){t.integrateVelocity(e)}function p(t,e){t.integrateAngularMomentum(e),t.updateAngularVelocity()}function f(t,e){t.integrateOrientation(e)}function d(t,e){t.integratePosition(e),t.emit("update",t)}function g(t){u.call(this,t),this.forEach(l,t),this.forEachBody(p,t),h.call(this,t),this.forEachBody(f,t),this.forEach(d,t)}function m(){var t=0,e=0;return this.forEach(function(i){e=i.getEnergy(),t+=e,e<i.sleepTolerance&&i.sleep()}),t}function v(){for(var t=0,e=this._forces.length-1;e>-1;e--)t+=this._forces[e].getEnergy()||0;return t}function y(){for(var t=0,e=this._constraints.length-1;e>-1;e--)t+=this._constraints[e].getEnergy()||0;return t}var _=t("famous/core/EventHandler"),b=17,w=1e3/120,S=17;n.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7};var x=function(){return Date.now}();n.prototype.setOptions=function(t){for(var e in t)this.options[e]&&(this.options[e]=t[e])},n.prototype.addBody=function(t){return t._engine=this,t.isBody?(this._bodies.push(t),this._hasBodies=!0):this._particles.push(t),t},n.prototype.removeBody=function(t){var e=t.isBody?this._bodies:this._particles,i=e.indexOf(t);if(i>-1){for(var n=0;n<Object.keys(this._agents).length;n++)this.detachFrom(n,t);e.splice(i,1)}0===this.getBodies().length&&(this._hasBodies=!1)},n.prototype.attach=function(t,e,i){if(t instanceof Array){for(var n=[],o=0;o<t.length;o++)n[o]=s.call(this,t[o],e,i);return n}return s.call(this,t,e,i)},n.prototype.attachTo=function(t,e){r.call(this,t).targets.push(e)},n.prototype.detach=function(t){var e=this.getAgent(t),i=o.call(this,e),n=i.indexOf(t);i.splice(n,1),delete this._agents[t]},n.prototype.detachFrom=function(t,e){var i=r.call(this,t);if(i.source===e)this.detach(t);else{var n=i.targets,o=n.indexOf(e);o>-1&&n.splice(o,1)}},n.prototype.detachAll=function(){this._agents={},this._forces=[],this._constraints=[],this._currAgentId=0},n.prototype.getAgent=function(t){return r.call(this,t).agent},n.prototype.getParticles=function(){return this._particles},n.prototype.getBodies=function(){return this._bodies},n.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},n.prototype.forEachParticle=function(t,e){for(var i=this.getParticles(),n=0,o=i.length;o>n;n++)t.call(this,i[n],e)},n.prototype.forEachBody=function(t,e){if(this._hasBodies)for(var i=this.getBodies(),n=0,o=i.length;o>n;n++)t.call(this,i[n],e)},n.prototype.forEach=function(t,e){this.forEachParticle(t,e),this.forEachBody(t,e)},n.prototype.getEnergy=function(){return m.call(this)+v.call(this)+y.call(this)},n.prototype.step=function(){var t=x(),e=t-this._prevTime;this._prevTime=t,w>e||(e>S&&(e=S),g.call(this,b))},n.prototype.isSleeping=function(){return this._isSleeping},n.prototype.sleep=function(){this.emit("end",this),this._isSleeping=!0},n.prototype.wake=function(){this._prevTime=x(),this.emit("start",this),this._isSleeping=!1},n.prototype.emit=function(t,e){null!==this._eventHandler&&this._eventHandler.emit(t,e)},n.prototype.on=function(t,e){null===this._eventHandler&&(this._eventHandler=new _),this._eventHandler.on(t,e)},i.exports=n}),define("famous/math/Vector",["require","exports","module"],function(t,e,i){function n(t,e,i){return 1===arguments.length?this.set(t):(this.x=t||0,this.y=e||0,this.z=i||0),this}function o(t,e,i){return this.x=t,this.y=e,this.z=i,this}function s(t){return o.call(this,t[0],t[1],t[2]||0)}function r(t){return o.call(this,t.x,t.y,t.z)}function a(t){return o.call(this,t,0,0)}var u=new n(0,0,0);n.prototype.add=function(t){return o.call(u,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t){return o.call(u,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t){return o.call(u,t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t){return this.mult(1/t)},n.prototype.cross=function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z;return o.call(u,n*r-i*a,e*a-n*s,i*s-e*r)},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},n.prototype.rotateX=function(t){var e=this.x,i=this.y,n=this.z,s=Math.cos(t),r=Math.sin(t);return o.call(u,e,i*s-n*r,i*r+n*s)},n.prototype.rotateY=function(t){var e=this.x,i=this.y,n=this.z,s=Math.cos(t),r=Math.sin(t);return o.call(u,n*r+e*s,i,n*s-e*r)},n.prototype.rotateZ=function(t){var e=this.x,i=this.y,n=this.z,s=Math.cos(t),r=Math.sin(t);return o.call(u,e*s-i*r,e*r+i*s,n)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t){0===arguments.length&&(t=1);var e=this.norm();return e>1e-7?r.call(u,this.mult(t/e)):o.call(u,t,0,0)},n.prototype.clone=function(){return new n(this)},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.set=function(t){return t instanceof Array?s.call(this,t):t instanceof n?r.call(this,t):"number"==typeof t?a.call(this,t):void 0
},n.prototype.setXYZ=function(){return o.apply(this,arguments)},n.prototype.set1D=function(t){return a.call(this,t)},n.prototype.put=function(t){this===u?r.call(t,u):r.call(t,this)},n.prototype.clear=function(){return o.call(this,0,0,0)},n.prototype.cap=function c(c){if(1/0===c)return r.call(u,this);var t=this.norm();return t>c?r.call(u,this.mult(c/t)):r.call(u,this)},n.prototype.project=function(t){return t.mult(this.dot(t))},n.prototype.reflectAcross=function(t){return t.normalize().put(t),r(u,this.sub(this.project(t).mult(2)))},n.prototype.get=function(){return[this.x,this.y,this.z]},n.prototype.get1D=function(){return this.x},i.exports=n}),define("famous/physics/integrators/SymplecticEuler",["require","exports","module","famous/core/OptionsManager"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t)}var o=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={velocityCap:void 0,angularVelocityCap:void 0},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.integrateVelocity=function(t,e){var i=t.velocity,n=t.inverseMass,o=t.force;o.isZero()||(i.add(o.mult(e*n)).put(i),o.clear())},n.prototype.integratePosition=function(t,e){var i=t.position,n=t.velocity;this.options.velocityCap&&n.cap(this.options.velocityCap).put(n),i.add(n.mult(e)).put(i)},n.prototype.integrateAngularMomentum=function(t,e){var i=t.angularMomentum,n=t.torque;n.isZero()||(this.options.angularVelocityCap&&n.cap(this.options.angularVelocityCap).put(n),i.add(n.mult(e)).put(i),n.clear())},n.prototype.integrateOrientation=function(t,e){var i=t.orientation,n=t.angularVelocity;n.isZero()||i.add(i.multiply(n).scalarMultiply(.5*e)).put(i)},i.exports=n}),define("famous/physics/bodies/Particle",["require","exports","module","famous/math/Vector","famous/core/Transform","famous/core/EventHandler","../integrators/SymplecticEuler"],function(t,e,i){function n(t){t=t||{},this.position=new s,this.velocity=new s,this.force=new s;var e=n.DEFAULT_OPTIONS;this.setPosition(t.position||e.position),this.setVelocity(t.velocity||e.velocity),this.force.set(t.force||[0,0,0]),this.mass=void 0!==t.mass?t.mass:e.mass,this.axis=void 0!==t.axis?t.axis:e.axis,this.inverseMass=1/this.mass,this._isSleeping=!1,this._engine=null,this._eventOutput=null,this._positionGetter=null,this.transform=r.identity.slice(),this._spec={transform:this.transform,target:null}}function o(){this._eventOutput=new a,this._eventOutput.bindThis(this),a.setOutputHandler(this,this._eventOutput)}var s=t("famous/math/Vector"),r=t("famous/core/Transform"),a=t("famous/core/EventHandler"),u=t("../integrators/SymplecticEuler");n.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1,axis:void 0},n.SLEEP_TOLERANCE=1e-7,n.AXES={X:0,Y:1,Z:2},n.INTEGRATOR=new u;var c={start:"start",update:"update",end:"end"},h=function(){return Date.now}();n.prototype.sleep=function(){this._isSleeping||(this.emit(c.end,this),this._isSleeping=!0)},n.prototype.wake=function(){this._isSleeping&&(this.emit(c.start,this),this._isSleeping=!1,this._prevTime=h())},n.prototype.isBody=!1,n.prototype.setPosition=function(t){this.position.set(t)},n.prototype.setPosition1D=function(t){this.position.x=t},n.prototype.getPosition=function(){return this._positionGetter instanceof Function&&this.setPosition(this._positionGetter()),this._engine.step(),this.position.get()},n.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},n.prototype.positionFrom=function(t){this._positionGetter=t},n.prototype.setVelocity=function(t){this.velocity.set(t),this.wake()},n.prototype.setVelocity1D=function(t){this.velocity.x=t,this.wake()},n.prototype.getVelocity=function(){return this.velocity.get()},n.prototype.getVelocity1D=function(){return this.velocity.x},n.prototype.setMass=function(t){this.mass=t,this.inverseMass=1/t},n.prototype.getMass=function(){return this.mass},n.prototype.reset=function(t,e){this.setPosition(t||[0,0,0]),this.setVelocity(e||[0,0,0])},n.prototype.applyForce=function(t){t.isZero()||(this.force.add(t).put(this.force),this.wake())},n.prototype.applyImpulse=function(t){if(!t.isZero()){var e=this.velocity;e.add(t.mult(this.inverseMass)).put(e)}},n.prototype.integrateVelocity=function(t){n.INTEGRATOR.integrateVelocity(this,t)},n.prototype.integratePosition=function(t){n.INTEGRATOR.integratePosition(this,t)},n.prototype._integrate=function(t){this.integrateVelocity(t),this.integratePosition(t)},n.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},n.prototype.getTransform=function(){this._engine.step();var t=this.position,e=this.axis,i=this.transform;return void 0!==e&&(e&~n.AXES.X&&(t.x=0),e&~n.AXES.Y&&(t.y=0),e&~n.AXES.Z&&(t.z=0)),i[12]=t.x,i[13]=t.y,i[14]=t.z,i},n.prototype.modify=function(t){var e=this._spec;return e.transform=this.getTransform(),e.target=t,e},n.prototype.emit=function(t,e){this._eventOutput&&this._eventOutput.emit(t,e)},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return o.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous/physics/forces/Force",["require","exports","module","famous/math/Vector","famous/core/EventHandler"],function(t,e,i){function n(t){this.force=new s(t),this._energy=0,this._eventOutput=null}function o(){this._eventOutput=new r,this._eventOutput.bindThis(this),r.setOutputHandler(this,this._eventOutput)}var s=t("famous/math/Vector"),r=t("famous/core/EventHandler");n.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},n.prototype.applyForce=function(t){t.applyForce(this.force)},n.prototype.getEnergy=function(){return this._energy},n.prototype.setEnergy=function(t){this._energy=t},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.addListener=function(){return o.call(this),this.addListener.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.removeListener=function(){return this.removeListener.apply(this,arguments)},n.prototype.unpipe=function(){return this.unpipe.apply(this,arguments)},i.exports=n}),define("famous/physics/forces/Spring",["require","exports","module","./Force","famous/math/Vector"],function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new h(0,0,0),u.call(this),c.call(this)}function o(t){this.forceFunction=t}function s(){var t=this.options;t.stiffness=Math.pow(2*l/t.period,2)}function r(){var t=this.options;t.damping=4*l*t.dampingRatio/t.period}function a(t,e){return.5*t*e*e}function u(){o.call(this,this.options.forceFunction),s.call(this),r.call(this)}var c=t("./Force"),h=t("famous/math/Vector");n.prototype=Object.create(c.prototype),n.prototype.constructor=n;var l=Math.PI;n.FORCE_FUNCTIONS={FENE:function(t,e){var i=.99*e,n=Math.max(Math.min(t,i),-i);return n/(1-n*n/(e*e))},HOOK:function(t){return t}},n.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:n.FORCE_FUNCTIONS.HOOK},n.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof h&&(this.options.anchor=t.anchor.position),t.anchor instanceof h&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new h(t.anchor))),void 0!==t.period&&(this.options.period=t.period),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.options.length=t.length),void 0!==t.forceFunction&&(this.options.forceFunction=t.forceFunction),void 0!==t.maxLength&&(this.options.maxLength=t.maxLength),u.call(this)},n.prototype.applyForce=function(t,e){for(var i=this.force,n=this.disp,o=this.options,s=o.stiffness,r=o.damping,u=o.length,c=o.maxLength,h=o.anchor||e.position,l=0;l<t.length;l++){var p=t[l],f=p.position,d=p.velocity;h.sub(f).put(n);var g=n.norm()-u;if(0===g)return;var m=p.mass;s*=m,r*=m,n.normalize(s*this.forceFunction(g,c)).put(i),r&&(e?i.add(d.sub(e.velocity).mult(-r)).put(i):i.add(d.mult(-r)).put(i)),p.applyForce(i),e&&e.applyForce(i.mult(-1)),this.setEnergy(a(s,g))}},n.prototype.getEnergy=function(t){var e=this.options,i=e.length,n=e.anchor,o=e.stiffness,s=n.sub(t.position).norm()-i;return.5*o*s*s},n.prototype.setAnchor=function(t){this.options.anchor||(this.options.anchor=new h),this.options.anchor.set(t)},i.exports=n}),define("famous/transitions/SpringTransition",["require","exports","module","famous/physics/PhysicsEngine","famous/physics/bodies/Particle","famous/physics/forces/Spring","famous/math/Vector"],function(t,e,i){function n(t){t=t||0,this.endState=new _(t),this.initState=new _,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new m,this.spring=new y({anchor:this.endState}),this.particle=new v,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function o(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function s(t){this.particle.setPosition(t)}function r(t){this.particle.setVelocity(t)}function a(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function u(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function c(t){this._callback=t}function h(){this.PE.wake()}function l(){this.PE.sleep()}function p(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else o.call(this)<this._absRestTolerance&&(s.call(this,this.endState),r.call(this,[0,0,0]),l.call(this))}function f(t){var e=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),t.period<150&&(t.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),r.call(this,t.velocity)}function d(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function g(t){this.endState.set(t),d.call(this)}var m=t("famous/physics/PhysicsEngine"),v=t("famous/physics/bodies/Particle"),y=t("famous/physics/forces/Spring"),_=t("famous/math/Vector");n.SUPPORTS_MULTIPLE=3,n.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},n.prototype.reset=function(t,e){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),s.call(this,t),g.call(this,t),e&&r.call(this,e),c.call(this,void 0)},n.prototype.getVelocity=function(){return u.call(this)},n.prototype.setVelocity=function(t){this.call(this,r(t))},n.prototype.isActive=function(){return!this.PE.isSleeping()},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return p.call(this),a.call(this)},n.prototype.set=function(t,e,i){return e?(this._dimensions=t instanceof Array?t.length:0,h.call(this),f.call(this,e),g.call(this,t),void c.call(this,i)):(this.reset(t),void(i&&i()))},i.exports=n}),define("hbs!templates/homeBtn",["hbs","hbs/handlebars"],function(t,e){var i=e.template(function(t,e,i){this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers);var n,o,s="",r="function",a=this.escapeExpression;return s+='<button class="btn">\n  <span class="btn-label">',(o=i.label)?n=o.call(e,{hash:{}}):(o=e&&e.label,n=typeof o===r?o.call(e,{hash:{}}):o),s+=a(n)+"</span>\n</button>"});return e.registerPartial("templates/homeBtn",i),i}),define("views/HomeButtonView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","hbs!templates/homeBtn"],function(t,e,i){function n(){var t=h({label:this.options.content});this.button=new a({size:[this.options.width,this.options.height],content:t});var e=["btn-wrapper"].concat(this.options.classes);this.button.setClasses(e),this.buttonMod=new c({transform:u.translate(0,0,0)}),this.add(this.buttonMod).add(this.button)}function o(){this.button.on("click",function(){this._eventOutput.emit("click")}.bind(this))}function s(){r.apply(this,arguments),n.call(this),o.call(this)}var r=t("famous/core/View"),a=t("famous/core/Surface"),u=t("famous/core/Transform"),c=t("famous/modifiers/StateModifier"),h=t("hbs!templates/homeBtn");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={content:"Click Me!",width:190,height:40,classes:[]},i.exports=s}),define("views/HomeMenuView",["require","exports","module","famous/core/View","famous/core/Transform","famous/modifiers/StateModifier","famous/transitions/Transitionable","famous/transitions/SpringTransition","famous/utilities/Timer","utils","views/HomeButtonView"],function(t,e,i){function n(){this.btnPlay.on("click",function(){this._eventOutput.emit("nav:loadStages")}.bind(this)),this.btnResumeGame.on("click",function(){this._eventOutput.emit("nav:loadGame")}.bind(this)),this.btnAbout.on("click",function(){this._eventOutput.emit("nav:showAbout")}.bind(this))}function o(){u.apply(this,arguments),this.rootMod=new h({size:[190,150],origin:[.5,0],align:[.5,0],transform:c.translate(0,0,0)}),this.node=this.add(this.rootMod),this._modifiers=[],s.call(this),r.call(this),a.call(this),n.call(this)}function s(){this.btnResumeGame=new _({content:"Resume",classes:["btn-resume"],height:this.options.buttonHeight});var t=new h({transform:c.translate(0,g,0)});this._modifiers.push(t),this.node.add(t).add(this.btnResumeGame)}function r(){this.btnPlay=new _({content:"Stages",classes:["btn-play"],height:this.options.buttonHeight});var t=new h({transform:c.translate(0,g,0)});this._modifiers.push(t),this.node.add(t).add(this.btnPlay)}function a(){this.btnAbout=new _({content:"About",classes:["btn-about"],height:this.options.buttonHeight});var t=new h({transform:c.translate(0,g,0)});this._modifiers.push(t),this.node.add(t).add(this.btnAbout)}var u=t("famous/core/View"),c=t("famous/core/Transform"),h=t("famous/modifiers/StateModifier"),l=t("famous/transitions/Transitionable"),p=t("famous/transitions/SpringTransition"),f=t("famous/utilities/Timer");l.registerMethod("spring",p);var d=t("utils"),g=d.getViewportHeight(),m=10,v=300,y={method:"spring",period:1e3,dampingRatio:.7},_=t("views/HomeButtonView");o.prototype=Object.create(u.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={buttonHeight:50},o.prototype.showButtons=function(){function t(t){this._modifiers[t].setTransform(c.translate(0,t*e,0),y)}for(var e=this.options.buttonHeight+m,i=0;i<this._modifiers.length;i++)f.setTimeout(t.bind(this,i),(i+1)*v)},i.exports=o}),define("famous/surfaces/ImageSurface",["require","exports","module","famous/core/Surface"],function(t,e,i){function n(){this._imageUrl=void 0,o.apply(this,arguments)}var o=t("famous/core/Surface");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.elementType="img",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(t){this._imageUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){t.src=this._imageUrl||""},n.prototype.recall=function(t){t.src=""},i.exports=n}),define("views/LetterView",["require","exports","module","lodash","famous/core/Engine","famous/core/View","famous/core/Surface","famous/core/Transform","famous/core/Modifier","famous/transitions/Transitionable","famous/transitions/Easing","famous/utilities/Timer"],function(t,e,i){function n(t){return new l({size:[t.width,t.height],classes:t.classes||[],properties:{backgroundColor:t.backgroundColor,zIndex:t.zIndex,pointerEvents:"none"}})}function o(t){return new f({origin:t.origin,transform:t.translate})}function s(t,e,i){var n=i||0===i?i:250;m.setTimeout(function(){function i(){var i=e.width||u.get(),n=e.height||u.get();t.setOptions({size:[i,n]})}function o(){c.removeListener("prerender",i.bind(this))}var s={duration:n,curve:g.inOutQuad},r=0,a=!e.width&&e.size[0]||!e.height&&e.size[1],u=new d(r);c.on("prerender",i.bind(this)),u.set(a,s,o.bind(this))}.bind(this,e.index),e.index*n)}function r(t){t=v[t];for(var e=0;e<t.surfaces.length;e++){var i=u.extend({},t.surfaces[e]);i.index=e,"width"===t.animationChain[e]?(i.height=i.size[1],i.width=0):(i.height=0,i.width=i.size[0]);var s=n(i),r=o(i);s._options=i,this._surfaces.push(s),this.add(r).add(s)}}function a(){h.apply(this,arguments),this._surfaces=[],r.call(this,this.options.letter)}var u=t("lodash"),c=t("famous/core/Engine"),h=t("famous/core/View"),l=t("famous/core/Surface"),p=t("famous/core/Transform"),f=t("famous/core/Modifier"),d=t("famous/transitions/Transitionable"),g=t("famous/transitions/Easing"),m=t("famous/utilities/Timer"),v={F:{animationChain:["height","width","width"],surfaces:[{origin:[0,1],size:[37,125],backgroundColor:"#282C38",translate:p.translate(0,0,0),zIndex:10},{origin:[0,0],size:[80,37],backgroundColor:"#FA1435",translate:p.translate(0,0,0),zIndex:15},{origin:[0,0],size:[80,37],backgroundColor:"#18C5DC",translate:p.translate(0,46,0),zIndex:5}]},pyramid:{animationChain:["height","height","height"],surfaces:[{origin:[.5,1],size:[160,40],classes:["logo","logo-brick","logo-bottom"],translate:p.translate(0,0,1),zIndex:5},{origin:[.5,1],size:[100,25],classes:["logo","logo-brick","logo-middle"],translate:p.translate(0,-45,1),zIndex:5},{origin:[.5,1],size:[65,16],classes:["logo","logo-brick","logo-top"],translate:p.translate(0,-75,1),zIndex:5}]}};a.prototype=Object.create(h.prototype),a.prototype.constructor=a,a.DEFAULT_OPTIONS={letter:"pyramid"},a.prototype.show=function(t){for(var e=250,i=0;i<this._surfaces.length;i++){var n=this._surfaces[i];s(n,n._options,e)}m.setTimeout(function(){t&&t()},e*this._surfaces.length)},i.exports=a}),define("views/LogoView",["require","exports","module","famous/core/Engine","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/core/Modifier","famous/transitions/Easing","famous/transitions/Transitionable","famous/surfaces/ImageSurface","views/LetterView","utils"],function(t,e,i){function n(){c.apply(this,arguments),this._width=this.options.width>b?b:this.options.width,this._height=this.options.height>w?w:this.options.height,this.rootModifier=new p({size:[this._width,this._height],origin:[.5,.5],align:[.5,.5]}),this.node=this.add(this.rootModifier),s.call(this),r.call(this),o.call(this)}function o(){this.famousIcon=new m({size:[35,35],content:"images/famous-logo.png",classes:["backfaceVisibility"]});var t=Date.now(),e=new p({size:[35,35],origin:[.5,.5],align:[.5,.5],opacity:.001,transform:l.translate(0,-55,50)}),i=new f({origin:[.5,.5],transform:function(){return l.rotateY(.002*(Date.now()-t))}});this.famousIcon._mod=e,this.node.add(e).add(i).add(this.famousIcon)}function s(){this.bg=new h({size:[0,this._height],classes:["logo","logo-bg"],properties:{pointerEvents:"none",zIndex:5}}),this.bgModifier=new p({origin:[.5,.5],align:[.5,.5],transform:l.translate(0,0,0)}),this.add(this.bgModifier).add(this.bg)}function r(){var t=new v({letter:this.options.brand}),e=new p({size:[170,125],origin:[.5,.5]});this.brandView=t,this.node.add(e).add(t)}function a(t,e){function i(){this.bg.setOptions({size:[a.get(),this._height]})}function n(){u.removeListener("prerender",i.bind(this)),e&&e()}var o={duration:400,curve:d.inOutQuad},s=t?0:this._width,r=t?this._width:0,a=new g(s);u.on("prerender",i.bind(this)),a.set(r,o,n.bind(this))}var u=t("famous/core/Engine"),c=t("famous/core/View"),h=t("famous/core/Surface"),l=t("famous/core/Transform"),p=t("famous/modifiers/StateModifier"),f=t("famous/core/Modifier"),d=t("famous/transitions/Easing"),g=t("famous/transitions/Transitionable"),m=t("famous/surfaces/ImageSurface"),v=t("views/LetterView"),y=t("utils"),_=y.getViewportWidth(),b=480,w=480;n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={width:_/5*3,height:_/5*3,brand:"pyramid"},n.prototype.showLogo=function(){this.showBackground(function(){this.showBrand.call(this,function(){this.famousIcon&&this.showFamousIcon.call(this)}.bind(this))}.bind(this))},n.prototype.showBackground=function(t){a.call(this,!0,t)},n.prototype.showBrand=function(t){this.brandView.show(t)},n.prototype.showFamousIcon=function(){this.famousIcon._mod.setOpacity(.999,{curve:"linear",duration:600})},n.prototype.hideBackground=function(){a.call(this,!1)},n.resetLogo=function(){},i.exports=n}),define("views/HomeView",["require","exports","module","famous/core/View","famous/core/Transform","famous/modifiers/StateModifier","utils","views/BackgroundView","views/HomeMenuView","views/LogoView"],function(t,e,i){function n(){u.apply(this,arguments);var t=new h({origin:[0,0],align:[0,0]});this.node=this.add(t),o.call(this),s.call(this),r.call(this),a.call(this)}function o(){this.bg=new p,this.node.add(this.bg),this.bg.show(null,300,function(){this.logo.showLogo()}.bind(this))}function s(){this.logo=new d;var t=new h({size:[g/5*3,g/5*3],origin:[.5,.5],align:[.5,.5]});this.logo._mod=t,this.node.add(t).add(this.logo)}function r(){this.menuView=new f,this.menuView.rootMod.setOrigin([.5,1]),this.menuView.rootMod.setAlign([.5,1]),this.menuView.rootMod.setTransform(c.translate(0,-60,10)),this.node.add(this.menuView)}function a(){this.menuView.on("nav:loadStages",function(){this._eventOutput.emit("nav:loadStages")}.bind(this)),this.menuView.on("nav:loadGame",function(){this._eventOutput.emit("nav:loadGame")}.bind(this)),this.bg.pipe(this._eventOutput)}var u=t("famous/core/View"),c=t("famous/core/Transform"),h=t("famous/modifiers/StateModifier"),l=t("utils"),p=t("views/BackgroundView"),f=t("views/HomeMenuView"),d=t("views/LogoView"),g=l.getViewportWidth();n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},n.prototype.showLoading=function(){this.logo.showLogo()},n.prototype.showMenu=function(){this.logo._mod.setTransform(c.translate(0,-100,0),{curve:"easeOut",duration:300}),this.menuView.showButtons()},i.exports=n}),define("famous/surfaces/ContainerSurface",["require","exports","module","famous/core/Surface","famous/core/Context"],function(t,e,i){function n(t){o.call(this,t),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new s(this._container),this.setContent(this._container)}var o=t("famous/core/Surface"),s=t("famous/core/Context");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),o.prototype.render.apply(this,arguments)},n.prototype.deploy=function(){return this._shouldRecalculateSize=!0,o.prototype.deploy.apply(this,arguments)},n.prototype.commit=function(){var t=this._size?[this._size[0],this._size[1]]:null,e=o.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||t&&(this._size[0]!==t[0]||this._size[1]!==t[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),e},i.exports=n}),define("famous/physics/constraints/Constraint",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(){this.options=this.options||{},this._energy=0,this._eventOutput=null}function o(){this._eventOutput=new s,this._eventOutput.bindThis(this),s.setOutputHandler(this,this._eventOutput)}var s=t("famous/core/EventHandler");n.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},n.prototype.applyConstraint=function(){},n.prototype.getEnergy=function(){return this._energy},n.prototype.setEnergy=function(t){this._energy=t},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.addListener=function(){return o.call(this),this.addListener.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.removeListener=function(){return this.removeListener.apply(this,arguments)},n.prototype.unpipe=function(){return this.unpipe.apply(this,arguments)},i.exports=n}),define("famous/physics/constraints/Snap",["require","exports","module","./Constraint","famous/math/Vector"],function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.pDiff=new r,this.vDiff=new r,this.impulse1=new r,this.impulse2=new r,s.call(this)}function o(t,e,i){return Math.abs(t.dot(e)/i)}var s=t("./Constraint"),r=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var a=Math.PI;n.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor instanceof r&&(this.options.anchor=t.anchor),t.anchor.position instanceof r&&(this.options.anchor=t.anchor.position),t.anchor instanceof Array&&(this.options.anchor=new r(t.anchor))),void 0!==t.length&&(this.options.length=t.length),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.options.period=t.period)},n.prototype.setAnchor=function(t){void 0!==this.options.anchor&&(this.options.anchor=new r),this.options.anchor.set(t)},n.prototype.getEnergy=function(t,e){var i=this.options,n=i.length,o=i.anchor||e.position,s=Math.pow(2*a/i.period,2),r=o.sub(t.position).norm()-n;return.5*s*r*r},n.prototype.applyConstraint=function(t,e,i){for(var n=this.options,s=this.pDiff,r=this.vDiff,u=this.impulse1,c=this.impulse2,h=n.length,l=n.anchor||e.position,p=n.period,f=n.dampingRatio,d=0;d<t.length;d++){var g=t[d],m=g.position,v=g.velocity,y=g.mass,_=g.inverseMass;s.set(m.sub(l));var b,w=s.norm()-h;if(e){var S=e.inverseMass,x=e.velocity;r.set(v.sub(x)),b=1/(_+S)}else r.set(v),b=y;var O,T;if(0===this.options.period)O=0,T=1;else{var E=4*b*a*a/(p*p),I=4*b*a*f/p;T=i*E/(I+i*E),O=1/(I+i*E)}var C=T/i*w;s.normalize(-C).sub(r).mult(i/(O+i/b)).put(u),g.applyImpulse(u),e&&(u.mult(-1).put(c),e.applyImpulse(c)),this.setEnergy(o(u,s,i))}},i.exports=n}),define("famous/transitions/SnapTransition",["require","exports","module","famous/physics/PhysicsEngine","famous/physics/bodies/Particle","famous/physics/constraints/Snap","famous/math/Vector"],function(t,e,i){function n(t){t=t||0,this.endState=new _(t),this.initState=new _,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new m,this.particle=new v,this.spring=new y({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function o(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function s(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function r(t){this.endState.set(t),s.call(this)}function a(){this.PE.wake()}function u(){this.PE.sleep()}function c(t){this.particle.position.set(t)}function h(t){this.particle.velocity.set(t)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function p(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function f(t){this._callback=t}function d(t){var e=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),h.call(this,t.velocity)}function g(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else o.call(this)<this._absRestTolerance&&(c.call(this,this.endState),h.call(this,[0,0,0]),u.call(this))}var m=t("famous/physics/PhysicsEngine"),v=t("famous/physics/bodies/Particle"),y=t("famous/physics/constraints/Snap"),_=t("famous/math/Vector");n.SUPPORTS_MULTIPLE=3,n.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},n.prototype.reset=function(t,e){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),c.call(this,t),r.call(this,t),e&&h.call(this,e),f.call(this,void 0)},n.prototype.getVelocity=function(){return p.call(this)},n.prototype.setVelocity=function(t){this.call(this,h(t))},n.prototype.isActive=function(){return!this.PE.isSleeping()},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return g.call(this),l.call(this)},n.prototype.set=function(t,e,i){return e?(this._dimensions=t instanceof Array?t.length:0,a.call(this),d.call(this,e),r.call(this,t),void f.call(this,i)):(this.reset(t),void(i&&i()))},i.exports=n}),define("famous/physics/forces/Drag",["require","exports","module","./Force"],function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),o.call(this)}var o=t("./Force");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},n.DEFAULT_OPTIONS={strength:.01,forceFunction:n.FORCE_FUNCTIONS.LINEAR},n.prototype.applyForce=function(t){for(var e=this.options.strength,i=this.options.forceFunction,n=this.force,o=0;o<t.length;o++){var s=t[o];i(s.velocity).mult(-e).put(n),s.applyForce(n)}},n.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},i.exports=n}),define("famous/core/ViewSequence",["require","exports","module"],function(t,e,i){function n(t){t||(t=[]),t instanceof Array&&(t={array:t}),this._=null,this.index=t.index||0,t.array?this._=new this.constructor.Backing(t.array):t._&&(this._=t._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==t.loop&&(this._.loop=t.loop),this._previousNode=null,this._nextNode=null}n.Backing=function(t){this.array=t,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null},n.Backing.prototype.getValue=function(t){var e=t-this.firstIndex;return 0>e||e>=this.array.length?null:this.array[e]},n.Backing.prototype.setValue=function(t,e){this.array[t-this.firstIndex]=e},n.Backing.prototype.reindex=function(t,e,i){if(this.array[0]){for(var n=0,o=this.firstIndex,s=i-e,r=this.firstNode;t-1>o;)r=r.getNext(),o++;var a=r;for(n=0;e>n;n++)r=r.getNext(),r&&(r._previousNode=a);var u=r?r.getNext():null;for(a._nextNode=null,r=a,n=0;i>n;n++)r=r.getNext();if(o+=i,r!==u&&(r._nextNode=u,u&&(u._previousNode=r)),u)for(r=u,o++;r&&o<this.array.length+this.firstIndex;)r._nextNode?r.index+=s:r.index=o,r=r.getNext(),o++}},n.prototype.getPrevious=function(){return this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+this._.array.length-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this),this._previousNode},n.prototype.getNext=function(){return this.index===this._.firstIndex+this._.array.length-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this),this._nextNode},n.prototype.getIndex=function(){return this.index},n.prototype.toString=function(){return""+this.index},n.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length},n.prototype.push=function(){this._.array.push.apply(this._.array,arguments)},n.prototype.splice=function(t,e){var i=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[t-this._.firstIndex,e].concat(i)),this._.reindex(t,e,i.length)
},n.prototype.swap=function(t){var e=t.get(),i=this.get();this._.setValue(this.index,e),this._.setValue(t.index,i);var n=this._previousNode,o=this._nextNode,s=this.index,r=t._previousNode,a=t._nextNode,u=t.index;this.index=u,this._previousNode=r===this?t:r,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=a===this?t:a,this._nextNode&&(this._nextNode._previousNode=this),t.index=s,t._previousNode=n===t?this:n,t._previousNode&&(t._previousNode._nextNode=t),t._nextNode=o===t?this:o,t._nextNode&&(t._nextNode._previousNode=t),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),t.index===this._.firstIndex?this._.firstNode=t:t.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=t)},n.prototype.get=function(){return this._.getValue(this.index)},n.prototype.getSize=function(){var t=this.get();return t?t.getSize():null},n.prototype.render=function(){var t=this.get();return t?t.render.apply(t,arguments):null},i.exports=n}),define("famous/core/Group",["require","exports","module","./Context","./Transform","./Surface"],function(t,e,i){function n(t){r.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new o(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var o=t("./Context"),s=t("./Transform"),r=t("./Surface");n.SIZE_ZERO=[0,0],n.prototype=Object.create(r.prototype),n.prototype.elementType="div",n.prototype.elementClass="famous-group",n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.render=function(){return r.prototype.render.call(this)},n.prototype.deploy=function(t){this.context.migrate(t)},n.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},n.prototype.commit=function(t){var e=t.transform,i=t.origin,o=t.opacity,a=t.size,u=r.prototype.commit.call(this,{allocator:t.allocator,transform:s.thenMove(e,[-i[0]*a[0],-i[1]*a[1],0]),opacity:o,origin:i,size:n.SIZE_ZERO});return(a[0]!==this._groupSize[0]||a[1]!==this._groupSize[1])&&(this._groupSize[0]=a[0],this._groupSize[1]=a[1],this.context.setSize(a)),this.context.update({transform:s.translate(-i[0]*a[0],-i[1]*a[1],0),origin:i,size:a}),u},i.exports=n}),define("famous/views/Scroller",["require","exports","module","famous/core/Entity","famous/core/Group","famous/core/OptionsManager","famous/core/Transform","famous/utilities/Utility","famous/core/ViewSequence","famous/core/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),t&&this._optionsManager.setOptions(t),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new h,this.group.add({render:u.bind(this)}),this._entityId=c.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput)}function o(t){t||(t=this._contextSize);var e=this.options.direction===f.Direction.X?0:1;return void 0===t[e]?this._contextSize[e]:t[e]}function s(t,e,i){var n=t.getSize?t.getSize():this._contextSize,s=this._outputFunction(e);return i.push({transform:s,target:t.render()}),o.call(this,n)}function r(){return this.options.clipSize?this.options.clipSize:o.call(this,this._contextSize)}function a(){for(var t=o.call(this,this._node.getSize()),e=this._node&&this._node.getNext?this._node.getNext():null;e&&this._position+this._positionOffset>=t;)this._positionOffset-=t,this._node=e,t=o.call(this,this._node.getSize()),e=this._node&&this._node.getNext?this._node.getNext():null;for(var i=this._node&&this._node.getPrevious?this._node.getPrevious():null;i&&this._position+this._positionOffset<0;){var n=o.call(this,i.getSize());this._positionOffset+=n,this._node=i,i=this._node&&this._node.getPrevious?this._node.getPrevious():null}}function u(){var t=null,e=this._position,i=[];this._onEdge=0;for(var n=-this._positionOffset,u=r.call(this),c=this._node;c&&n-e<u+this.options.margin;)n+=s.call(this,c,n,i),c=c.getNext?c.getNext():null;var h=this._node,l=o.call(this,h.getSize());if(u>n){for(;h&&u>l;)h=h.getPrevious(),h&&(l+=o.call(this,h.getSize()));for(h=this._node;h&&u>l;)h=h.getNext(),h&&(l+=o.call(this,h.getSize()))}var p=void 0!==l&&u>l?l:u;for(!c&&p>=n-e?(this._onEdge=1,this._eventOutput.emit("edgeHit",{position:n-p})):!this._node.getPrevious()&&0>=e&&(this._onEdge=-1,this._eventOutput.emit("edgeHit",{position:0})),c=this._node&&this._node.getPrevious?this._node.getPrevious():null,n=-this._positionOffset,c&&(t=c.getSize?c.getSize():this._contextSize,n-=o.call(this,t));c&&n-e>-(r.call(this)+this.options.margin);)s.call(this,c,n,i),c=c.getPrevious?c.getPrevious():null,c&&(t=c.getSize?c.getSize():this._contextSize,n-=o.call(this,t));return a.call(this),i}var c=t("famous/core/Entity"),h=t("famous/core/Group"),l=t("famous/core/OptionsManager"),p=t("famous/core/Transform"),f=t("famous/utilities/Utility"),d=t("famous/core/ViewSequence"),g=t("famous/core/EventHandler");n.DEFAULT_OPTIONS={direction:f.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1},n.prototype.setOptions=function(t){this._optionsManager.setOptions(t),this.options.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)},n.prototype.onEdge=function(){return this._onEdge},n.prototype.outputFrom=function(t,e){t||(t=function(t){return this.options.direction===f.Direction.X?p.translate(t,0):p.translate(0,t)}.bind(this),e||(e=t)),this._outputFunction=t,this._masterOutputFunction=e?e:function(e){return p.inverse(t(-e))}},n.prototype.positionFrom=function(t){t instanceof Function?this._positionGetter=t:t&&t.get?this._positionGetter=t.get.bind(t):(this._positionGetter=null,this._position=t),this._positionGetter&&(this._position=this._positionGetter.call(this))},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new d({array:t})),this._node=t,this._positionOffset=0},n.prototype.getSize=function(t){return t?this._contextSize:this._size},n.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},n.prototype.commit=function(t){var e=t.transform,i=t.opacity,n=t.origin,o=t.size;this.options.clipSize||o[0]===this._contextSize[0]&&o[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=o[0],this._contextSize[1]=o[1],this.options.direction===f.Direction.X?(this._size[0]=r.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=r.call(this)));var s=this._masterOutputFunction(-this._position);return{transform:p.multiply(e,s),size:o,opacity:i,origin:n,target:this.group.render()}},i.exports=n}),define("famous/inputs/ScrollSync",["require","exports","module","famous/core/EventHandler","famous/core/Engine"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",s.bind(this)),this._eventInput.on("wheel",s.bind(this)),this._inProgress=!1,this._loopBound=!1}function o(){if(this._inProgress&&c()-this._prevTime>this.options.stallTime){this._inProgress=!1;var t=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,e=this._payload;e.position=this._position,e.velocity=t,e.slip=!0,this._eventOutput.emit("end",e)}}function s(t){t.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,m=this._payload,m.slip=!0,m.position=this._position,m.clientX=t.clientX,m.clientY=t.clientY,m.offsetX=t.offsetX,m.offsetY=t.offsetY,this._eventOutput.emit("start",m),this._loopBound||(a.on("prerender",o.bind(this)),this._loopBound=!0));var e=c(),i=this._prevTime||e,s=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,r=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY;1===t.deltaMode&&(s*=this.options.lineHeight,r*=this.options.lineHeight),this.options.rails&&(Math.abs(s)>Math.abs(r)?r=0:s=0);var h,l,p=Math.max(e-i,u),f=s/p,d=r/p,g=this.options.scale;this.options.direction===n.DIRECTION_X?(l=g*s,h=g*f,this._position+=l):this.options.direction===n.DIRECTION_Y?(l=g*r,h=g*d,this._position+=l):(l=[g*s,g*r],h=[g*f,g*d],this._position[0]+=l[0],this._position[1]+=l[1]);var m=this._payload;m.delta=l,m.velocity=h,m.position=this._position,m.slip=!0,this._eventOutput.emit("update",m),this._prevTime=e,this._prevVel=h}var r=t("famous/core/EventHandler"),a=t("famous/core/Engine");n.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40},n.DIRECTION_X=0,n.DIRECTION_Y=1;var u=8,c=Date.now;n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.minimumEndSpeed&&(this.options.minimumEndSpeed=t.minimumEndSpeed),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime)},i.exports=n}),define("famous/views/Scrollview",["require","exports","module","famous/physics/PhysicsEngine","famous/physics/bodies/Particle","famous/physics/forces/Drag","famous/physics/forces/Spring","famous/core/EventHandler","famous/core/OptionsManager","famous/core/ViewSequence","famous/views/Scroller","famous/utilities/Utility","famous/inputs/GenericSync","famous/inputs/ScrollSync","famous/inputs/TouchSync"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new w(this.options),this._node=null,this._physicsEngine=new m,this._particle=new v,this._physicsEngine.addBody(this._particle),this.spring=new _({anchor:[0,0,0]}),this.drag=new y({forceFunction:y.FORCE_FUNCTIONS.QUADRATIC}),this.friction=new y({forceFunction:y.FORCE_FUNCTIONS.LINEAR}),this.sync=new T(["scroll","touch"],{direction:this.options.direction}),this._eventInput=new b,this._eventOutput=new b,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),b.setInputHandler(this,this._eventInput),b.setOutputHandler(this,this._eventOutput),this._touchCount=0,this._springState=0,this._onEdge=0,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=void 0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._scroller=new x,this._scroller.positionFrom(this.getPosition.bind(this)),this.setOptions(t),a.call(this)}function o(t){this._touchCount=t.count,void 0===t.count&&(this._touchCount=1),c.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function s(t){var e=-t.velocity,i=-t.delta;this._onEdge&&t.slip&&(0>e&&this._onEdge<0||e>0&&this._onEdge>0?this._earlyEnd||(r.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(e)>Math.abs(this.getVelocity())&&o.call(this,t)),this._earlyEnd||(this._touchVelocity=e,t.slip?this.setVelocity(e):this.setPosition(this.getPosition()+i))}function r(t){if(this._touchCount=t.count||0,!this._touchCount){c.call(this),this._onEdge&&f.call(this,this._edgeSpringPosition,k.EDGE),u.call(this);var e=-t.velocity,i=this.options.speedLimit;t.slip&&(i*=this.options.edgeGrip),-i>e?e=-i:e>i&&(e=i),this.setVelocity(e),this._touchVelocity=void 0,this._needsPaginationCheck=!0}}function a(){this._eventInput.bindThis(this),this._eventInput.on("start",o),this._eventInput.on("update",s),this._eventInput.on("end",r),this._scroller.on("edgeHit",function(t){this._edgeSpringPosition=t.position}.bind(this))}function u(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function c(){this._springState=k.NONE,this._physicsEngine.detachAll()}function h(t){var e=this.options.direction,i=(t.getSize()||this._scroller.getSize())[e];return i||(i=this._scroller.getSize()[e]),i}function l(t){!this._onEdge&&t?(this.sync.setOptions({scale:this.options.edgeGrip}),this._touchCount||this._springState===k.EDGE||f.call(this,this._edgeSpringPosition,k.EDGE)):this._onEdge&&!t&&(this.sync.setOptions({scale:1}),this._springState&&Math.abs(this.getVelocity())<.001&&(c.call(this),u.call(this))),this._onEdge=t}function p(){if(this._needsPaginationCheck&&!this._touchCount&&this._springState!==k.EDGE){var t=this.getVelocity();if(!(Math.abs(t)>=this.options.pageStopSpeed)){var e=this.getPosition(),i=Math.abs(t)>this.options.pageSwitchSpeed,n=h.call(this,this._node),o=e>.5*n,s=t>0;o&&!i||i&&s?this.goToNextPage():f.call(this,0,k.PAGE),this._needsPaginationCheck=!1}}}function f(t,e){var i;e===k.EDGE?(this._edgeSpringPosition=t,i={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):e===k.PAGE&&(this._pageSpringPosition=t,i={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(i),e&&!this._springState&&(c.call(this),this._springState=e,u.call(this)),this._springState=e}function d(){for(var t=this.getPosition(),e=h.call(this,this._node),i=this._node.getNext();t>e+C&&i;)g.call(this,-e),t-=e,this._scroller.sequenceFrom(i),this._node=i,i=this._node.getNext(),e=h.call(this,this._node);for(var n,o=this._node.getPrevious();-C>t&&o;)n=h.call(this,o),this._scroller.sequenceFrom(o),this._node=o,g.call(this,n),t+=n,o=this._node.getPrevious()}function g(t){this._edgeSpringPosition+=t,this._pageSpringPosition+=t,this.setPosition(this.getPosition()+t),this._springState===k.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===k.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var m=t("famous/physics/PhysicsEngine"),v=t("famous/physics/bodies/Particle"),y=t("famous/physics/forces/Drag"),_=t("famous/physics/forces/Spring"),b=t("famous/core/EventHandler"),w=t("famous/core/OptionsManager"),S=t("famous/core/ViewSequence"),x=t("famous/views/Scroller"),O=t("famous/utilities/Utility"),T=t("famous/inputs/GenericSync"),E=t("famous/inputs/ScrollSync"),I=t("famous/inputs/TouchSync");T.register({scroll:E,touch:I});var C=.5;n.DEFAULT_OPTIONS={direction:O.Direction.Y,rails:!0,friction:.001,drag:1e-4,edgeGrip:.5,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:10,groupScroll:!1};var k={NONE:0,EDGE:1,PAGE:2};n.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},n.prototype.getPosition=function(){return this._particle.getPosition1D()},n.prototype.setPosition=function(t){this._particle.setPosition1D(t)},n.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},n.prototype.setVelocity=function(t){this._particle.setVelocity1D(t)},n.prototype.setOptions=function(t){t&&(void 0!==t.direction&&("x"===t.direction?t.direction=O.Direction.X:"y"===t.direction&&(t.direction=O.Direction.Y)),this._scroller.setOptions(t),this._optionsManager.setOptions(t)),this._scroller.setOptions(this.options),this.options.groupScroll?this._scroller.pipe(this._eventInput):this._scroller.unpipe(this._eventInput),this.drag.setOptions({strength:this.options.drag}),this.friction.setOptions({strength:this.options.friction}),this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===O.Direction.X?T.DIRECTION_X:T.DIRECTION_Y})},n.prototype.goToPreviousPage=function(){if(!this._node)return null;var t=this._node.getPrevious();if(t){var e=this.getPosition(),i=h.call(this,t);this._scroller.sequenceFrom(t),this._node=t;var n=C>e?-i:0;f.call(this,n,k.PAGE),g.call(this,i)}return this._eventOutput.emit("pageChange",{direction:-1}),t},n.prototype.goToNextPage=function(){if(!this._node)return null;var t=this._node.getNext();if(t){var e=this.getPosition(),i=h.call(this,this._node),n=h.call(this,t);this._scroller.sequenceFrom(t),this._node=t;var o=e>i-C?i+n:i;f.call(this,o,k.PAGE),g.call(this,-i)}return this._eventOutput.emit("pageChange",{direction:1}),t},n.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new S({array:t})),this._node=t,this._scroller.sequenceFrom(t)},n.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},n.prototype.render=function(){return this._node?(d.call(this),l.call(this,this._scroller.onEdge()),this.options.paginated&&p.call(this),this._scroller.render()):null},i.exports=n}),define("famous/views/Flipper",["require","exports","module","famous/core/Transform","famous/transitions/Transitionable","famous/core/RenderNode","famous/core/OptionsManager"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t),this.angle=new s(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var o=t("famous/core/Transform"),s=t("famous/transitions/Transitionable"),r=(t("famous/core/RenderNode"),t("famous/core/OptionsManager"));n.DIRECTION_X=0,n.DIRECTION_Y=1;var a=1;n.DEFAULT_OPTIONS={transition:!0,direction:n.DIRECTION_X},n.prototype.flip=function(t,e){var i=this.flipped?0:Math.PI;this.setAngle(i,t,e),this.flipped=!this.flipped},n.prototype.setAngle=function(t,e,i){void 0===e&&(e=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,e,i)},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.setFront=function(t){this.frontNode=t},n.prototype.setBack=function(t){this.backNode=t},n.prototype.render=function(){var t,e,i=this.angle.get();this.options.direction===n.DIRECTION_X?(t=o.rotateY(i),e=o.rotateY(i+Math.PI)):(t=o.rotateX(i),e=o.rotateX(i+Math.PI));var s=[];return this.frontNode&&s.push({transform:t,target:this.frontNode.render()}),this.backNode&&s.push({transform:o.moveThen([0,0,a],e),target:this.backNode.render()}),s},i.exports=n}),define("hbs!templates/levelFront",["hbs","hbs/handlebars"],function(t,e){var i=e.template(function(t,e,i){this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers);var n,o,s="",r="function",a=this.escapeExpression;return s+='<span class="level-number">',(o=i.level)?n=o.call(e,{hash:{}}):(o=e&&e.level,n=typeof o===r?o.call(e,{hash:{}}):o),s+=a(n)+'</span>\n<i class="fa fa-lock"></i>'});return e.registerPartial("templates/levelFront",i),i}),define("hbs!templates/levelDetail",["hbs","hbs/handlebars"],function(t,e){var i=e.template(function(t,e,i){this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,t.helpers);var n,o,s="",r="function",a=this.escapeExpression;return s+='<div class="level-detail">\n  <p class="description">',(o=i.description)?n=o.call(e,{hash:{}}):(o=e&&e.description,n=typeof o===r?o.call(e,{hash:{}}):o),s+=a(n)+"</p>\n</div>"});return e.registerPartial("templates/levelDetail",i),i}),define("views/LevelView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/core/Modifier","famous/modifiers/StateModifier","utils","StageConfig","models/UserModel","famous/views/Flipper","hbs!templates/levelFront","hbs!templates/levelDetail","hbs!templates/btn"],function(t,e,i){function n(){function t(t){this._eventOutput.emit("level:play",{index:this.options.level-1,stage:this.options.stage,level:this.options.level,node:this,event:t})}function e(t){this.flip(),this._eventOutput.emit("level:select",{index:this.options.level-1,stage:this.options.stage,level:this.options.level,node:this,event:t})}function i(t){this.flip(),this._eventOutput.emit("level:close",{index:this.options.level-1,stage:this.options.stage,level:this.options.level,node:this,event:t})}this._locked||(this.front.on("click",e.bind(this)),this.back.playButton.on("click",t.bind(this)),this.back.backing.on("click",i.bind(this))),this.front.pipe(this._eventOutput)}function o(){v.apply(this,arguments),this.isOpen=!1,this._locked=!k.hasUnlockedLevel(this.options.stage,this.options.level),this._transform=_.translate(this.options.start[0],this.options.start[1],this.options.start[2]),this.rootMod=new w({origin:[.5,.5],align:[.5,.5],transform:this._transform}),this._color=this.options.index%this.options.colors+1,this.node=this.add(this.rootMod),s.call(this),n.call(this)}function s(){this.flipper=new T;var t=new b({origin:[.5,.5],align:[.5,.5]});r.call(this),a.call(this),this.flipper.setFront(this.front),this.flipper.setBack(this.back),this.node.add(t).add(this.flipper)}function r(){this.front=new c({stage:this.options.stage,level:this.options.level,color:this._color,locked:this._locked})}function a(){this.back=new f({stage:this.options.stage,level:this.options.level,color:this._color,locked:this._locked})}function u(){this.backing.pipe(this._eventOutput),this.backing.on("click",function(){this._eventOutput.emit("level:click")}.bind(this))}function c(){v.apply(this,arguments),this.rootModifier=new w({size:[this.options.width,this.options.height],origin:[.5,.5],align:[.5,.5]}),this.node=this.add(this.rootModifier),l.call(this),u.call(this)}function h(){var t={level:this.options.level};return E(t)}function l(){this.backing=new y({size:[void 0,void 0],content:h.call(this),properties:{}}),this.backing.setClasses(["stage-level-front","stage-level-backing","stage-"+this.options.stage,"stage-level--color"+this.options.color]),this.options.current&&this.backing.addClass("current"),this.backing.addClass(this.options.locked?"locked":"unlocked"),this.node.add(this.backing)}function p(){this.backing.pipe(this._eventOutput),this.playButton.pipe(this._eventOutput)}function f(){v.apply(this,arguments),this._config=new x(this.options.stage),this.rootModifier=new w({size:[this.options.width,this.options.height],origin:[.5,.5],align:[.5,.5]}),this.node=this.add(this.rootModifier),g.call(this),m.call(this),p.call(this)}function d(){var t={description:this._config.getGameDesc(this.options.level)};return I(t)}function g(){this.backing=new y({size:[void 0,void 0],content:d.call(this),properties:{backgroundColor:"white"}}),this.backing.setClasses(["stage-level-back","stage-level-backing","stage-"+this.options.stage,"stage-level--color"+this.options.color]),this.options.current&&this.backing.addClass("current"),this.options.locked&&this.backing.addClass("locked"),this.node.add(this.backing)}function m(){var t=C({label:"Play",classes:"btn-play"});this.playButton=new y({content:t}),this.playButton.setClasses(["stage-level-back","stage-"+this.options.stage,"stage-level--color"+this.options.color]),this.playButtonMod=new w({size:[this.options.width-50,50],origin:[.5,1],align:[.5,1],transform:_.translate(0,-50,1)}),this.node.add(this.playButtonMod).add(this.playButton)}var v=t("famous/core/View"),y=t("famous/core/Surface"),_=t("famous/core/Transform"),b=t("famous/core/Modifier"),w=t("famous/modifiers/StateModifier"),S=t("utils"),x=t("StageConfig"),O=t("models/UserModel"),T=t("famous/views/Flipper"),E=t("hbs!templates/levelFront"),I=t("hbs!templates/levelDetail"),C=t("hbs!templates/btn"),k=new O,M=S.getViewportWidth(),P=S.getViewportHeight(),N={method:"spring",period:700,dampingRatio:.5};o.prototype=Object.create(v.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={current:!1,index:0,level:1,stage:1,colors:1,duration:500,start:[4*-M,-P,0]},o.prototype.flip=function(){this.flipper.flip(),this.isOpen=!this.isOpen},o.prototype.hide=function(t){N.period=this.options.duration,t=void 0!==t?t:N,this.rootMod.setOpacity(.001,t,function(){this.rootMod.setTransform(this._transform)}.bind(this))},o.prototype.show=function(t){N.period=this.options.duration,t=void 0!==t?t:N,this.rootMod.setOpacity(.999,t),this.rootMod.setTransform(_.translate(0,0,150),t)},o.prototype.unlock=function(){k.setLatestLevel(this.stage,this.level),this._locked=!1,this.front.unlock(),this.back.unlock(),n.call(this)},c.DEFAULT_OPTIONS={stage:1,level:1,color:1,locked:!0},c.prototype=Object.create(v.prototype),c.prototype.constructor=c,c.prototype.unlock=function(){this.setOptions({locked:!1}),this.backing.removeClass("locked"),this.backing.addClass("unlocked")},f.DEFAULT_OPTIONS={width:250,height:250,stage:1,level:1,color:1,locked:!0},f.prototype=Object.create(v.prototype),f.prototype.constructor=f,f.prototype.unlock=function(){this.setOptions({locked:!1}),this.backing.removeClass("locked")},i.exports=o}),define("famous/views/GridLayout",["require","exports","module","famous/core/Entity","famous/core/RenderNode","famous/core/Transform","famous/core/ViewSequence","famous/core/EventHandler","famous/core/Modifier","famous/core/OptionsManager","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new p(this.options),t&&this.setOptions(t),this.id=a.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new h,h.setOutputHandler(this,this._eventOutput)}function o(t,e,i){var n=[t[0],t[1]];n[0]-=this.options.gutterSize[0]*(e-1),n[1]-=this.options.gutterSize[1]*(i-1);for(var o,a=Math.round(n[1]/i),u=Math.round(n[0]/e),c=0,h=0,l=0;i>l;l++){o=0;for(var p=0;e>p;p++)void 0===this._modifiers[h]?s.call(this,h,[u,a],[o,c,0],1):r.call(this,h,[u,a],[o,c,0],1),h++,o+=u+this.options.gutterSize[0];c+=a+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[t[0],t[1]],this._activeCount=i*e,l=this._activeCount;l<this._modifiers.length;l++)r.call(this,l,[Math.round(u),Math.round(a)],[0,0],0);this._eventOutput.emit("reflow")}function s(t,e,i,n){var o={transform:new d(u.translate.apply(null,i)),opacity:new f(n),size:new f(e)},s=new l({transform:o.transform,opacity:o.opacity,size:o.size});this._states[t]=o,this._modifiers[t]=s}function r(t,e,i,n){var o=this._states[t],s=o.size,r=o.opacity,a=o.transform,u=this.options.transition;a.halt(),r.halt(),s.halt(),a.setTranslate(i,u),s.set(e,u),r.set(n,u)}var a=t("famous/core/Entity"),u=(t("famous/core/RenderNode"),t("famous/core/Transform")),c=t("famous/core/ViewSequence"),h=t("famous/core/EventHandler"),l=t("famous/core/Modifier"),p=t("famous/core/OptionsManager"),f=t("famous/transitions/Transitionable"),d=t("famous/transitions/TransitionableTransform");n.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new c(t)),this.sequence=t},n.prototype.commit=function(t){var e=t.transform,i=t.opacity,n=t.origin,s=t.size,r=this.options.dimensions[0],a=this.options.dimensions[1];(s[0]!==this._contextSizeCache[0]||s[1]!==this._contextSizeCache[1]||r!==this._dimensionsCache[0]||a!==this._dimensionsCache[1])&&o.call(this,s,r,a);for(var c=this.sequence,h=[],l=0;c&&l<this._modifiers.length;){var p=c.get(),f=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),p&&h.push(f.modify({origin:n,target:p.render()})),c=c.getNext(),l++}return s&&(e=u.moveThen([-s[0]*n[0],-s[1]*n[1],0],e)),{transform:e,opacity:i,size:s,target:h}},i.exports=n}),define("views/ZoomingGridView",["require","exports","module","famous/core/View","famous/core/Transform","famous/modifiers/StateModifier","famous/transitions/Easing","famous/utilities/Timer","famous/views/GridLayout"],function(t,e,i){function n(){this._eventInput.on(this.options.openEvent,function(t){this.openCell(t)}.bind(this)),this._eventInput.on(this.options.closeEvent,function(){this.closeCell()}.bind(this)),this._eventInput.pipe(this._eventOutput)}function o(){h.apply(this,arguments),this._scale=l.scale(this.options.scale[0],this.options.scale[1],this.options.scale[2]);var t=this.options.cellSize[0]*this.options.grid[0],e=this.options.cellSize[1]*this.options.grid[1];this.rootMod=new p({origin:[.5,.5],align:[.5,.5],size:[t,e],transform:this._scale}),this.cells=[],this.node=this.add(this.rootMod),n.call(this)}function s(){this.grid=new g({dimensions:this.options.grid,gutterSize:this.options.gutterSize}),this.gridMod=new p,this.grid.sequenceFrom(this.cells),this.node.add(this.gridMod).add(this.grid)}function r(t,e,i){function n(){this.visible?(this.rootMod.halt(),this.hide()):(this.rootMod.halt(),this.show()),this.visible=!this.visible}var o=this.cells,s={duration:300,curve:f.inOutQuad};t=void 0!==t?t:s,e=e||0===e?e:100;for(var r=0;r<o.length;r++){var a=o[r];d.setTimeout(n.bind(a),e*r)}d.setTimeout(function(){i&&i()},o.length*e)}function a(t){var e=this.options.grid,i=e[0],n=Math.floor(t/i)+1,o=t%i+1;return[o,n]}function u(t,e){var i=e[0],n=this.options.cellSize[0],o=i*n/2,s=(t[0]-1)*n,r=o-s-n/2;return r}function c(t,e){var i=e[1],n=this.options.cellSize[1],o=i*n/2,s=(t[1]-1)*n,r=o-s-n/2;return r}var h=t("famous/core/View"),l=t("famous/core/Transform"),p=t("famous/modifiers/StateModifier"),f=t("famous/transitions/Easing"),d=t("famous/utilities/Timer"),g=t("famous/views/GridLayout"),m={curve:"easeOut",duration:500};o.prototype=Object.create(h.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={cellSize:[300,400],grid:[4,7],gutterSize:[0,0],scale:[.1,.1,1],openEvent:"cell:select",closeEvent:"cell:close"},o.prototype.openCell=function(t){var e=a.call(this,t.index,this.options.grid),i=u.call(this,e,this.options.grid),n=c.call(this,e,this.options.grid);this.gridMod.setTransform(l.translate(i,n,1),m),this.rootMod.setTransform(l.scale(1,1,1),m)},o.prototype.closeCell=function(t){this.rootMod.setTransform(this._scale,m),this.gridMod.setTransform(l.translate(0,0,0),m,t)},o.prototype.showCells=function(t,e,i){this.gridMod.setTransform(l.translate(0,0,1)),r.call(this,t,e,i)},o.prototype.hideCells=function(t,e,i){this.gridMod.setTransform(l.translate(0,0,-100)),r.call(this,t,e,i)},o.prototype.createGrid=function(t){this.cells=t||[];for(var e=this.cells.length-1;e>=0;e--)this.cells[e].pipe(this._eventInput);s.call(this)},i.exports=o}),define("views/LevelsView",["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/utilities/Timer","utils","StageConfig","controllers/GameController","views/LevelView","views/ZoomingGridView","hbs!templates/btn"],function(t,e,i){function n(){function t(t){this.openLevel=t.node,this.hideCloseBtn(),this._backing.addClass("level-open"),g.setTimeout(function(){this._eventOutput.emit("level:select",t)}.bind(this),O/2)}function e(t){this.openLevel=null,g.setTimeout(function(){this.showCloseBtn(),this._backing.removeClass("level-open"),this._eventOutput.emit("level:close",t)}.bind(this),O/2)}function i(t){this._eventOutput.emit("nav:loadGame",t),g.setTimeout(function(){this._backing.removeClass("level-open"),this.closeOpenedLevels(this.showCloseBtn.bind(this))}.bind(this),1e3)}this._closeButton.on("click",function(){this.hide(null,0,function(){this._eventOutput.emit("stage:close",{stage:this.options.stage})}.bind(this))}.bind(this)),this._eventInput.on("level:select",t.bind(this)),this._eventInput.on("level:close",e.bind(this)),this._eventInput.on("level:play",i.bind(this)),this.grid.pipe(this._eventInput),this._eventInput.pipe(this._eventOutput),this._gameController._eventOutput.on("game:unlockNextLevel",function(){var t=this._gameController.getLatestLevel();s.call(this,t.stage,t.level)}.bind(this))}function o(){l.apply(this,arguments),this._active=!1,this.openLevel=null,this.config=new v(this.options.stage),this._gameController=new y,this.rootMod=new d({size:[void 0,this.options.expandedHeight],transform:f.translate(0,0,1)}),this.node=this.add(this.rootMod),r.call(this),u.call(this),a.call(this),n.call(this)
}function s(t,e){if(this.options.stage===t){var i=this.levels[e-1];i.unlock()}}function r(){this._backing=new p({size:[void 0,void 0],classes:["stage-"+this.options.stage,"stage-levels","stage-levels-bg"]});var t=new d({size:[void 0,void 0],opacity:.001});this._backing._mod=t,this.node.add(t).add(this._backing)}function a(){var t=w({label:"Browse Stages",classes:"btn-browse"});this._closeButton=new p({content:t,classes:["stage-levels","stage-"+this.options.stage]});var e=new d({size:[void 0,50],origin:[.5,1],align:[.5,1],transform:f.translate(0,50,1)});this._closeButton._mod=e,this.node.add(e).add(this._closeButton)}function u(){var t=[4,5],e=[20,20],i=[250,250],n=c.call(this,t,i,e,70,44);this.grid=new b({grid:t,gutterSize:e,cellSize:i,scale:n,openEvent:"level:select",closeEvent:"level:close"});var o=h.call(this);this.levels=o,this.gridMod=new d({align:[.5,0],origin:[.5,0],transform:f.translate(0,0,1)}),this.grid.createGrid(o),this.node.add(this.gridMod).add(this.grid)}function c(t,e,i,n,o){var s,r=x-o-n,a=t[0],u=t[1],c=u*e[1]+(u+2)*i[1],h=r/c,l=a*e[0]+(u+2)*i[0],p=S/l;return s=h>p?p:h,[s,s,1]}function h(){for(var t=[],e=this.options.grid[0]*this.options.grid[1],i=0;e>i;i++){var n={index:i,level:i+1,colors:3,duration:O,stage:this.options.stage},o=new _(n);t.push(o)}return t}var l=t("famous/core/View"),p=t("famous/core/Surface"),f=t("famous/core/Transform"),d=t("famous/modifiers/StateModifier"),g=t("famous/utilities/Timer"),m=t("utils"),v=t("StageConfig"),y=t("controllers/GameController"),_=t("views/LevelView"),b=t("views/ZoomingGridView"),w=t("hbs!templates/btn"),S=m.getViewportWidth(),x=m.getViewportHeight(),O=700;o.prototype=Object.create(l.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={stage:1,bgColor:"",expandedHeight:600,grid:[5,5]},o.prototype.show=function(t,e,i){this._active=!0,this._backing._mod.setTransform(f.identity),this._backing._mod.setOpacity(.999,{duration:300}),this._backing.addClass("stage-levels-bg--active"),this.grid.showCells(t,e,function(){this.showCloseBtn(),i&&i()}.bind(this))},o.prototype.hide=function(t,e,i){this._active=!1,this._backing.removeClass("stage-levels-bg--active"),this._backing._mod.setOpacity(.001,{duration:300}),this.grid.hideCells(t,e,function(){this._backing._mod.setTransform(f.translate(0,0,-100)),this.hideCloseBtn(),i&&i()}.bind(this))},o.prototype.showCloseBtn=function(){var t=300,e=f.translate(0,0,1);this._closeButton._mod.setOpacity(.999,{curve:"easeIn",duration:t}),this._closeButton._mod.setTransform(e,{curve:"easeIn",duration:t})},o.prototype.hideCloseBtn=function(){var t=this._closeButton.getSize(),e=f.translate(0,t[1],1);this._closeButton._mod.setOpacity(.001,{curve:"linear",duration:100}),this._closeButton._mod.setTransform(e,{curve:"linear",duration:100})},o.prototype.closeOpenedLevels=function(t){this.openLevel&&(this.openLevel.flip(),this.grid.closeCell(t),this.openLevel=null)},i.exports=o}),define("views/StageView",["require","exports","module","famous/core/Engine","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/transitions/Easing","famous/transitions/Transitionable","famous/surfaces/ImageSurface","StageConfig"],function(t,e,i){function n(){function t(t){this._eventOutput.emit("stage:select",{stage:this.options.stage,node:this,event:t})}this.bg.on("click",t.bind(this)),this.bg.pipe(this._eventOutput)}function o(){c.apply(this,arguments),this.config=new m(this.options.stage),this.rootMod=new p({size:[void 0,this.options.currentHeight],transform:l.translate(0,0,1)}),this.node=this.add(this.rootMod),s.call(this),r.call(this),n.call(this)}function s(){this.bg=new h({size:[void 0,void 0],classes:["stage-bg","stage-"+this.options.stage]}),this.bgMod=new p({transform:l.translate(0,0,0)}),this.node.add(this.bgMod).add(this.bg)}function r(){var t=this.config.getIcon();this.icon=new g({content:t.url,classes:["stage-"+this.options.stage,"stage-icon"],properties:{pointerEvents:"none"}}),this.iconMod=new p({size:t.size||[50,50],align:[.5,.5],origin:[.5,.5],opacity:.85}),this.node.add(this.iconMod).add(this.icon)}function a(t,e){var i={duration:t.duration||300,curve:f.inOutQuad},n=t.start||0,o=t.end||0,s=t.axis&&t.axis.toLowerCase()||"y",r=new d(n),a=function(){var t=[],e=r.get();t="x"===s?[e,void 0]:"y"===s?[void 0,e]:[e,e],this.rootMod.setSize(t)}.bind(this),c=function(){u.removeListener("prerender",a),this.options.currentHeight=o,e&&e()}.bind(this);u.on("prerender",a),r.set(o,i,c)}var u=t("famous/core/Engine"),c=t("famous/core/View"),h=t("famous/core/Surface"),l=t("famous/core/Transform"),p=t("famous/modifiers/StateModifier"),f=t("famous/transitions/Easing"),d=t("famous/transitions/Transitionable"),g=t("famous/surfaces/ImageSurface"),m=t("StageConfig");o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={index:0,stage:1,height:100,currentHeight:100,expandedHeight:500,active:!1},o.prototype.expand=function(t){this.options.active=!0,this.bg.addClass("active");var e={curve:"easeOut",duration:250},i=-(this.options.expandedHeight/2-50);return this.iconMod.setTransform(l.translate(0,i,0),e,function(){this.iconMod.setOpacity(.001,e)}.bind(this)),this.options.currentHeight===this.options.expandedHeight?void(t&&t()):void a.call(this,{start:this.options.height,end:this.options.expandedHeight,axis:"y"},function(){t&&t()}.bind(this))},o.prototype.contract=function(t){var e={curve:"easeOut",duration:250};this.options.active=!1,this.bg.removeClass("active"),this.iconMod.setTransform(l.translate(0,0,0),e,function(){this.iconMod.setOpacity(.999,e)}.bind(this)),a.call(this,{start:this.options.expandedHeight,end:this.options.height,duration:500,axis:"y"},function(){t&&t()})},i.exports=o}),define("controllers/LivesController",["require","exports","module","famous/core/Engine","famous/utilities/Timer","controllers/Controller","localforage"],function(t,e,i){function n(){return n._instance?n._instance:(c.apply(this,arguments),void(n._instance=this))}function o(){if(!l){var t=0,e=f,i=u.setInterval(function(){t+=1e3,e=f-t,this._eventOutput.emit("lives:timeRemaining",r(e)),t>=f&&(a.removeListener("prerender",i),this.add())}.bind(this),1e3);l=!0}}function s(){l=!1,this.hasMaxLives()||o.call(this)}function r(t){var e=t/1e3,i=e%60,n=(e-i)/60;return 10>i&&(i="0"+i),n+":"+i}var a=t("famous/core/Engine"),u=t("famous/utilities/Timer"),c=t("controllers/Controller"),h=t("localforage"),l=!1,p=5,f=6e4;n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n._instance=null,n.DEFAULT_OPTIONS={lives:5,lastDeath:"",lastRecharge:""},n.prototype.get=function(){return this.options.lives},n.prototype.add=function(){this.options.lives++,h.ready().then(function(){h.setItem("lives",this.options.lives)}),this._eventOutput.emit("lives:addedOne",this.options.lives),this._eventOutput.emit("lives:updateCount",this.options.lives),this.hasMaxLives()&&this._eventOutput.emit("lives:isMaxxed",this.options.lives),s.call(this)},n.prototype.remove=function(){this.options.lives--,h.ready().then(function(){h.setItem("lives",this.options.lives)}),this._eventOutput.emit("lives.removedOne",this.options.lives),this._eventOutput.emit("lives:updateCount",this.options.lives),o.call(this)},n.prototype.hasMaxLives=function(){return this.options.lives===p},n.prototype.hasLives=function(){return this.options.lives>0},i.exports=n}),define("views/StagesView",["require","exports","module","famous/core/Engine","famous/core/View","famous/core/Surface","famous/core/Transform","famous/transitions/Transitionable","famous/modifiers/StateModifier","famous/surfaces/ContainerSurface","famous/transitions/SpringTransition","famous/transitions/SnapTransition","famous/views/Lightbox","famous/utilities/Timer","utils","StageConfig","famous/views/HeaderFooterLayout","famous/views/Scrollview","views/LevelsView","views/StageView","controllers/LivesController"],function(t,e,i){function n(){this.homeIcon.on("click",function(){this._eventOutput.emit("nav:loadHome")}.bind(this)),this._eventInput.on("nav:loadGame",function(t){this._eventOutput.emit("nav:loadGame",t),k.setTimeout(this.showHeader.bind(this),1e3)}.bind(this)),this._eventInput.on("level:select",function(){this.hideHeader()}.bind(this)),this._eventInput.on("level:close",function(){k.setTimeout(this.showHeader.bind(this),350)}.bind(this)),this._eventInput.on("stage:select",function(t){this.scrollToStage(t)}.bind(this)),this._eventInput.on("stage:close",function(){this.closeExpanded()}.bind(this))}function o(){b.apply(this,arguments),this._stageLevels=[],this.prevIndex=this.options.activeStage-1,this.activeIndex=this.options.activeStage-1;var t=y.call(this);this.setOptions({stageHeight:t}),r.call(this),a.call(this),u.call(this),s.call(this),n.call(this),this.loadStage()}function s(){this.lightbox=new C({inTransform:S.translate(0,0,1),showTransform:S.translate(0,0,1),outTransform:S.translate(0,0,-100),inOpacity:1,outOpacity:0});var t=new O({size:[void 0,this.options.stageExpandedHeight],transform:S.translate(0,0,1)});this.add(t).add(this.lightbox)}function r(){this.layout=new N({headerSize:this.options.headerHeight});var t=new O({transform:S.translate(0,0,.1)});this.add(t).add(this.layout)}function a(){var t=new D;t.remove();var e=new O({transform:S.translate(0,0,50)}),i=this.layout.header.add(e);this.layout.header._mod=e;var n=new w({properties:{backgroundColor:"black",classes:["header","navbar"]}}),o=new O({transform:S.behind});this.homeIcon=new w({size:[!0,!0],classes:["header","navbar","nav-item"],content:'<i class="fa fa-2x fa-angle-double-up"></i>'});var s=new O({align:[1,.5],origin:[1,.5],transform:S.translate(-12,0,1)}),r=new w({size:[!0,!0],classes:["header"],content:'<i class="fa fa-heart"></i>'}),a=new O({align:[0,.5],origin:[0,.5],transform:S.translate(12,0,1)}),u=new w({size:[!0,!0],classes:["header","lives-count"],content:t.get()||"0"}),c=new O({align:[0,.5],origin:[0,.5],transform:S.translate(30,0,1)}),h=new w({content:"",classes:["header","lives-timer"]}),l=new O({size:[50,24],align:[0,.5],origin:[0,.5],transform:S.translate(43,0,1)});t.on("lives:timeRemaining",function(t){h.setContent("- "+t)}),t.on("lives:isMaxxed",function(){h.setContent("")}),t.on("lives:updateCount",function(t){u.setContent(t)}),i.add(o).add(n),i.add(s).add(this.homeIcon),i.add(a).add(r),i.add(c).add(u),i.add(l).add(h)}function u(){l.call(this);var t=new T({size:[void 0,F-this.options.headerHeight],properties:{overflow:"hidden"}});t.add(this.scrollView),this.layout.content.add(t)}function c(t){var e=new z({stage:t.index+1,height:t.height,currentHeight:t.currentHeight,expandedHeight:t.expandedHeight});return e.pipe(this.scrollView),e.on("stage:select",function(t){this._eventInput.emit("stage:select",t)}.bind(this)),e}function h(t){var e=new L({stage:t.index+1,height:t.height,currentHeight:t.currentHeight,expandedHeight:t.expandedHeight});return e.on("stage:close",function(t){this._eventInput.emit("stage:close",t)}.bind(this)),e.on("level:select",function(){this._eventInput.emit("level:select")}.bind(this)),e.on("level:close",function(){this._eventInput.emit("level:close")}.bind(this)),e.on("nav:loadGame",function(t){this._eventInput.emit("nav:loadGame",t)}.bind(this)),e}function l(){var t,e,i;this._stages=[],this.scrollView=new A;for(var n=0;n<P.getStagesCount();n++)t={index:n,height:this.options.stageHeight,currentHeight:this.options.stageHeight,expandedHeight:this.options.stageExpandedHeight},this.activeIndex===n&&(t.currentHeight=this.options.stageExpandedHeight,t.active=!0),e=c.call(this,t),i=h.call(this,t),this._stageLevels.push(i),this._stages.push(e);this.scrollView.sequenceFrom(this._stages),this.scrollView._eventInput.on("end",function(){this._eventOutput.emit(-1!==this.scrollView._scroller.onEdge()?"stagesView:scrollViewInContent":"stagesView:scrollViewEdgeHit")}.bind(this)),this.scrollView.pipe(this._eventOutput)}function p(t,e){var i=g.call(this,this.activeIndex);m.call(this,i,t,e)}function f(t){var e=this.scrollView,i={NONE:0,EDGE:1,PAGE:2};e._edgeSpringPosition+=t,e._pageSpringPosition+=t,e.setPosition(e.getPosition()+t),e._springState===i.EDGE?e.spring.setOptions({anchor:[e._edgeSpringPosition,0,0]}):e._springState===i.PAGE&&e.spring.setOptions({anchor:[e._pageSpringPosition,0,0]})}function d(){var t,e=this.scrollView.getPosition(),i=this.scrollView._scroller._node.index,n=v.call(this,i),o=n.getSize()[1];return o===e?o:t=o-e}function g(t){var e,i,n=this.scrollView._scroller._node.index;return t===n?-this.scrollView.getPosition():(e=d.call(this),t===n+1?e:(i=(t-n-1)*this.options.stageHeight,e+i))}function m(t,e,i){var n=new x(0);"function"==typeof e&&(i=e,e=null),e||(e={duration:250,curve:"easeOut"});var o=0,s=function(){var t=n.get()-o;o=n.get(),f.call(this,t)}.bind(this),r=function(){_.removeListener("prerender",s),i&&i()}.bind(this);_.on("prerender",s),n.set(t,e,r)}function v(t){return this._stages[t]}function y(){var t=F-this.options.headerHeight,e=t/5>100?t/5:100;return e}var _=t("famous/core/Engine"),b=t("famous/core/View"),w=t("famous/core/Surface"),S=t("famous/core/Transform"),x=t("famous/transitions/Transitionable"),O=t("famous/modifiers/StateModifier"),T=t("famous/surfaces/ContainerSurface"),E=t("famous/transitions/SpringTransition"),I=t("famous/transitions/SnapTransition"),C=t("famous/views/Lightbox"),k=t("famous/utilities/Timer"),M=t("utils"),P=t("StageConfig"),N=t("famous/views/HeaderFooterLayout"),A=t("famous/views/Scrollview"),L=t("views/LevelsView"),z=t("views/StageView"),D=t("controllers/LivesController"),F=M.getViewportHeight();x.registerMethod("spring",E),x.registerMethod("snap",I),o.prototype=Object.create(b.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={headerHeight:44,stageHeight:100,stageExpandedHeight:F,activeStage:1,pageChangeDuration:500},o.prototype.scrollToStage=function(t){var e=t.stage-1;this.activeIndex=e,this.expandStage(function(){p.call(this,function(){var t=this._stageLevels[this.activeIndex];this.lightbox.show(t,null,function(){t.show()})}.bind(this))}.bind(this))},o.prototype.closeExpanded=function(t){var e=v.call(this,this.activeIndex);e.contract(function(){this.lightbox.hide(),t&&t()}.bind(this))},o.prototype.expandStage=function(t){var e=v.call(this,this.activeIndex);e.expand(t)},o.prototype.loadStage=function(){this.expandStage();var t=this._stageLevels[this.activeIndex];this.lightbox.show(t,null,function(){k.setTimeout(function(){t.show()},this.options.pageChangeDuration)}.bind(this))},o.prototype.showHeader=function(t){this.layout.header._mod.setTransform(S.translate(0,0,50),{curve:"easeIn",duration:300},t)},o.prototype.hideHeader=function(){this.layout.header._mod.setTransform(S.translate(0,-this.options.headerHeight,0),{curve:"easeOut",duration:100})},i.exports=o}),define("views/FpsMeterView",["require","exports","module","famous/core/Engine","famous/core/View","famous/core/Surface","famous/core/Modifier","famous/utilities/Timer","famous/core/Transform"],function(t,e,i){var n=t("famous/core/Engine"),o=t("famous/core/View"),s=t("famous/core/Surface"),r=t("famous/core/Modifier"),a=t("famous/utilities/Timer"),u=t("famous/core/Transform"),c=function(t,e){return function(){return t.apply(e,arguments)}},h={}.hasOwnProperty,l=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p=function(t){function e(){this.update=c(this.update,this),this.toggleState=c(this.toggleState,this),this.tick=c(this.tick,this),e.__super__.constructor.apply(this,arguments),this.initTime(),this.surface=new s({size:[70,30],classes:["fpsmeter"],content:"",properties:{zIndex:100}}),this.add(new r({origin:[1,1],align:[1,1],transform:u.translate(0,0,10)})).add(this.surface),this.surface.on("click",this.toggleState),this.start()}return l(e,t),e.prototype.currTime=0,e.prototype.lastTime=0,e.prototype.frameTime=0,e.prototype.state=!0,e.prototype.filterStrength=10,e.prototype.updateFrequency=100,e.prototype.initTime=function(){var t,e;return t=window.performance,t&&(t.now||t.webkitNow)&&(e=t.now?"now":"webkitNow",this.getTime=t[e].bind(t)),this.lastTime=this.getTime()},e.prototype.tick=function(){var t;return this.currTime=this.getTime(),t=this.currTime-this.lastTime,this.frameTime+=(t-this.frameTime)/this.filterStrength,this.lastTime=this.currTime},e.prototype.toggleState=function(){return this.state?this.stop():this.start(),this.state=!this.state},e.prototype.start=function(){return n.on("prerender",this.tick),this.interval=a.setInterval(this.update,this.updateFrequency)},e.prototype.stop=function(){return n.removeListener("prerender",this.tick),a.clear(this.interval)},e.prototype.update=function(){return this.surface.setContent(""+(1e3/this.frameTime).toFixed(1)+" fps")},e.prototype.getTime=function(){return+new Date},e}(o);i.exports=p}),define("views/AppView",["require","exports","module","famous/core/Engine","famous/core/View","famous/core/Transform","famous/modifiers/StateModifier","famous/views/Lightbox","famous/utilities/Timer","utils","models/UserModel","models/GameModel","controllers/GameController","views/GameView","views/HomeView","views/StagesView","views/FpsMeterView"],function(t,e,i){function n(){this.stagesView.on("nav:loadHome",function(){d.call(this),this.showPage("home")}.bind(this)),this.stagesView.on("nav:loadGame",function(t){t.fromPage="stages",l.call(this),this.gameView._eventInput.emit("game:load",t),this.showPage("game")}.bind(this)),this.gameView.on("nav:loadStages",function(){p.call(this),this.showPage("stages")}.bind(this)),this.gameView.on("nav:loadHome",function(){p.call(this),this.showPage("home")}.bind(this)),this.homeView.on("nav:loadStages",function(){f.call(this),this.showPage("stages")}.bind(this)),this.homeView.on("nav:loadGame",function(){var t=this.gameController.getOptions();t.fromPage="home",l.call(this),this.gameView._eventInput.emit("game:load",t),this.showPage("game")}.bind(this))}function o(){m.apply(this,arguments),this.gameModel=new x,this.userModel=new S,this._currentPage="",this._pages={},this.showingHome=!0,this.delegateToScrollView=!1;var t=new y({size:[M,P],origin:[0,0],align:[0,0]});this.node=this.add(t),r.call(this),a.call(this),h.call(this),this.showHomePage(),g.on("game:loaded",function(){A=!0,N&&s.call(this)}.bind(this)),g.on("user:loaded",function(){N=!0,A&&s.call(this)}.bind(this))}function s(){L||(this.gameController=new O,u.call(this),c.call(this),n.call(this),b.setTimeout(function(){this.homeView.showMenu()}.bind(this),2e3),L=!0)}function r(){this.lightbox=new _(this.options.lightboxOpts),this.node.add(this.lightbox)}function a(){this.homeView=new E,this._pages.home=this.homeView}function u(){this.stagesView=new I({pageChangeDuration:k}),this._pages.stages=this.stagesView}function c(){this.gameView=new T,this._pages.game=this.gameView}function h(){this.fpsView=new C;var t=new y({transform:v.translate(0,0,1e3)});this.node.add(t).add(this.fpsView)}function l(){var t={inTransform:v.translate(M,0,0),outTransform:v.translate(-M,0,0)};this.lightbox.setOptions(t)}function p(){var t={inTransform:v.translate(-M,0,0),outTransform:v.translate(M,0,0)};this.lightbox.setOptions(t)}function f(){var t={inTransform:v.translate(0,P,0),outTransform:v.translate(0,-P,0)};this.lightbox.setOptions(t)}function d(){var t={inTransform:v.translate(0,-P,0),outTransform:v.translate(0,P,0)};this.lightbox.setOptions(t)}var g=t("famous/core/Engine"),m=t("famous/core/View"),v=t("famous/core/Transform"),y=t("famous/modifiers/StateModifier"),_=t("famous/views/Lightbox"),b=t("famous/utilities/Timer"),w=t("utils"),S=t("models/UserModel"),x=t("models/GameModel"),O=t("controllers/GameController"),T=t("views/GameView"),E=t("views/HomeView"),I=t("views/StagesView"),C=t("views/FpsMeterView"),k=750,M=w.getViewportWidth(),P=w.getViewportHeight(),N=!1,A=!1,L=!1;o.prototype=Object.create(m.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={lightboxOpts:{inTransform:v.translate(0,0,0),showTransform:v.translate(0,0,0),outTransform:v.translate(0,0,0),inTransition:{curve:"easeOut",duration:k},outTransition:{curve:"easeOut",duration:k},inOpacity:1,outOpacity:1,overlap:!0}},o.prototype.showPage=function(t){var e=this._pages[t];this.lightbox.show(e),this._currentPage=t},o.prototype.showHomePage=function(){var t={inTransform:v.translate(0,0,0)};this.lightbox.setOptions(t),this.showPage("home")},i.exports=o}),define("main",["require","exports","module","famous/core/Engine","localforage","views/AppView"],function(t){var e=t("famous/core/Engine"),i=t("localforage"),n=t("views/AppView");i.config({name:"enka",version:1,size:4980736,storeName:"enka",description:"Stores persistent game information, i.e. current stage, current level, lives"});var o=e.createContext(),s=new n;o.add(s)}),require(["main"])}();